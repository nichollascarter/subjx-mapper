(this["webpackJsonpsubjx-mapper"]=this["webpackJsonpsubjx-mapper"]||[]).push([[0],{172:function(e,t,a){e.exports=a(302)},177:function(e,t,a){},182:function(e,t,a){},302:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(9),o=a.n(i),l=(a(177),a(20)),c=a(161),s=a(368),u=(a(182),a(74)),d=a(12),p=a(142),m=a.n(p),b=a(36),g=a(24),f=function(){function e(t){Object(b.a)(this,e),this.stack=[null],this.step=-1,this.self=t}return Object(g.a)(e,[{key:"next",value:function(){var e=this.stack;null!==e[e.length-1]&&(this.step++,e.push(null))}},{key:"setItem",value:function(e){var t=this.stack;t[t.length-1]=e,t.length>9&&t.shift()}},{key:"push",value:function(e){this.step++,this.stack.splice(this.step),this.stack.push(e)}},{key:"undo",value:function(){var e,t=this.stack;return this.step>=0?(e=t[this.step],this.step--,e):null}},{key:"redo",value:function(){var e=this.stack;return this.step=-1===this.step?0:this.step,e.length-1>this.step?e[this.step++]:null}},{key:"invalidateAll",value:function(){this.stack=[],this.step=-1}}]),e}();function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y={editorAction:"edit",editorGrid:!0,editorGridSize:10,editorPaperSize:{width:800,height:600},allowDragging:!0,allowResizing:!0,allowRotating:!0,allowProportions:!0,allowRestrictions:!1,allowRotationOrigin:!1,snapSteps:{x:10,y:10,angle:15},eventBus:new m.a,undoStack:new f,items:[],globalData:new WeakMap};var O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v({},y),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_EDITOR_ACTION":return v({},e,{editorAction:t.editorAction});case"ACTIVATE_EDITOR_GRID":return v({},e,{editorGrid:t.editorGrid});case"SET_EDITOR_GRID_SIZE":return v({},e,{editorGridSize:t.editorGridSize});case"SET_EDITOR_PAPER_SIZE":return v({},e,{editorPaperSize:t.editorPaperSize});case"SET_ALLOW_DRAGGING":return v({},e,{allowDragging:t.allowDragging});case"SET_ALLOW_RESIZING":return v({},e,{allowResizing:t.allowResizing});case"SET_ALLOW_ROTATING":return v({},e,{allowRotating:t.allowRotating});case"SET_ALLOW_PROPORTIONS":return v({},e,{allowProportions:t.allowProportions});case"SET_ALLOW_RESTRICTIONS":return v({},e,{allowRestrictions:t.allowRestrictions});case"SET_ALLOW_ROTATION_ORIGIN":return v({},e,{allowRotationOrigin:t.allowRotationOrigin});case"SET_SNAP_STEPS":return v({},e,{snapSteps:t.snapSteps});case"SET_SELECTED_ITEMS":return v({},e,{items:t.items});default:return e}},E=Object(u.b)(O),w=a(18),x=a(7),j=a(4),S=a(332),k=a(21),C=a(146),N=a.n(C),P=a(147),R=(a(194),a(366)),D=a(373),A=a(337),T=a(365),I=a(367),L=a(159),z=a.n(L),G=a(105),_=a.n(G),B=a(335),W=function(e){var t=Object(n.useRef)(null),a=Object(n.useState)("matrix(1,0,0,1,0,0)"),i=Object(x.a)(a,2),o=i[0],l=i[1],c={x:0,y:0,oldX:0,oldY:0,button:!1},s=[1,0,0,1,0,0],u=1,d={x:0,y:0},p=function(){var e=s,t=!0;return{applyTo:function(){t&&this.update(),l("matrix(".concat(e.join(","),")"))},update:function(){t=!1,e[3]=e[0]=u.toFixed(5),e[2]=e[1]=0,e[4]=d.x.toFixed(5),e[5]=d.y.toFixed(5)},pan:function(e){t&&this.update(),d.x+=e.x,d.y+=e.y,t=!0},scaleAt:function(e,a){var n=u*a;n<.4||n>5||(t&&this.update(),u*=a,d.x=e.x-(e.x-d.x)*a,d.y=e.y-(e.y-d.y)*a,t=!0)}}}(),m=Object(n.useCallback)((function(a){if(!1!==e.enable){var n=t.current;"mousedown"===a.type&&(c.button=!0),"mouseup"!==a.type&&"mouseout"!==a.type||(c.button=!1),c.oldX=c.x,c.oldY=c.y,c.x=a.clientX,c.y=a.clientY,c.button&&(p.pan({x:c.x-c.oldX,y:c.y-c.oldY}),p.applyTo(n)),a.preventDefault()}})),b=[["mousemove",m],["mousedown",m],["mouseup",m],["mouseout",m],["wheel",Object(n.useCallback)((function(a){if(!1!==e.enable){var n=t.current,r=n.parentNode.getBoundingClientRect(),i=a.clientX-r.left,o=a.clientY-r.top;p.scaleAt({x:i,y:o},a.deltaY<0?1.1:1/1.1),p.applyTo(n),a.preventDefault()}}),[e.enable])],["dblclick",Object(n.useCallback)((function(){u=1,d.x=d.y=0,s[0]=s[3]=1,s[1]=s[2]=s[4]=s[5]=0,p.pan(d),p.scaleAt({x:0,y:0},1),p.applyTo(t.current)}))]];return Object(n.useEffect)((function(){var a=t.current;return e.enable&&b.map((function(e){var t=Object(x.a)(e,2),n=t[0],r=t[1];a.parentNode.addEventListener(n,r,{passive:!1})})),function(){b.map((function(e){var t=Object(x.a)(e,2),n=t[0],r=t[1];a.parentNode.removeEventListener(n,r,{passive:!1})}))}}),[e.enable]),r.a.createElement("g",{id:"zoom-container",ref:t,transform:o},e.children)},M=a(3),V=a(75),$=a(76),H=a(82),X=a(54),Y=a(148),U=a.n(Y);function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function K(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Z=["letterSpacing","wordSpacing","lineHeight","textContent"],q={container:"#editor-container",controlsContainer:"#controls-container",rotatorAnchor:"n",rotatorOffset:30},J=function(e){function t(){var e,a;Object(b.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(V.a)(this,(e=Object($.a)(t)).call.apply(e,[this].concat(r)))).root=null,a.editable=!1,a.selectable=null,a.items=[],a.currentGroup=null,a.ignoreStoring=!1,a}return Object(H.a)(t,e),Object(g.a)(t,[{key:"shouldComponentUpdate",value:function(e){if(this.root&&e.content!==this.props.content)if(this.dropItems(),this.currentGroup=this.root,e.content&&e.content.childNodes)for(;e.content.childNodes.length;)this.root.appendChild(e.content.firstChild);else for(this.handleDropLayer();this.root.lastElementChild;)this.root.removeChild(this.root.lastElementChild);return e.dropLayer&&this.handleDropLayer(),!0!==e.dropItems&&e.editable||!this.items.length||this.dropItems(),e.selectable!==Boolean(this.selectable)&&(e.selectable&&(this.selectable=this.makeSelectables()),!e.selectable&&this.selectable&&(this.selectable.stop(),this.selectable=null)),!1}},{key:"componentDidMount",value:function(){this.currentGroup=this.root,this.handleClick=this.handleClick.bind(this),this.handleDoubleClick=this.handleDoubleClick.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleUndo=this.handleUndo.bind(this),this.handleRedo=this.handleRedo.bind(this),this.reloadDraggables=this.reloadDraggables.bind(this),this.root.addEventListener("mouseup",this.handleClick),this.root.addEventListener("dblclick",this.handleDoubleClick),document.addEventListener("keydown",this.handleKeyDown),this.root.classList.add("isolated-layer"),this.subscribeToEvents()}},{key:"componentWillUnmount",value:function(){this.root.removeEventListener("mouseup",this.handleClick),this.root.removeEventListener("dblclick",this.handleDoubleClick),document.removeEventListener("keydown",this.handleKeyDown)}},{key:"subscribeToEvents",value:function(){var e=this,t=this.props.eventBus;t.on("undo",this.handleUndo),t.on("redo",this.handleRedo),t.on("settingUpdated",this.reloadDraggables),Object.entries({fill:"fill",stroke:"stroke",thickness:"stroke-width",opacity:"opacity",letterSpacing:"letter-spacing",wordSpacing:"word-spacing",lineHeight:"line-height",textContent:"text-content"}).map((function(a){var n=Object(x.a)(a,2),r=n[0],i=n[1];return t.on(r,(function(t){e.items.forEach((function(a){if(void 0!==t&&a.elements.map((function(e){return e.setAttributeNS(null,i,t)})),Z.includes(r)){a.fitControlsToSize();var n=a.storage.handles.te,o=n.x1.baseVal.value,l=n.y1.baseVal.value,c=n.x2.baseVal.value,s=n.y2.baseVal.value,u=[o-c,l-s],d=e.calcTooltipPosition([c,s],u,-30,45),p=Object(x.a)(d,2),m=p[0],b=p[1];a.controls.querySelector(".delete-sjx-item").setAttributeNS(null,"transform","translate(".concat(m-12,", ").concat(b-12,")"))}}))}))})),Object.entries({l:"alignLeft",r:"alignRight",h:"alignHorizontal",t:"alignTop",b:"alignBottom",v:"alignVertical"}).map((function(a){var n=Object(x.a)(a,2),r=n[0],i=n[1];return t.on(i,(function(){return e.applyAlignment(r)}))}))}},{key:"setEditable",value:function(e){this.editable=e}},{key:"setDraggable",value:function(e){var t=this,a=(this.items,this.props),n=a.undoStack,r=a.allowDragging,i=a.allowResizing,o=a.allowRotating,l=a.allowProportions,c=a.allowRestrictions,s=a.allowRotationOrigin,u=a.snapSteps,d=Object(X.a)(e).drag(K({},q,{},c&&{restrict:"#editor-grid"},{draggable:r,resizable:i,rotatable:o,rotationPoint:s,proportions:l,snap:{x:u.x,y:u.y,angle:u.y},onInit:function(){var e=this;console.log("Draggable:: ",this.elements),this.options.scalable=1===this.elements.length&&"text"===this.elements[0].tagName.toLowerCase(),t.selectable&&t.props.selectable&&t.selectable.stop();var a=this.storage.handles.te,n=a.x1.baseVal.value,r=a.y1.baseVal.value,i=a.x2.baseVal.value,o=a.y2.baseVal.value,l=[n-i,r-o],c=t.calcTooltipPosition([i,o],l,-30,45),s=Object(x.a)(c,2),u=s[0],d=s[1],p=document.createElementNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"transform","translate(".concat(u-12,", ").concat(d-12,")")),p.classList.add("delete-sjx-item");var m=document.createElementNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M14.59 8L12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"),m.setAttributeNS(null,"pointer-events","bounding-box"),m.setAttributeNS(null,"fill","rgb(237, 28, 36)"),p.addEventListener("click",(function(){t.removeDraggable(e)})),p.appendChild(m),this.controls.appendChild(p)},onResize:function(e){var a=e.dx,r=e.dy;t.setEditable(!0);var i=this._getVertices(),o=i.tr,l=i.tl,c=l.x,s=l.y,u=o.x,d=o.y,p=[c-u,s-d],m=t.calcTooltipPosition([u,d],p,-30,45),b=Object(x.a)(m,2),g=b[0],f=b[1];if(this.controls.querySelector(".delete-sjx-item").setAttributeNS(null,"transform","translate(".concat(g-12,", ").concat(f-12,")")),t.ignoreStoring)return t.ignoreStoring=!1;var h=this.storage,v=h.revX,y=h.revY,O=h.doW,E=h.doH;n.setItem({name:"resize",el:this.elements,data:{dx:a,dy:r,revX:v,revY:y,doW:O,doH:E}})},onMove:function(e){var a=e.dx,r=e.dy;t.setEditable(!0);var i=this._getVertices(),o=i.tr,l=i.tl,c=l.x,s=l.y,u=o.x,d=o.y,p=[c-u,s-d],m=t.calcTooltipPosition([u,d],p,-30,45),b=Object(x.a)(m,2),g=b[0],f=b[1];if(this.controls.querySelector(".delete-sjx-item").setAttributeNS(null,"transform","translate(".concat(g-12,", ").concat(f-12,")")),t.ignoreStoring)return t.ignoreStoring=!1;n.setItem({name:"move",el:this.elements,data:[a,r]})},onRotate:function(e){var a=e.delta;t.setEditable(!0);var r=this._getVertices(),i=r.tr,o=r.tl,l=o.x,c=o.y,s=i.x,u=i.y,d=[l-s,c-u],p=t.calcTooltipPosition([s,u],d,-30,45),m=Object(x.a)(p,2),b=m[0],g=m[1];if(this.controls.querySelector(".delete-sjx-item").setAttributeNS(null,"transform","translate(".concat(b-12,", ").concat(g-12,")")),t.ignoreStoring)return t.ignoreStoring=!1;n.setItem({name:"rotate",data:a,el:this.elements})},onDrop:function(){if(setTimeout((function(){return t.setEditable(!1)}),100),t.ignoreStoring)return t.ignoreStoring=!1;n.next()},onDestroy:function(){setTimeout((function(){return t.setEditable(!1)}),100),this.elements.map((function(e){return e.classList.remove("subjx-selected")})),t.selectable&&t.props.selectable&&t.selectable.start()}}));return this.props.eventBus.emit("settings",null,"item"),this.props.$setSelectedItems({items:[].concat(Object(w.a)(this.items),[d])}),d}},{key:"reloadDraggables",value:function(){var e=this.items.map((function(e){return e.disable(),[e.elements]}));this.items=Object(w.a)(this.setDraggable(e))}},{key:"removeDraggable",value:function(e){var t=this.items;t.splice(t.indexOf(e),1),e.disable(),e.elements.map((function(e){return e.parentNode.removeChild(e)})),this.props.eventBus.emit("settings",null,"canvas")}},{key:"applyAlignment",value:function(e){var t=this;this.items.map((function(a){a.applyAlignment(e);var n=a.storage.handles.te,r=n.x1.baseVal.value,i=n.y1.baseVal.value,o=n.x2.baseVal.value,l=n.y2.baseVal.value,c=[r-o,i-l],s=t.calcTooltipPosition([o,l],c,-30,45),u=Object(x.a)(s,2),d=u[0],p=u[1];a.controls.querySelector(".delete-sjx-item").setAttributeNS(null,"transform","translate(".concat(d-12,", ").concat(p-12,")"))}))}},{key:"calcTooltipPosition",value:function(e,t,a,n){var r=Object(x.a)(e,2),i=r[0],o=r[1],l=Object(x.a)(t,2),c=l[0],s=l[1],u=Math.atan2(s,c)-n*Math.PI/180;return[Number(i)+a*Math.cos(u),Number(o)+a*Math.sin(u)]}},{key:"makeSelectables",value:function(){var e=this,t=new U.a({selectables:this.currentGroup.children,area:this.props.root.current});return t.subscribe("callback",(function(t){for(var a=t.items,n=e.items;n.length>0;)n.pop().disable();if(a.length){var r=e.setDraggable(a);e.items=[r]}})),t}},{key:"handleClick",value:function(e){if(!this.editable&&this.props.editable){var t=this.currentGroup,a=this.items,n=Object(w.a)(t.childNodes).find((function(t){return!(t.classList&&t.classList.contains("sjx-drag"))&&t.contains(e.target)}))||(t===e.target?e.target:null);if(n){if(e.stopPropagation(),!e.ctrlKey)for(;a.length>0;)a.pop().disable();var r=this.setDraggable(n);a.push(r),this.items=a}}}},{key:"handleDoubleClick",value:function(e){if(e.preventDefault(),!this.editable&&this.props.editable){var t=this.currentGroup,a=Object(w.a)(t.childNodes).find((function(t){return t.classList&&t.classList.contains("sjx-drag")&&t.contains(e.target)}));a&&"g"===a.tagName&&(this.dropItems(),this.currentGroup=a,this.props.onLayerChange(this.getLayerPath(a)),t.classList.remove("isolated-layer"),a.classList.add("isolated-layer"),this.applyCurrentGroupOpacity(a))}}},{key:"handleDropLayer",value:function(){var e=this.currentGroup;if(e===this.root)return this.props.onLayerChange(this.getLayerPath(e));this.dropItems(),e.classList.remove("isolated-layer");var t=e.parentNode;this.currentGroup=t,this.props.onLayerChange(this.getLayerPath(t)),this.dropCurrentGroupOpacity(e),this.applyCurrentGroupOpacity(t),t.classList.add("isolated-layer")}},{key:"getLayerPath",value:function(e){for(var t=e,a="";t!==this.root;)a=(t.getAttribute("id")||t.nodeName)+" / "+a,t=t.parentNode;return a}},{key:"dropItems",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.items;t.length>0;)t.pop().disable();this.items=e}},{key:"handleKeyDown",value:function(e){var t=this.items;if(46===e.keyCode)for(;t.length>0;){var a=t.pop();a.disable(),a.el.parentNode.removeChild(a.el)}else if(65===e.keyCode&&e.ctrlKey){for(;t.length>0;)t.pop().disable();e.preventDefault()}else 67===e.keyCode||86===e.keyCode||e.keyCode>36&&e.keyCode<41&&(e.preventDefault(),t.forEach((function(t){t.exeDrag({dx:37===e.keyCode||39===e.keyCode?37===e.keyCode?-10:10:0,dy:38===e.keyCode||40===e.keyCode?38===e.keyCode?-10:10:0})})))}},{key:"applyCurrentGroupOpacity",value:function(e){e.setAttributeNS(null,"opacity",1),e!==this.root&&(Object(w.a)(e.parentNode.childNodes).forEach((function(t){"g"===t.tagName&&t!==e&&t.setAttributeNS(null,"opacity",.3)})),this.applyCurrentGroupOpacity(e.parentNode))}},{key:"dropCurrentGroupOpacity",value:function(e){Object(w.a)(e.parentNode.childNodes).forEach((function(t){"g"===t.tagName&&t!==e&&t.setAttributeNS(null,"opacity",1)}))}},{key:"handleUndo",value:function(){var e=this.props.undoStack.undo();e&&(this.ignoreStoring=!0,this.handleAction(e,!0))}},{key:"handleRedo",value:function(){var e=this.props.undoStack.redo();e&&(this.ignoreStoring=!0,this.handleAction(e,!1))}},{key:"handleAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(this.dropItems(),e.name){case"rotate":var a=e.data,n=this.setDraggable(e.el);n.exeRotate({delta:a*(t?-1:1)}),n.disable();break;case"move":var r=Object(x.a)(e.data,2),i=r[0],o=r[1],l=this.setDraggable(e.el);l.exeDrag({dx:i*(t?-1:1),dy:o*(t?-1:1)}),l.disable();break;case"resize":var c=e.data,s=c.dx,u=c.dy,d=Object(M.a)(c,["dx","dy"]),p=this.setDraggable(e.el);p.exeResize(K({dx:s*(t?-1:1),dy:u*(t?-1:1)},d)),p.disable()}}},{key:"render",value:function(){var e=this;return r.a.createElement("g",{id:"editable-content",ref:function(t){return e.root=t}})}}]),t}(r.a.Component),Q=Object(l.b)((function(e){return{editorGridSize:e.editorGridSize,allowDragging:e.allowDragging,allowResizing:e.allowResizing,allowRotating:e.allowRotating,allowProportions:e.allowProportions,allowRestrictions:e.allowRestrictions,allowRotationOrigin:e.allowRotationOrigin,snapSteps:e.snapSteps,eventBus:e.eventBus,undoStack:e.undoStack}}),(function(e){return{$setSelectedItems:function(t){return e({type:"SET_SELECTED_ITEMS",items:t.items})}}}))(J),ee=Object(S.a)((function(){return{root:{"-webkit-box-flex":1,"-ms-flex":1,flex:1,visibility:"visible"},workArea:{overflow:"auto"},canvas:{position:"absolute",top:0,left:0},canvasContent:{backgroundColor:"white"},page:{boxShadow:"0px 0px 2px 1px #d1d1d1"},layerBar:{position:"absolute",zIndex:99999,margin:4}}})),te=function(e){var t=ee(),a=e.editorAction,i=e.editorGrid,o=e.editorGridSize,l=e.editorPaperSize,c=e.rightOffset,s=e.children,u=l.width,d=l.height,p=[window.outerWidth,window.outerHeight],m=p[0],b=p[1],g=Object(n.useState)({w:u,h:d,x:(m-u)/2,y:(b-d)/2}),f=Object(x.a)(g,2),h=f[0],v=f[1],y=null,O=null,E=Object(n.useRef)(null),w=Object(n.useRef)(null),j=Object(n.useRef)(null),S=Object(n.useState)(null),k=Object(x.a)(S,2),C=k[0],N=k[1],P=Object(n.useState)(null),R=Object(x.a)(P,2),D=R[0],A=R[1],T=Object(n.useState)(!1),I=Object(x.a)(T,2),L=I[0],z=I[1],G=Object(n.useState)({x:0,y:0}),_=Object(x.a)(G,2),M=_[0],V=_[1],$=Object(n.useState)(!1),H=Object(x.a)($,2),X=H[0],Y=H[1];Object(n.useEffect)((function(){!function(e){var t=w.current;t.scrollTop=(e.current.clientHeight-t.clientHeight)/2,t.scrollLeft=(e.current.clientWidth-t.clientWidth)/2}(E)}),[h]),Object(n.useEffect)((function(){v({w:u,h:d,x:(m-u)/2,y:(b-d)/2})}),[e.editorPaperSize]);var U=function(e,t,a){var n=e.createSVGPoint();return n.x=t,n.y=a,n.matrixTransform(e.getScreenCTM().inverse())},F=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","rect");t.setAttributeNS(null,"stroke-width",2),t.setAttributeNS(null,"fill","none"),t.setAttributeNS(null,"stroke","#000");var a=document.getElementById("editor-background"),n=U(a,e.clientX,e.clientY);document.getElementById("editable-content").appendChild(t);var r=function(e){var r=U(a,e.clientX,e.clientY),i=Math.abs(r.x-n.x),o=Math.abs(r.y-n.y);r.x>n.x&&(r.x=n.x),r.y>n.y&&(r.y=n.y),t.setAttributeNS(null,"x",r.x),t.setAttributeNS(null,"y",r.y),t.setAttributeNS(null,"width",i),t.setAttributeNS(null,"height",o)};a.addEventListener("mousemove",r),a.addEventListener("mouseup",(function e(){a.removeEventListener("mousemove",r),a.removeEventListener("mouseup",e)}))};return r.a.createElement("div",{className:t.root},D&&r.a.createElement("p",{className:t.layerBar},D,r.a.createElement(B.a,{style:{marginLeft:2},variant:"contained",color:"primary",size:"small",onMouseUp:function(e){e.stopPropagation(),z(!0)}},"Exit")),r.a.createElement("div",{id:"work-area",ref:w,className:t.workArea,style:{top:0,left:0,right:c,bottom:0,position:"absolute",cursor:"auto",overflow:"scroll"},onMouseMove:function(e){switch(e.preventDefault(),C){case"grab":var t=1*(M.x-e.clientX),a=1*(M.y-e.clientY),n=w.current;n.scrollTop=M.scrollTop+a,n.scrollLeft=M.scrollLeft+t}},onMouseDown:function(t){switch(t.preventDefault(),a){case"edit":if(O.contains(t.target))return;if(!y.children[0].contains(t.target))return Y(!0),e.eventBus.emit("settings",null,"canvas"),setTimeout((function(){return Y(!1)}),100);break;case"grab":var n=w.current;V({x:t.clientX,y:t.clientY,scrollTop:n.scrollTop,scrollLeft:n.scrollLeft});break;case"select":case"zoom":break;case"drawRect":F(t)}N(a)},onMouseUp:function(){N(null)}},r.a.createElement("div",{ref:E,style:{display:"inline-block",position:"relative",width:m,height:b}},r.a.createElement("svg",{id:"editor-container",xmlns:"http://www.w3.org/2000/svg",className:t.canvas,width:"100%",height:"100%",overflow:"visible",ref:j},r.a.createElement(W,{enable:"zoom"===a},r.a.createElement("g",{id:"content",transform:"translate(".concat(h.x,", ").concat(h.y,")")},r.a.createElement("g",{id:"editor-background"},r.a.createElement("rect",{id:"editor-grid",x:"0",y:"0",width:h.w,height:h.h,fill:"white",stroke:"grey"}),i?function(e,t){var a=10*t;return r.a.createElement("g",null,r.a.createElement("defs",null,r.a.createElement("pattern",{id:"smallGrid",width:t,height:t,fill:"white",patternUnits:"userSpaceOnUse"},r.a.createElement("path",{d:"M ".concat(t," 0 L 0 0 0 ").concat(t),fill:"none",stroke:"gray",strokeWidth:"0.5",vectorEffect:"non-scaling-stroke"})),r.a.createElement("pattern",{id:"grid",width:a,height:a,patternUnits:"userSpaceOnUse"},r.a.createElement("rect",{width:a,height:a,fill:"url(#smallGrid)"}),r.a.createElement("path",{d:"M ".concat(a," 0 L 0 0 0 ").concat(a),fill:"none",stroke:"gray",strokeWidth:"1",vectorEffect:"non-scaling-stroke"}))),r.a.createElement("rect",{x:"0",y:"0",width:e.w,height:e.h,fill:"url(#grid)"}))}(h,o):null),r.a.createElement("g",{id:"editor-canvas",ref:function(e){return y=e},className:t.page},r.a.createElement(Q,{root:j,editable:"edit"===a,selectable:"select"===a,content:s,onLayerChange:function(e){A(e),z(!1)},dropLayer:L,dropItems:X})))),r.a.createElement("g",{id:"controls-container",ref:function(e){return O=e}})))))};te.defaultProps={grid:!0,mouseAction:"edit",initialW:800,initialH:600};var ae=Object(l.b)((function(e){return{editorAction:e.editorAction,editorGrid:e.editorGrid,editorGridSize:e.editorGridSize,editorPaperSize:e.editorPaperSize,eventBus:e.eventBus}}))(te),ne=a(6),re=a(338),ie=a(339),oe=a(340),le=a(341),ce=a(342),se=a(343),ue=a(344),de=a(345),pe=a(346),me=a(347),be=a(348),ge=a(349),fe=a(350),he=a(351),ve=Object(S.a)((function(){return{root:{display:"flex",alignItems:"center",height:"100%"},flex:{display:"flex",alignItems:"center",height:"100%",marginLeft:10},verticalDivider:{width:"1px",backgroundColor:"white",height:"30px"},toolbar:{display:"flex",alignItems:"center",padding:2,marginRight:5}}})),ye=Object(ne.a)({root:{color:"rgba(0,0,0,0.65)",padding:6}})(A.a),Oe=Object(l.b)((function(e){return{editorAction:e.editorAction,editorGrid:e.editorGrid,eventBus:e.eventBus}}),(function(e){return{$setEditorAction:function(t){return e({type:"SET_EDITOR_ACTION",editorAction:t.editorAction})},$activateEditorGrid:function(t){return e({type:"ACTIVATE_EDITOR_GRID",editorGrid:t.editorGrid})}}}))((function(e){var t=ve(),a=e.editorAction,n=e.editorGrid,i=e.eventBus,o=function(t){return function(){e.$setEditorAction({editorAction:t})}},l=function(t){e.$activateEditorGrid({editorGrid:t})},c=[{type:"button",selected:"showLayers"===a,component:r.a.createElement(re.a,null),action:function(){return"showLayers"}},{type:"divider"},{type:"button",selected:"edit"===a,component:r.a.createElement(ie.a,null),action:o("edit")},{type:"button",selected:"select"===a,component:r.a.createElement(oe.a,null),action:o("select")},{type:"button",selected:"grab"===a,component:r.a.createElement(le.a,null),action:o("grab")},{type:"button",selected:"zoom"===a,component:r.a.createElement(ce.a,null),action:o("zoom")},{type:"divider"},{type:"button",selected:"alignLeft"===a,component:r.a.createElement(se.a,{transform:"rotate(90)"}),action:function(){return i.emit("alignLeft")}},{type:"button",selected:"alignHorizontal"===a,component:r.a.createElement(ue.a,{transform:"rotate(90)"}),action:function(){return i.emit("alignHorizontal")}},{type:"button",selected:"alignRight"===a,component:r.a.createElement(se.a,{transform:"rotate(-90)"}),action:function(){return i.emit("alignRight")}},{type:"button",selected:"alignTop"===a,component:r.a.createElement(se.a,{transform:"rotate(180)"}),action:function(){return i.emit("alignTop")}},{type:"button",selected:"alignVertical"===a,component:r.a.createElement(ue.a,{transform:"rotate(180)"}),action:function(){return i.emit("alignVertical")}},{type:"button",selected:"alignBottom"===a,component:r.a.createElement(se.a,null),action:function(){return i.emit("alignBottom")}},{type:"divider"},{type:"button",selected:!0===n,component:r.a.createElement(de.a,null),action:function(){return l(!0)}},{type:"button",selected:!1===n,component:r.a.createElement(pe.a,null),action:function(){return l(!1)}},{type:"divider"},{type:"button",selected:!1,component:r.a.createElement(me.a,null),action:function(){return i.emit("undo")}},{type:"button",selected:!1,component:r.a.createElement(be.a,null),action:function(){return i.emit("redo")}}],s=[{type:"button",selected:!1,component:r.a.createElement(ge.a,null),action:function(){return i.emit("settings",null,"item")}},{type:"button",selected:!1,component:r.a.createElement(fe.a,null),action:function(){return i.emit("settings",null,"canvas")}},{type:"button",selected:!1,component:r.a.createElement(he.a,null),action:function(){return i.emit("settings",null,"animation")}}];return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.flex},c.map((function(e,a){var n=e.type,i=e.component,o=e.action,l=e.selected;e.value;return r.a.createElement("div",{key:"".concat(a,"button"),className:t.toolbar},"divider"!==n?r.a.createElement(ye,{disabled:l,onClick:function(){return o()}},i):r.a.createElement("div",{className:t.verticalDivider}))}))),r.a.createElement("div",{className:t.flex,style:{width:"100%",justifyContent:"flex-end"}},s.map((function(e,a){var n=e.type,i=e.component,o=e.action,l=e.selected;e.value;return r.a.createElement("div",{key:"".concat(a,"button"),className:t.toolbar},"divider"!==n?r.a.createElement(ye,{disabled:l,onClick:function(){return o()}},i):r.a.createElement("div",{className:t.verticalDivider}))}))))})),Ee=a(103),we=a.n(Ee),xe=a(149),je=a(150),Se=a.n(je),ke=a(151),Ce=a.n(ke),Ne=a(152),Pe=a.n(Ne);function Re(e){return new Promise((function(t,a){if(window.File&&window.FileReader&&window.FileList&&window.Blob){var n=new FileReader,r="";e.files&&e.files[0]&&(n.onload=function(e){r=e.target.result,t(r)},n.readAsText(e.files[0]))}else a()}))}var De=Object(S.a)((function(e){return{root:{display:"flex",justifyContent:"center",padding:"0 8px"},extendedIcon:{marginRight:e.spacing(1)}}})),Ae=Object(ne.a)({root:{color:"#fff",marginRight:"10px"}})(A.a),Te=function(e){var t=De(),a=Object(n.useState)(document.createElement("input")),i=Object(x.a)(a,2),o=i[0],l=i[1];Object(n.useEffect)((function(){var t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("accept","image/*"),t.setAttribute("id","file-upload"),t.style.display="none",l(t);var a=function(){var t=Object(xe.a)(we.a.mark((function t(a){var n;return we.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Re(a.target);case 3:n=t.sent,e.onImport(n),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}();t.addEventListener("change",a,!1)}),[e]);return r.a.createElement("div",{className:t.root},r.a.createElement(Ae,{onClick:function(e){o.click(),e.preventDefault(),e.target.value=""}},r.a.createElement(Se.a,null)),r.a.createElement(Ae,{onClick:function(){e.onExport()}},r.a.createElement(Ce.a,null)),r.a.createElement(Ae,{onClick:function(){return e.onClearArea()}},r.a.createElement(Pe.a,null)))},Ie=a(356),Le=a(357),ze=a(358),Ge=a(359),_e=a(352),Be=a(353),We=a(354),Me=a(355),Ve=[["rectangle",_e.a],["circle",Be.a],["shape",We.a],["text",Me.a]],$e=function(e){var t=[],a=Object(n.useState)(!1),i=Object(x.a)(a,2),o=i[0],l=i[1],c={appendTo:"body",stack:"#editor-background",style:{border:"none",background:"transparent",maxWidth:"150px",textColor:"transparent"},onInit:function(){},onDrop:function(t){var a=this.elements[0].getAttribute("data-type"),n=null,r=document.querySelector("#editor-background"),i=r.getBoundingClientRect(),o=t.clientX-i.left+r.scrollLeft,l=t.clientY-i.top+r.scrollTop;switch(a){case"rectangle":n=["rect",{x:o,y:l,width:150,height:100,stroke:"black",fill:"transparent"}];break;case"circle":n=["ellipse",{cx:o,cy:l,rx:45,ry:45,stroke:"black",fill:"transparent"}];break;case"shape":n=["polygon",{strokeWidth:"1",stroke:"black",fill:"transparent",strokeDasharray:"0",points:"".concat(o+80,",").concat(l," ").concat(o+160,",").concat(l+50," ").concat(o+80,",").concat(l+100," ").concat(o,",").concat(l+50)},[]];break;case"image":n=["foreignObject",{x:o,y:l,width:150,height:100,stroke:"black",fill:"transparent"},[["div",{display:"block"},["text"]]]];break;case"text":n=["text",{x:o,y:l},"text"]}e.onDrop(t,n)}};return Object(n.useEffect)((function(){o||(t.forEach((function(e){return Object(X.a)(e).clone(c)})),l(!0))}),[t,o,c]),r.a.createElement(Ie.a,null,Ve.map((function(e){var a=Object(x.a)(e,2),n=a[0],i=a[1];return r.a.createElement(Le.a,{"data-type":n,ref:function(e){return t.push(e)},button:!0,key:n},r.a.createElement(ze.a,null,r.a.createElement(i,null)),r.a.createElement(Ge.a,{primary:n}))})))},He=a(372),Xe=a(362),Ye=a(363),Ue=a(62),Fe=a(364),Ke=a(374),Ze=a(371),qe=a(160);function Je(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Qe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(a),!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Je(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var et=function(e){function t(){var e,a;Object(b.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(V.a)(this,(e=Object($.a)(t)).call.apply(e,[this].concat(r)))).state={displayColorPicker:!1,currentColor:{hex:a.props.initValue||a.props.value||"transparent"},popover:{position:"absolute",zIndex:"9999",top:0,left:0}},a.handleClick=function(e){var t=e.clientX,n=e.clientY,r=e.target,i=r.clientWidth;r.clientHeight;a.setState({displayColorPicker:!a.state.displayColorPicker,popover:Qe({},a.state.popover,{left:t-i,top:n})})},a.handleClose=function(){a.setState({displayColorPicker:!1})},a.handleChange=function(e){a.setState({currentColor:e}),a.props.onChange(e)},a}return Object(H.a)(t,e),Object(g.a)(t,[{key:"componentDidUpdate",value:function(){this.props.value!==this.state.currentColor.hex&&this.setState({currentColor:{hex:this.props.value}})}},{key:"render",value:function(){return r.a.createElement("div",{className:this.props.classes.root},r.a.createElement("div",{className:this.props.classes.wrapper},r.a.createElement("div",{className:this.props.classes.colorPicker,onClick:this.handleClick,style:{backgroundColor:this.state.currentColor.hex}})),this.state.displayColorPicker?o.a.createPortal(r.a.createElement("div",{style:this.state.popover},r.a.createElement("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:this.handleClose}),r.a.createElement(qe.a,{color:this.state.currentColor,onChange:this.handleChange})),document.body):null)}}]),t}(r.a.Component),tt=Object(ne.a)((function(){var e,t;return{root:(e={width:"50%",padding:0,border:0,margin:0,display:"inline-flex"},Object(d.a)(e,"padding",0),Object(d.a)(e,"position","relative"),Object(d.a)(e,"flexDirection","column"),Object(d.a)(e,"verticalAlign","top"),e),wrapper:{padding:10,color:"rgba(0, 0, 0, 0.87)",cursor:"text",display:"inline-flex",position:"relative",fontSize:"1rem",boxSizing:"border-box",alignItems:"center",lineHeight:"1.0876em"},colorPicker:(t={flex:"0 1 100%",border:0,height:"1.0876em",margin:0,display:"block",padding:"6px 0 7px",minWidth:0,background:"none",boxSizing:"content-box"},Object(d.a)(t,"border","2px solid #c7c7c7"),Object(d.a)(t,"borderRadius",4),t)}}))(et);function at(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var nt=Object(S.a)((function(){return{root:{position:"absolute",right:0,top:0,bottom:0,backgroundColor:"#fdfdfd",zIndex:999},container:{display:"flex",flex:1},containerColumn:{display:"flex",flexDirection:"column"},padding:{padding:10},label:{paddingLeft:10}}})),rt=Object(ne.a)({root:{margin:10,"& .MuiOutlinedInput-input":{padding:"10px 10px"}}})(He.a),it=Object(ne.a)({root:{margin:"0"}})(Xe.a),ot=Object(l.b)((function(e){return{editorPaperSize:e.editorPaperSize,allowDragging:e.allowDragging,allowResizing:e.allowResizing,allowRotating:e.allowRotating,allowProportions:e.allowProportions,allowRestrictions:e.allowRestrictions,allowRotationOrigin:e.allowRotationOrigin,snapSteps:e.snapSteps,editorGridSize:e.editorGridSize,eventBus:e.eventBus}}),(function(e){return{$setEditorPaperSize:function(t){return e({type:"SET_EDITOR_PAPER_SIZE",editorPaperSize:t.editorPaperSize})},$setAllowDragging:function(t){return e({type:"SET_ALLOW_DRAGGING",allowDragging:t.allowDragging})},$setAllowResizing:function(t){return e({type:"SET_ALLOW_RESIZING",allowResizing:t.allowResizing})},$setAllowRotating:function(t){return e({type:"SET_ALLOW_ROTATING",allowRotating:t.allowRotating})},$setAllowProportions:function(t){return e({type:"SET_ALLOW_PROPORTIONS",allowProportions:t.allowProportions})},$setAllowRestrictions:function(t){return e({type:"SET_ALLOW_RESTRICTIONS",allowRestrictions:t.allowRestrictions})},$setSnapSteps:function(t){return e({type:"SET_SNAP_STEPS",snapSteps:t.snapSteps})},$setEditorGridSize:function(t){return e({type:"SET_EDITOR_GRID_SIZE",editorGridSize:t.editorGridSize})},$setAllowRotationOrigin:function(t){return e({type:"SET_ALLOW_ROTATION_ORIGIN",allowRotationOrigin:t.allowRotationOrigin})}}}))((function(e){var t=nt(),a=e.editorPaperSize,i=a.width,o=a.height,l=e.allowDragging,c=e.allowResizing,s=e.allowRotating,u=e.allowProportions,p=e.allowRestrictions,m=e.allowRotationOrigin,b=e.editorGridSize,g=e.snapSteps,f=Object(n.useState)({width:i,height:o}),h=Object(x.a)(f,2),v=h[0],y=h[1],O=Object(n.useState)(l),E=Object(x.a)(O,2),w=E[0],j=E[1],S=Object(n.useState)(c),k=Object(x.a)(S,2),C=k[0],N=k[1],P=Object(n.useState)(s),R=Object(x.a)(P,2),D=R[0],A=R[1],I=Object(n.useState)(u),L=Object(x.a)(I,2),z=L[0],G=L[1],_=Object(n.useState)(p),B=Object(x.a)(_,2),W=B[0],M=B[1],V=Object(n.useState)(m),$=Object(x.a)(V,2),H=$[0],X=$[1],Y=Object(n.useState)(g),U=Object(x.a)(Y,2),F=U[0],K=U[1],Z=Object(n.useState)("none"),q=Object(x.a)(Z,2),J=q[0],Q=q[1],ee=function(t){var a=Object(x.a)(t,2),n=a[0],r=a[1];if(!(Number(n)<1||Number(r)<1)){var i={width:n,height:r};y(i),e.$setEditorPaperSize({editorPaperSize:i})}},te=function(t){return function(a){var n=a.target.checked;switch(t){case"drag":j(n),e.$setAllowDragging({allowDragging:n});break;case"resize":N(n),e.$setAllowResizing({allowResizing:n});break;case"rotate":A(n),e.$setAllowRotating({allowRotating:n});break;case"proportions":G(n),e.$setAllowProportions({allowProportions:n});break;case"restrictions":M(n),e.$setAllowRestrictions({allowRestrictions:n});break;case"rotationOrigin":X(n),e.$setAllowRotationOrigin({allowRotationOrigin:n})}}},ae=function(t){var a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?at(Object(a),!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):at(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},F,{},t);K(a),e.$setSnapSteps({snapSteps:a})};return Object(n.useEffect)((function(){var e=document.getElementById("editor-grid");Q(e.getAttributeNS(null,"fill"))}),[]),r.a.createElement("div",{className:t.root,style:{width:e.width}},r.a.createElement("form",null,r.a.createElement(Ye.a,{"aria-label":"position"},r.a.createElement("div",{className:t.padding},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Canvas"),r.a.createElement("div",{className:t.container},r.a.createElement(rt,{label:"width",value:v.width,variant:"outlined",size:"small",onChange:function(e){return ee([e.target.value,v.height])}}),r.a.createElement(rt,{label:"height",value:v.height,variant:"outlined",size:"small",onChange:function(e){return ee([v.width,e.target.value])}})),r.a.createElement("div",{className:t.container},r.a.createElement(tt,{value:J,onChange:function(e){Q(e.hex),document.getElementById("editor-grid").setAttributeNS(null,"fill",e.hex)}})),r.a.createElement(Fe.a,{container:!0},r.a.createElement(Fe.a,{item:!0,xs:12},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Grid size"),r.a.createElement("div",{style:{display:"flex",alignItems:"center",padding:"0 10px"}},r.a.createElement(Ke.a,{valueLabelDisplay:"auto",value:b,onChange:function(t,a){return e.$setEditorGridSize({editorGridSize:a})},step:10}))))),r.a.createElement(T.a,null),r.a.createElement("div",{className:t.padding},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Effects"),r.a.createElement("div",{className:t.containerColumn},r.a.createElement(it,{value:w,control:r.a.createElement(Ze.a,{checked:w,color:"primary",onChange:te("drag")}),label:"Allow dragging",labelPlacement:"end"}),r.a.createElement(it,{value:C,control:r.a.createElement(Ze.a,{checked:C,color:"primary",onChange:te("resize")}),label:"Allow resizing",labelPlacement:"end"}),r.a.createElement(it,{value:D,control:r.a.createElement(Ze.a,{checked:D,color:"primary",onChange:te("rotate")}),label:"Allow rotating",labelPlacement:"end"}),r.a.createElement(it,{value:z,control:r.a.createElement(Ze.a,{checked:z,color:"primary",onChange:te("proportions")}),label:"Keep aspect ratio",labelPlacement:"end"}),r.a.createElement(it,{value:W,control:r.a.createElement(Ze.a,{checked:W,color:"primary",onChange:te("restrictions")}),label:"Activate bounding area",labelPlacement:"end"}),r.a.createElement(it,{value:H,control:r.a.createElement(Ze.a,{checked:H,color:"primary",onChange:te("rotationOrigin")}),label:"Use rotation origin",labelPlacement:"end"}))),r.a.createElement(T.a,null),r.a.createElement("div",{className:t.padding},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Snap"),r.a.createElement(Fe.a,{container:!0},r.a.createElement(Fe.a,{item:!0,xs:6},r.a.createElement(rt,{label:"grid step x",value:F.x,variant:"outlined",size:"small",onChange:function(e){return ae({x:Number(e.target.value)})}})),r.a.createElement(Fe.a,{item:!0,xs:6},r.a.createElement(rt,{label:"grid step y",value:F.y,variant:"outlined",size:"small",onChange:function(e){return ae({y:Number(e.target.value)})}}))),r.a.createElement(Fe.a,{container:!0},r.a.createElement(Fe.a,{item:!0,xs:6},r.a.createElement(rt,{label:"snap angle",value:F.angle,variant:"outlined",size:"small",onChange:function(e){return ae({angle:Number(e.target.value)})}})))))))})),lt=a(164),ct=a(369);function st(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ut(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?st(Object(a),!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):st(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var dt=Object(ne.a)((function(e){return{root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:16,paddingLeft:10,transition:e.transitions.create(["border-color","box-shadow"]),"&:focus":{borderRadius:4,borderColor:"#80bdff",boxShadow:"0 0 0 0.2rem rgba(0,123,255,.25)"}}}}))(lt.a),pt=Object(S.a)((function(){return{root:{position:"absolute",right:0,top:0,bottom:0,backgroundColor:"#fdfdfd",zIndex:999},container:{display:"flex",flex:1},containerColumn:{display:"flex",flexDirection:"column"},padding:{padding:10},label:{paddingLeft:10,width:"50%"}}})),mt=Object(l.b)((function(e){return{eventBus:e.eventBus,selectedItems:e.items}}))((function(e){var t=pt(),a=e.eventBus,i=e.selectedItems,o=Object(n.useState)("none"),l=Object(x.a)(o,2),c=l[0],s=l[1],u=Object(n.useState)("none"),p=Object(x.a)(u,2),m=p[0],b=p[1],g=Object(n.useState)("none"),f=Object(x.a)(g,2),h=f[0],v=f[1],y=Object(n.useState)("none"),O=Object(x.a)(y,2),E=O[0],w=O[1],j=Object(n.useState)(2),S=Object(x.a)(j,2),k=S[0],C=S[1],N=Object(n.useState)(100),P=Object(x.a)(N,2),R=P[0],D=P[1],A=Object(n.useState)(null),I=Object(x.a)(A,2),L=I[0],z=I[1],G=Object(n.useState)({letterSpacing:5,wordSpacing:1,lineHeight:1}),_=Object(x.a)(G,2),B=_[0],W=_[1],M=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];switch(e){case"fill":s(t),n&&a.emit(e,null,t);break;case"fillOptions":var r="color"===t?c:"none";b(t),n&&a.emit("fill",null,r);break;case"stroke":v(t),n&&a.emit(e,null,t);break;case"strokeOptions":var i="color"===t?h:"none";w(t),n&&a.emit("stroke",null,i);break;case"thickness":var o=null===t?2:t;C(Number(o)),n&&a.emit(e,null,o);break;case"opacity":var l=null===t?1:t;D(100*Number(l)),n&&a.emit(e,null,l);break;case"textContent":V(t),n&&a.emit(e);break;case"letterSpacing":case"wordSpacing":case"lineHeight":W((function(a){return ut({},a,Object(d.a)({},e,null===t?a[e]:Number(t)))})),n&&a.emit(e,null,t)}};Object(n.useEffect)((function(){if(i.length){var e="text"===i[0].elements[0].tagName.toLowerCase();Object.entries(ut({fill:"fill",stroke:"stroke",thickness:"stroke-width",opacity:"opacity"},e&&{letterSpacing:"letter-spacing",wordSpacing:"word-spacing",lineHeight:"line-height"})).map((function(e){var t=Object(x.a)(e,2),a=t[0],n=t[1];M(a,i[0].elements[0].getAttributeNS(null,n),!1)})),z(e?i[0].elements[0].textContent||"":null)}}),[i]);var V=function(e){z(e),i[0].elements[0].textContent=e};return r.a.createElement("div",{className:t.root,style:{width:e.width}},r.a.createElement("form",{style:{width:"100%"}},r.a.createElement(Ye.a,{"aria-label":"position"},r.a.createElement("div",{className:t.padding},r.a.createElement("div",{className:t.container},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Fill")),r.a.createElement("div",{className:t.container},r.a.createElement(tt,{value:c,onChange:function(e){return M("fill",e.hex)}}),r.a.createElement(ct.a,{style:{width:"50%",padding:10},variant:"outlined",native:!0,value:m,onChange:function(e){return M("fillOptions",e.target.value)},name:"age",input:r.a.createElement(dt,{value:m})},r.a.createElement("option",{value:"none"},"none"),r.a.createElement("option",{value:"color"},"color"))),r.a.createElement("div",{className:t.container},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Stroke")),r.a.createElement("div",{className:t.container},r.a.createElement(tt,{value:h,onChange:function(e){return M("stroke",e.hex)}}),r.a.createElement(ct.a,{style:{width:"50%",padding:10},variant:"outlined",native:!0,value:E,onChange:function(e){return M("strokeOptions",e.target.value)},name:"age",input:r.a.createElement(dt,{value:E})},r.a.createElement("option",{value:"none"},"none"),r.a.createElement("option",{value:"color"},"color"))),r.a.createElement("div",{className:t.container},r.a.createElement(Fe.a,{item:!0,xs:12},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Thickness"),r.a.createElement("div",{style:{display:"flex",alignItems:"center",padding:"0 10px"}},r.a.createElement(Ke.a,{valueLabelDisplay:"auto",max:30,value:k,onChange:function(e,t){return M("thickness",t)},step:1}))))),r.a.createElement(T.a,null),r.a.createElement("div",{className:t.padding},r.a.createElement("div",{className:t.container},r.a.createElement(Fe.a,{item:!0,xs:12},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Opacity"),r.a.createElement("div",{style:{display:"flex",alignItems:"center",padding:"0 10px"}},r.a.createElement(Ke.a,{valueLabelDisplay:"auto",max:100,value:R,onChange:function(e,t){return M("opacity",t/100)},step:1}))))),r.a.createElement(T.a,null),null!==L&&r.a.createElement("div",{className:t.padding},r.a.createElement("div",{className:t.container},r.a.createElement(Fe.a,{item:!0,xs:12},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Text"),r.a.createElement(dt,{style:{padding:10},value:L,onChange:function(e){return M("textContent",e.target.value)}}))),r.a.createElement("div",{className:t.container},r.a.createElement(Fe.a,{item:!0,xs:12},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Letter space"),r.a.createElement("div",{style:{display:"flex",alignItems:"center",padding:"0 10px"}},r.a.createElement(Ke.a,{valueLabelDisplay:"auto",max:50,value:B.letterSpacing,onChange:function(e,t){return M("letterSpacing",t)},step:1})))),r.a.createElement("div",{className:t.container},r.a.createElement(Fe.a,{item:!0,xs:12},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Word space"),r.a.createElement("div",{style:{display:"flex",alignItems:"center",padding:"0 10px"}},r.a.createElement(Ke.a,{valueLabelDisplay:"auto",max:100,value:B.wordSpacing,onChange:function(e,t){return M("wordSpacing",t)},step:1})))),r.a.createElement("div",{className:t.container},r.a.createElement(Fe.a,{item:!0,xs:12},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Line height"),r.a.createElement("div",{style:{display:"flex",alignItems:"center",padding:"0 10px"}},r.a.createElement(Ke.a,{valueLabelDisplay:"auto",max:200,value:B.lineHeight,onChange:function(e,t){return M("lineHeight",t)},step:1}))))))))})),bt=a(157),gt=a.n(bt),ft=a(158),ht=a.n(ft),vt=Object(ne.a)({root:{margin:10,"& .MuiOutlinedInput-input":{padding:"10px 10px"}}})(He.a),yt=Object(ne.a)((function(e){return{root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:16,paddingLeft:10,transition:e.transitions.create(["border-color","box-shadow"]),"&:focus":{borderRadius:4,borderColor:"#80bdff",boxShadow:"0 0 0 0.2rem rgba(0,123,255,.25)"}}}}))(lt.a),Ot=Object(S.a)((function(){return{root:{position:"absolute",right:0,top:0,bottom:0,backgroundColor:"#fdfdfd",zIndex:999},container:{display:"flex",flex:1},containerColumn:{display:"flex",flexDirection:"column"},padding:{padding:10},label:{paddingLeft:10,width:"50%"}}})),Et=Object(l.b)((function(e){return{globalData:e.globalData,selectedItems:e.items}}))((function(e){var t=Ot(),a=(e.globalData,e.selectedItems),i=Object(n.useState)([]),o=Object(x.a)(i,2),l=o[0],c=o[1],s=Object(n.useState)("translateX"),u=Object(x.a)(s,2),d=u[0],p=u[1],m=Object(n.useState)(""),b=Object(x.a)(m,2),g=b[0],f=b[1],h=Object(n.useState)(5e3),v=Object(x.a)(h,2),y=v[0],O=v[1],E=function(e,t){switch(e){case"frameType":p(t);break;case"frameValue":f(t);break;case"duration":O(t)}},j=Object(n.useCallback)((function(){if(a.length)Object(w.a)(a[0].elements).map((function(e){var t=e.cloneNode(!0);return Object(X.a)(t).css({transform:t.getAttributeNS(null,"transform")}),e.parentNode.appendChild(t),t}))}),[a,l]);return Object(n.useEffect)((function(){a.length}),[a]),r.a.createElement("div",{className:t.root,style:{width:e.width}},r.a.createElement("form",{style:{width:"100%"}},r.a.createElement(Ye.a,{"aria-label":"position"},r.a.createElement("div",{className:t.padding},r.a.createElement(Fe.a,{container:!0},r.a.createElement(Ue.a,{className:t.label,variant:"subtitle1",align:"left"},"Keyframes")),r.a.createElement(Fe.a,{container:!0},r.a.createElement(Fe.a,{item:!0,xs:6},r.a.createElement(ct.a,{style:{margin:10},variant:"outlined",native:!0,value:d,onChange:function(e){return E("frameType",e.target.value)},name:"age",input:r.a.createElement(yt,{value:1})},["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"].map((function(e){return r.a.createElement("option",{key:e,value:e},e)})))),r.a.createElement(Fe.a,{item:!0,xs:6},r.a.createElement(vt,{label:"value",variant:"outlined",size:"small",value:g,onChange:function(e){return E("frameValue",e.target.value)}}))),r.a.createElement(Fe.a,{container:!0},r.a.createElement(Fe.a,{item:!0,xs:6},r.a.createElement(vt,{label:"duration",variant:"outlined",size:"small",value:y,onChange:function(e){return E("duration",e.target.value)}}))),r.a.createElement("div",{style:{display:"flex",justifyContent:"end"}},r.a.createElement(gt.a,{onClick:function(){c([].concat(Object(w.a)(l),[{frameType:d,frameValue:parseFloat(g),duration:parseFloat(y)}]))}})),r.a.createElement(Fe.a,{container:!0},l.map((function(e,t){var a=e.frameType,n=e.duration;return r.a.createElement(Fe.a,{key:"".concat(t,"-").concat(a),container:!0},r.a.createElement(Fe.a,{item:!0,xs:6},a),r.a.createElement(Fe.a,{item:!0,xs:6},n))}))),r.a.createElement(A.a,{variant:"outlined",onClick:j},r.a.createElement(ht.a,null))))))}));function wt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function xt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(a),!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):wt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var jt=["g","rect","path","polygon","polyline","circle","ellipse","text","line","foreighobject"],St=Object(S.a)((function(e){return{root:{display:"flex",marginTop:46,minHeight:"calc(100vh - 46px)",height:"calc(100vh - 46px)",justifyItems:"center",backgroundColor:"#e6e5e5"},menu:{display:"flex",position:"absolute",top:0,left:0,height:46,width:"100%",zIndex:999,backgroundColor:e.palette.primary.main},canvas:{flexGrow:1},canvasContainer:{display:"flex",flex:1,flexDirection:"column"},appBar:{borderTop:"1px solid #fff",color:"rgba(0,0,0,0.65)",backgroundColor:"rgb(230 229 229)",zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),position:"relative",height:46},appBarShift:{transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:240,flexShrink:0,whiteSpace:"nowrap"},drawerPaper:{position:"relative",backgroundColor:"#fdfdfd"},drawerOpen:{width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:Object(d.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1},e.breakpoints.up("sm"),{width:e.spacing(7)+1}),toolbar:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},content:{flexGrow:1,padding:e.spacing(2)}}})),kt=Object(l.b)((function(e){return{eventBus:e.eventBus}}))((function(e){var t,a,i=St(),l=Object(k.a)(),c=Object(n.useState)(!1),s=Object(x.a)(c,2),u=s[0],p=s[1],m=Object(n.useState)(57),b=Object(x.a)(m,2),g=b[0],f=b[1],h=Object(n.useState)(null),v=Object(x.a)(h,2),y=v[0],O=v[1],E=Object(n.useState)("canvas"),S=Object(x.a)(E,2),C=S[0],L=S[1],G=new CSSStyleSheet,B=function(e){for(var t={},a=G.rules||G.cssRules,n=0;n<a.length;n++)if(a[n].selectorText===e)for(var r=0;r<a[n].style.length;r++){var i=a[n].style.item(r);t=xt({},t,Object(d.a)({},i,a[n].style[i]))}return t},W={replace:function(e){if("style"===e.name){var t=new CSSStyleSheet;return t.replace(e.children[0].data),Object(w.a)(t.rules).map((function(e){return G.insertRule(e.cssText,G.cssRules.length)})),r.a.createElement(r.a.Fragment,null)}if("use"===e.name){var a=e.attribs["xlink:href"]||e.attribs.href;if(!a)return e;e.parent.children.find((function(e){return e.attribs&&"#"+e.attribs.id===a}))}if("tag"===e.type&&-1!==jt.indexOf(e.name)){e.attribs=e.attribs||{};var n=e.attribs.class,i=void 0===n?"":n;"g"===e.name?e.attribs=xt({},e.attribs,{},B(".".concat(e.attribs.class)),{class:"layer ".concat(i)}):e.attribs=xt({},e.attribs,{},B(".".concat(e.attribs.class)),{class:i})}return e}};Object(n.useEffect)((function(){f(u?240:57)}),[u]),Object(n.useState)((function(){e.eventBus.on("settings",(function(e){return L(e)}))}),[]);var M=[{component:function(e){return r.a.createElement(ot,e)},condition:"canvas"===C},{component:function(e){return r.a.createElement(mt,e)},condition:"item"===C},{component:function(e){return r.a.createElement(Et,e)},condition:"animation"===C}].find((function(e){return!!e.condition})).component;return r.a.createElement("div",null,r.a.createElement("div",{className:i.menu},r.a.createElement(Te,{onImport:function(e){var t=N()(e,W);Array.isArray(t)&&(t=t.find((function(e){return"object"===typeof e&&"svg"===e.type})));var a=document.createElement("div");o.a.render(t,a,(function(){o.a.unmountComponentAtNode(a),O(a.childNodes[0])}))},onExport:function(){var e=document.getElementById("editor-canvas"),t=["width","height"].map((function(t){return e.getAttributeNS(null,t)})),a=Object(x.a)(t,2),n=a[0],r=a[1],i='<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(n,'" height="').concat(r,'">\n            ').concat(document.getElementById("editable-content").innerHTML,"\n        </svg>"),o=new Blob([i]);Object(P.saveAs)(o,"export_".concat((new Date).toISOString(),".svg"))},onClearArea:function(){O(!Boolean(y))}})),r.a.createElement("div",{className:i.root},r.a.createElement(R.a,null),r.a.createElement(D.a,{open:u,variant:"permanent",className:Object(j.a)(i.drawer,(t={},Object(d.a)(t,i.drawerOpen,u),Object(d.a)(t,i.drawerClose,!u),t)),classes:{paper:Object(j.a)(i.drawerPaper,(a={},Object(d.a)(a,i.drawerOpen,u),Object(d.a)(a,i.drawerClose,!u),a))}},r.a.createElement("div",{className:i.toolbar},r.a.createElement(A.a,{onClick:function(){p(!1)}},"rtl"===l.direction?r.a.createElement(_.a,null):r.a.createElement(z.a,null)),r.a.createElement(A.a,{color:"inherit","aria-label":"open drawer",onClick:function(){p(!0)},edge:"start",className:Object(j.a)(Object(d.a)({},i.hide,u))},r.a.createElement(_.a,null))),r.a.createElement(T.a,null),r.a.createElement($e,{onDrop:function(e,t){var a=document.createElement("div");o.a.render(r.a.createElement("svg",null,r.a.createElement.apply(r.a,Object(w.a)(t))),a,(function(){o.a.unmountComponentAtNode(a),document.querySelector("#editable-content").appendChild(a.childNodes[0].childNodes[0])}))}}),r.a.createElement(T.a,null)),r.a.createElement("div",{className:i.canvasContainer},r.a.createElement(I.a,{className:Object(j.a)(i.appBar,Object(d.a)({},i.appBarShift,u))},r.a.createElement(Oe,null)),r.a.createElement("div",{style:{position:"relative",height:"100%"}},r.a.createElement(ae,{leftOffset:g,topOffset:87,rightOffset:240,mouseAction:"edit"},y),r.a.createElement(M,{width:240})))))}));function Ct(){return r.a.createElement(kt,null)}var Nt=Object(c.a)({palette:{primary:{main:"#00a8ff",auxiliary:"#0a7e95",contrastText:"#fff"},secondary:{main:"#43a047"},error:{main:"#f33732",hover:"#b71c1c"},warning:{main:"#f57c00",hover:"#ffa726"},text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)"},disabled:{primary:"#1b202a",secondary:"#757575"}},typography:{fontSize:14,fontWeight:"normal",fontFamily:'-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif',subtitle1:{fontSize:12,fontWeight:400},h6:{fontSize:18,fontWeight:400,lineHeight:1.5},h5:{fontSize:20,fontWeight:400},h4:{fontSize:22,fontWeight:400},overline:{color:"#546e7a",fontSize:11,fontWeight:500,lineHeight:"13px"},caption:{fontSize:"0.8rem",fontWeight:400}},MuiPaper:{rounded:{borderRadius:"0.2rem"},elevation1:{boxShadow:"0 1px 5px 0 rgba(0,0,0,0.16), 0 1px 5px 0 rgba(0,0,0,0.12)"},elevation2:{boxShadow:"0px 3px 1px -2px rgba(0,0,0,0.2), 0px 2px 2px 0px rgba(0,0,0,0.14), 0px 1px 5px 0px rgba(0,0,0,0.12)"},elevation4:{boxShadow:"0 5px 10px -5px rgba(0,0,0,0.5)"}}});var Pt=function(){return r.a.createElement(l.a,{store:E},r.a.createElement(s.a,{theme:Nt},r.a.createElement("div",{className:"App"},r.a.createElement(Ct,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Pt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[172,1,2]]]);
//# sourceMappingURL=main.234aab43.chunk.js.map