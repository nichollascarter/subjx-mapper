{"version":3,"sources":["containers/UndoStack.js","reducers/index.js","store/index.js","components/helpers/ZoomableGroup.js","components/editor/EditorContent.js","components/editor/EditorCanvas.js","components/editor/EditorToolbar.js","actions/index.js","util/fileReader.js","components/editor/EditorMenu.js","components/editor/EditorItems.js","components/editor/settings/CanvasSettings.js","components/helpers/ColorPicker.js","components/editor/settings/ItemSettings.js","components/editor/Editor.js","components/Main.js","App.js","serviceWorker.js","index.js"],"names":["UndoStack","self","this","stack","step","length","push","data","shift","splice","item","initialState","editorAction","editorGrid","editorGridSize","editorPaperSize","width","height","allowDragging","allowResizing","allowRotating","allowProportions","allowRestrictions","snapSteps","x","y","angle","eventBus","EventBus","undoStack","rootReducer","state","action","type","store","createStore","ZoomableGroup","props","zoomEl","useRef","useState","transform","setTransform","mouse","oldX","oldY","button","matrix","scale","pos","view","m","dirty","applyTo","update","join","toFixed","pan","amount","scaleAt","at","prescale","mouseEvent","useCallback","event","enable","el","current","clientX","clientY","preventDefault","events","e","offset","parentNode","getBoundingClientRect","left","top","deltaY","useEffect","map","eventName","eventFunc","addEventListener","passive","removeEventListener","id","ref","children","subjxConfiguration","container","controlsContainer","rotatorAnchor","rotatorOffset","EditorContainer","editable","selectable","items","currentGroup","ignoreStoring","nextProps","content","dropItems","childNodes","appendChild","firstChild","handleDropLayer","lastElementChild","removeChild","dropLayer","Boolean","makeSelectables","stop","handleClick","bind","handleDoubleClick","handleKeyDown","handleUndo","handleRedo","reloadDraggables","document","classList","add","subscribeToEvents","on","Object","entries","fill","stroke","thickness","opacity","attribute","val","forEach","setAttributeNS","l","r","h","t","b","v","key","applyAlignment","value","target","subjx","drag","restrict","draggable","resizable","rotatable","proportions","snap","onInit","console","log","options","scalable","tagName","toLowerCase","storage","handles","tr","tl","lx1","cx","baseVal","ly1","cy","lx2","ly2","lineLength","calcTooltipPosition","nextX","nextY","tooltip","createElementNS","actionButton","indexOf","disable","controls","onResize","dx","dy","setEditable","querySelector","revX","revY","doW","doH","setItem","name","onMove","onRotate","delta","onDrop","setTimeout","next","onDestroy","remove","start","newItems","setDraggable","direction","startPoint","lengthX","lengthY","theta","Math","atan2","PI","Number","cos","sin","ds","DragSelect","selectables","area","root","subscribe","selected","pop","find","child","contains","stopPropagation","ctrlKey","onLayerChange","getLayerPath","applyCurrentGroupOpacity","nextCurrentGroup","dropCurrentGroupOpacity","node","layerChain","getAttribute","nodeName","nextItems","keyCode","exeDrag","undo","handleAction","redo","revert","sjxEl","exeRotate","rest","exeResize","React","Component","connect","useStyles","makeStyles","flex","visibility","workArea","overflow","canvas","position","canvasContent","backgroundColor","page","boxShadow","layerBar","zIndex","margin","EditorCanvas","classes","rightOffset","initialW","initialH","window","outerWidth","outerHeight","paperWidth","paperHeight","w","paperSize","setPaperSize","canvasEl","controlsRef","workAreaRef","containerAreaRef","rootSVG","localAction","setLocalAction","layersBar","setLayersBar","setParentLayer","setStartPoint","setDropItems","scrollTop","clientHeight","scrollLeft","clientWidth","scrollToRef","svgPoint","elem","p","createSVGPoint","matrixTransform","getScreenCTM","inverse","drawElement","rect","drawArea1","getElementById","drawRect","abs","endDraw","className","Button","style","marginLeft","variant","color","size","onMouseUp","right","bottom","cursor","onMouseMove","onMouseDown","display","xmlns","gridSize","grid","patternUnits","d","strokeWidth","vectorEffect","canvasGrid","EditorContent","div","defaultProps","mouseAction","alignItems","verticalDivider","toolbar","padding","marginRight","ExtendedButton","withStyles","IconButton","dispatch","$setEditorAction","act","$activateEditorGrid","setEditorAction","activateEditorGrid","buttons","component","Layers","Navigation","PhotoSizeSelectSmall","PanTool","Search","emit","GridOn","GridOff","Undo","Redo","index","disabled","onClick","justifyContent","readText","filePath","Promise","resolve","reject","File","FileReader","FileList","Blob","reader","output","files","onload","result","readAsText","theme","extendedIcon","spacing","EditorMenu","createElement","fileSelector","setFileSelector","setAttribute","loadFiles","a","res","onImport","click","onExport","onClearArea","Rectangle","Circle","Shape","Text","EditorItems","droppables","isCloneable","setAsCloneable","cloneConfig","appendTo","border","background","maxWidth","textColor","itemType","newItem","editorRef","rx","ry","strokeDasharray","points","textLength","clone","List","text","Icon","ListItem","data-type","ListItemIcon","ListItemText","primary","containerColumn","flexDirection","label","paddingLeft","TextInput","TextField","CheckboxLabel","FormControlLabel","$setEditorPaperSize","$setAllowDragging","$setAllowResizing","$setAllowRotating","$setAllowProportions","$setAllowRestrictions","$setSnapSteps","$setEditorGridSize","dragging","setDragging","resizing","setResizing","rotating","setRotating","setProportions","restrictions","setRestrictions","setSnap","handleChange","handleSettings","checked","handleSnapChange","snapValues","FormControl","FormGroup","aria-label","Typography","align","onChange","Grid","xs","Slider","valueLabelDisplay","Divider","control","Checkbox","labelPlacement","ColorPicker","displayColorPicker","currentColor","hex","initValue","popover","setState","handleClose","wrapper","colorPicker","ReactDOM","createPortal","body","fontSize","boxSizing","lineHeight","minWidth","BootstrapInput","marginTop","input","borderRadius","palette","paper","transition","transitions","create","borderColor","InputBase","setFill","fillOptions","setFillOptions","setStroke","strokeOptions","setStrokeOptions","setThickness","setOpacity","setValue","Select","native","max","allowedSvgs","minHeight","justifyItems","menu","main","flexGrow","canvasContainer","appBar","borderTop","drawer","easing","sharp","duration","leavingScreen","appBarShift","enteringScreen","menuButton","hide","flexShrink","whiteSpace","drawerPaper","drawerOpen","drawerClose","overflowX","breakpoints","up","useTheme","open","setOpen","leftOffset","setLeftOffset","setContent","showSettings","setSettingsTab","parsedStyleSheet","CSSStyleSheet","getStyleRule","cssText","rules","cssRules","selectorText","propertyName","parserOptions","replace","domNode","styleSheet","rule","insertRule","attribs","href","parent","childNode","class","reactSVGEl","parse","Array","isArray","element","render","unmountComponentAtNode","attr","getAttributeNS","rootHTML","innerHTML","blob","saveAs","Date","toISOString","CssBaseline","Drawer","clsx","edge","_","nodeProps","AppBar","topOffset","Main","outerTheme","createMuiTheme","auxiliary","contrastText","secondary","error","hover","warning","typography","fontWeight","fontFamily","subtitle1","h6","h5","h4","overline","caption","MuiPaper","rounded","elevation1","elevation2","elevation4","App","ThemeProvider","location","hostname","match","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.7c313611.chunk.js","sourcesContent":["class UndoStack {\r\n\r\n    constructor(self) {\r\n        this.stack = [null];\r\n        this.step = -1;\r\n        this.self = self;\r\n    }\r\n\r\n    next() {\r\n        const { stack } = this;\r\n        if (stack[stack.length - 1] !== null) {\r\n            this.step++;\r\n            stack.push(null);\r\n        }\r\n    }\r\n\r\n    setItem(data) {\r\n        const { stack } = this;\r\n        stack[stack.length - 1] = data;\r\n\r\n        if (stack.length > 9) {\r\n            stack.shift();\r\n        };\r\n    }\r\n\r\n    push(data) {\r\n        this.step++;\r\n\r\n        this.stack.splice(this.step);\r\n        this.stack.push(data);\r\n    }\r\n\r\n    undo() {\r\n        let item;\r\n        const { stack } = this;\r\n\r\n        if (this.step >= 0) {\r\n            item = stack[this.step];\r\n            this.step--;\r\n            return item;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n    redo() {\r\n        const { stack } = this;\r\n\r\n        this.step = this.step === -1 ? 0 : this.step;\r\n        if (stack.length - 1 > this.step) {\r\n            return stack[this.step++];\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    invalidateAll() {\r\n        this.stack = [];\r\n        this.step = -1;\r\n    }\r\n\r\n}\r\n\r\nexport default UndoStack;","import EventBus from 'js-event-bus';\r\nimport UndoStack from '../containers/UndoStack';\r\n\r\nconst initialState = {\r\n    editorAction: 'edit',\r\n    editorGrid: true,\r\n    editorGridSize: 10,\r\n    editorPaperSize: {\r\n        width: 800,\r\n        height: 600\r\n    },\r\n    allowDragging: true,\r\n    allowResizing: true,\r\n    allowRotating: true,\r\n    allowProportions: true,\r\n    allowRestrictions: false,\r\n    snapSteps: {\r\n        x: 10,\r\n        y: 10,\r\n        angle: 15\r\n    },\r\n    eventBus: new EventBus(),\r\n    undoStack: new UndoStack()\r\n};\r\n\r\nfunction rootReducer(state = { ...initialState }, action) {\r\n    switch (action.type) {\r\n\r\n        case 'SET_EDITOR_ACTION':\r\n            return {\r\n                ...state,\r\n                editorAction: action.editorAction\r\n            };\r\n        case 'ACTIVATE_EDITOR_GRID':\r\n            return {\r\n                ...state,\r\n                editorGrid: action.editorGrid\r\n            };\r\n        case 'SET_EDITOR_GRID_SIZE':\r\n            return {\r\n                ...state,\r\n                editorGridSize: action.editorGridSize\r\n            };\r\n        case 'SET_EDITOR_PAPER_SIZE':\r\n            return {\r\n                ...state,\r\n                editorPaperSize: action.editorPaperSize\r\n            };\r\n        case 'SET_ALLOW_DRAGGING':\r\n            return {\r\n                ...state,\r\n                allowDragging: action.allowDragging\r\n            };\r\n        case 'SET_ALLOW_RESIZING':\r\n            return {\r\n                ...state,\r\n                allowResizing: action.allowResizing\r\n            };\r\n        case 'SET_ALLOW_ROTATING':\r\n            return {\r\n                ...state,\r\n                allowRotating: action.allowRotating\r\n            };\r\n        case 'SET_ALLOW_PROPORTIONS':\r\n            return {\r\n                ...state,\r\n                allowProportions: action.allowProportions\r\n            };\r\n        case 'SET_ALLOW_RESTRICTIONS':\r\n            return {\r\n                ...state,\r\n                allowRestrictions: action.allowRestrictions\r\n            };\r\n        case 'SET_SNAP_STEPS':\r\n            return {\r\n                ...state,\r\n                snapSteps: action.snapSteps\r\n            };\r\n        default:\r\n            return state;\r\n\r\n    }\r\n};\r\n\r\nexport default rootReducer;","import { createStore } from 'redux';\r\nimport rootReducer from '../reducers';\r\n\r\nconst store = createStore(rootReducer);\r\n\r\nexport default store;","import React, { useEffect, useState, useRef, useCallback } from 'react';\n\nconst ZoomableGroup = (props) => {\n    let zoomEl = useRef(null);\n    const [transform, setTransform] = useState('matrix(1,0,0,1,0,0)');\n    const mouse = { x: 0, y: 0, oldX: 0, oldY: 0, button: false };\n    const matrix = [1, 0, 0, 1, 0, 0];\n    let scale = 1;\n    const pos = { x: 0, y: 0 };\n\n    const view = (() => {\n        const m = matrix;\n\n        let dirty = true;\n        const API = {\n            applyTo() {\n                if (dirty) { this.update(); }\n                setTransform(`matrix(${m.join(',')})`);\n            },\n            update() {\n                dirty = false;\n                m[3] = m[0] = scale.toFixed(5);\n                m[2] = m[1] = 0;\n                m[4] = pos.x.toFixed(5);\n                m[5] = pos.y.toFixed(5);\n            },\n            pan(amount) {\n                if (dirty) { this.update(); }\n                pos.x += amount.x;\n                pos.y += amount.y;\n                dirty = true;\n            },\n            scaleAt(at, amount) {\n                const prescale = scale * amount;\n                if (prescale < 0.4 || prescale > 5) return;\n\n                if (dirty) { this.update(); }\n                scale *= amount;\n                pos.x = at.x - (at.x - pos.x) * amount;\n                pos.y = at.y - (at.y - pos.y) * amount;\n                dirty = true;\n            }\n        };\n        return API;\n    })();\n\n    const mouseEvent = useCallback((event) => {\n        if (props.enable === false) return;\n        const el = zoomEl.current;\n        if (event.type === 'mousedown') { mouse.button = true; }\n        if (event.type === 'mouseup' || event.type === 'mouseout') { mouse.button = false; }\n        mouse.oldX = mouse.x;\n        mouse.oldY = mouse.y;\n        mouse.x = event.clientX;\n        mouse.y = event.clientY;\n        if (mouse.button) {\n            view.pan({ x: mouse.x - mouse.oldX, y: mouse.y - mouse.oldY });\n            view.applyTo(el);\n        }\n        event.preventDefault();\n    });\n\n    const mouseWheelEvent = useCallback((e) => {\n        if (props.enable === false) return;\n        const el = zoomEl.current;\n        const offset = el.parentNode.getBoundingClientRect();\n        const x = e.clientX - offset.left;\n        const y = e.clientY - offset.top;\n\n        view.scaleAt({ x, y }, e.deltaY < 0 ? 1.1 : (1 / 1.1));\n        view.applyTo(el);\n        e.preventDefault();\n    }, [props.enable]);\n\n    const resetZoom = useCallback(() => {\n        scale = 1;\n        pos.x = pos.y = 0;\n        matrix[0] = matrix[3] = 1;\n        matrix[1] = matrix[2] = matrix[4] = matrix[5] = 0;\n        view.pan(pos);\n        view.scaleAt({ x: 0, y: 0 }, 1);\n        view.applyTo(zoomEl.current);\n    });\n\n    const events = [\n        ['mousemove', mouseEvent],\n        ['mousedown', mouseEvent],\n        ['mouseup', mouseEvent],\n        ['mouseout', mouseEvent],\n        ['wheel', mouseWheelEvent],\n        ['dblclick', resetZoom]\n    ];\n\n    useEffect(() => {\n        const el = zoomEl.current;\n\n        if (props.enable) {\n            events.map(([eventName, eventFunc]) => {\n                el.parentNode.addEventListener(eventName, eventFunc, { passive: false });\n            });\n        }\n\n        return () => {\n            events.map(([eventName, eventFunc]) => {\n                el.parentNode.removeEventListener(eventName, eventFunc, { passive: false });\n            });\n        };\n    }, [props.enable]);\n\n    return (\n        <g id='zoom-container' ref={zoomEl} transform={transform}>\n            {props.children}\n        </g>\n    );\n};\n\nexport default ZoomableGroup;","import React from 'react';\nimport { connect } from 'react-redux';\nimport subjx from 'subjx';\nimport DragSelect from 'dragselect';\n\nconst subjxConfiguration = {\n    container: '#editor-container',\n    controlsContainer: '#controls-container',\n    rotatorAnchor: 'n',\n    rotatorOffset: 30\n};\n\nconst mapStateToProps = (state) => ({\n    editorGridSize: state.editorGridSize,\n    allowDragging: state.allowDragging,\n    allowResizing: state.allowResizing,\n    allowRotating: state.allowRotating,\n    allowProportions: state.allowProportions,\n    allowRestrictions: state.allowRestrictions,\n    snapSteps: state.snapSteps,\n    eventBus: state.eventBus,\n    undoStack: state.undoStack\n});\n\nclass EditorContainer extends React.Component {\n\n    el = null;\n    editable = false;\n    selectable = null;\n    items = [];\n    currentGroup = null;\n    ignoreStoring = false;\n\n    shouldComponentUpdate(nextProps) {\n        if (this.el) {\n            if (nextProps.content !== this.props.content) {\n                this.dropItems();\n                this.currentGroup = this.el;\n\n                if (nextProps.content && nextProps.content.childNodes) {\n                    while (nextProps.content.childNodes.length) {\n                        this.el.appendChild(nextProps.content.firstChild);\n                    }\n                } else {\n                    this.handleDropLayer();\n                    while (this.el.lastElementChild) {\n                        this.el.removeChild(this.el.lastElementChild);\n                    }\n                }\n            }\n        }\n\n        if (nextProps.dropLayer) {\n            this.handleDropLayer();\n        }\n\n        if (\n            (nextProps.dropItems === true || !nextProps.editable) &&\n            this.items.length\n        ) {\n            this.dropItems();\n        }\n\n        if (nextProps.selectable !== Boolean(this.selectable)) {\n            if (nextProps.selectable) {\n                this.selectable = this.makeSelectables();\n            }\n            if (!nextProps.selectable && this.selectable) {\n                this.selectable.stop();\n                this.selectable = null;\n            }\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        this.currentGroup = this.el;\n\n        this.handleClick = this.handleClick.bind(this);\n        this.handleDoubleClick = this.handleDoubleClick.bind(this);\n        this.handleKeyDown = this.handleKeyDown.bind(this);\n        this.handleUndo = this.handleUndo.bind(this);\n        this.handleRedo = this.handleRedo.bind(this);\n        this.reloadDraggables = this.reloadDraggables.bind(this);\n\n        this.el.addEventListener('mouseup', this.handleClick);\n        this.el.addEventListener('dblclick', this.handleDoubleClick);\n        document.addEventListener('keydown', this.handleKeyDown);\n\n        this.el.classList.add('isolated-layer');\n\n        this.subscribeToEvents();\n    }\n\n    componentWillUnmount() {\n        this.el.removeEventListener('mouseup', this.handleClick);\n        this.el.removeEventListener('dblclick', this.handleDoubleClick);\n        document.removeEventListener('keydown', this.handleKeyDown);\n    }\n\n    subscribeToEvents() {\n        const { props: { eventBus } } = this;\n        eventBus.on('undo', this.handleUndo);\n        eventBus.on('redo', this.handleRedo);\n        eventBus.on('settingUpdated', this.reloadDraggables);\n\n        Object.entries({\n            fill: 'fill',\n            stroke: 'stroke',\n            thickness: 'stroke-width',\n            opacity: 'opacity'\n        }).map(([event, attribute]) => eventBus.on(event, (val) => {\n            this.items.forEach(item => item.el.setAttributeNS(null, attribute, val));\n        }));\n\n        Object.entries({\n            l: 'alignLeft',\n            r: 'alignRight',\n            h: 'alignHorizontal',\n            t: 'alignTop',\n            b: 'alignBottom',\n            v: 'alignVertical'\n        }).map(([key, event]) => eventBus.on(event, () => this.applyAlignment(key)));\n    }\n\n    setEditable(value) {\n        this.editable = value;\n    }\n\n    setDraggable(target) {\n        const self = this;\n        const {\n            items,\n            props\n        } = this;\n\n        const {\n            undoStack,\n            allowDragging,\n            allowResizing,\n            allowRotating,\n            allowProportions,\n            allowRestrictions,\n            snapSteps\n        } = props;\n\n        return subjx(target).drag({\n            ...subjxConfiguration,\n            ...(allowRestrictions && { restrict: '#editor-grid' }),\n            draggable: allowDragging,\n            resizable: allowResizing,\n            rotatable: allowRotating,\n            proportions: allowProportions,\n            snap: {\n                x: snapSteps.x,\n                y: snapSteps.y,\n                angle: snapSteps.y\n            },\n            onInit() {\n                // eslint-disable-next-line no-console\n                console.log('Draggable:: ', this.el);\n\n                this.options.scalable = this.el.tagName.toLowerCase() === 'text';\n\n                // disables selection if active\n                if (self.selectable && self.props.selectable) {\n                    self.selectable.stop();\n                }\n\n                const { tr, tl } = this.storage.handles;\n\n                const lx1 = tl.cx.baseVal.value;\n                const ly1 = tl.cy.baseVal.value;\n                const lx2 = tr.cx.baseVal.value;\n                const ly2 = tr.cy.baseVal.value;\n\n                const lineLength = [lx1 - lx2, ly1 - ly2];\n\n                const [nextX, nextY] = self.calcTooltipPosition(\n                    [lx2, ly2],\n                    lineLength,\n                    -30,\n                    45\n                );\n\n                const tooltip = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n                tooltip.setAttributeNS(null, 'transform', `translate(${nextX - 12}, ${nextY - 12})`);\n                tooltip.classList.add('delete-sjx-item');\n\n                const actionButton = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n                actionButton.setAttributeNS(null, 'd', 'M14.59 8L12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8');\n                actionButton.setAttributeNS(null, 'pointer-events', 'bounding-box');\n                actionButton.setAttributeNS(null, 'fill', 'rgb(237, 28, 36)');\n\n                tooltip.addEventListener('click', () => {\n                    items.splice(items.indexOf(this), 1);\n                    this.disable();\n                    this.el.parentNode.removeChild(this.el);\n                });\n                tooltip.appendChild(actionButton);\n\n                this.controls.appendChild(tooltip);\n            },\n            onResize({ dx, dy }) {\n                self.setEditable(true);\n\n                const { tr, tl } = this.storage.handles;\n\n                const lx1 = tl.cx.baseVal.value;\n                const ly1 = tl.cy.baseVal.value;\n                const lx2 = tr.cx.baseVal.value;\n                const ly2 = tr.cy.baseVal.value;\n\n                const lineLength = [lx1 - lx2, ly1 - ly2];\n\n                const [nextX, nextY] = self.calcTooltipPosition(\n                    [lx2, ly2],\n                    lineLength,\n                    -30,\n                    45\n                );\n\n                const tooltip = this.controls.querySelector('.delete-sjx-item');\n                tooltip.setAttributeNS(null, 'transform', `translate(${nextX - 12}, ${nextY - 12})`);\n\n                if (self.ignoreStoring) return self.ignoreStoring = false;\n                const { revX, revY, doW, doH } = this.storage;\n\n                undoStack.setItem({\n                    name: 'resize',\n                    el: this.el,\n                    data: {\n                        dx,\n                        dy,\n                        revX,\n                        revY,\n                        doW,\n                        doH\n                    }\n                });\n            },\n            onMove({ dx, dy }) {\n                self.setEditable(true);\n\n                if (self.ignoreStoring) return self.ignoreStoring = false;\n                undoStack.setItem({ name: 'move', el: this.el, data: [dx, dy] });\n            },\n            onRotate({ clientX, clientY, transform, delta }) {\n                self.setEditable(true);\n\n                if (self.ignoreStoring) return self.ignoreStoring = false;\n                undoStack.setItem({ name: 'rotate', data: delta, el: this.el });\n            },\n            onDrop() {\n                setTimeout(() => (\n                    self.setEditable(false)\n                ), 100);\n\n                if (self.ignoreStoring) return self.ignoreStoring = false;\n                undoStack.next();\n            },\n            onDestroy() {\n                setTimeout(() => (\n                    self.setEditable(false)\n                ), 100);\n                this.el.classList.remove('subjx-selected');\n                // enables selection if active\n                if (self.selectable && self.props.selectable) {\n                    self.selectable.start();\n                }\n            }\n        });\n    }\n\n    reloadDraggables() {\n        const { items } = this;\n        const newItems = items.map((item) => {\n            item.disable();\n            return item.el;\n        });\n\n        this.items = [...this.setDraggable(newItems)];\n    }\n\n    applyAlignment(direction) {\n        this.items.map((item) => {\n            item.applyAlignment(direction);\n            const { tr, tl } = item.storage.handles;\n\n            const lx1 = tl.cx.baseVal.value;\n            const ly1 = tl.cy.baseVal.value;\n            const lx2 = tr.cx.baseVal.value;\n            const ly2 = tr.cy.baseVal.value;\n\n            const lineLength = [lx1 - lx2, ly1 - ly2];\n\n            const [nextX, nextY] = this.calcTooltipPosition(\n                [lx2, ly2],\n                lineLength,\n                -30,\n                45\n            );\n\n            const tooltip = item.controls.querySelector('.delete-sjx-item');\n            tooltip.setAttributeNS(null, 'transform', `translate(${nextX - 12}, ${nextY - 12})`);\n        });\n    }\n\n    calcTooltipPosition(startPoint, lineLength, offset, angle) {\n        const [x, y] = startPoint;\n        const [lengthX, lengthY] = lineLength;\n\n        const theta = Math.atan2(\n            lengthY,\n            lengthX\n        ) - (angle * Math.PI / 180);\n\n        return [\n            Number(x) + offset * Math.cos(theta),\n            Number(y) + offset * Math.sin(theta)\n        ];\n    }\n\n    makeSelectables() {\n        const ds = new DragSelect({\n            selectables: this.currentGroup.children,\n            area: this.props.root.current\n        });\n\n        ds.subscribe('callback', ({ items: selected }) => {\n            const { items } = this;\n\n            while (items.length > 0) items.pop().disable();\n            if (!selected.length) return;\n\n            const newItems = this.setDraggable(selected);\n\n            this.items = [...newItems];\n        });\n\n        return ds;\n    }\n\n    handleClick(e) {\n        if (this.editable || !this.props.editable) return;\n\n        const {\n            currentGroup,\n            items\n        } = this;\n\n        const target = [...currentGroup.childNodes]\n            .find((child) => (\n                !(child.classList && child.classList.contains('sjx-drag')) &&\n                child.contains(e.target)\n            )) || (currentGroup === e.target ? e.target : null);\n\n        //console.log('Target:: ', target);\n        //console.log('Current group:: ', currentGroup);\n\n        if (!target) return;\n\n        e.stopPropagation();\n\n        if (!e.ctrlKey) {\n            while (items.length > 0) items.pop().disable();\n        }\n\n        const newItems = this.setDraggable(target);\n\n        items.push(...newItems);\n        this.items = items;\n    }\n\n    handleDoubleClick(e) {\n        e.preventDefault();\n        if (this.editable || !this.props.editable) return;\n\n        const { currentGroup } = this;\n\n        const target = [...currentGroup.childNodes]\n            .find((child) => (\n                (child.classList && child.classList.contains('sjx-drag')) &&\n                child.contains(e.target)\n            ));\n\n        if (target && target.tagName === 'g') {\n            this.dropItems();\n            this.currentGroup = target;\n            this.props.onLayerChange(\n                this.getLayerPath(target)\n            );\n            currentGroup.classList.remove('isolated-layer');\n            target.classList.add('isolated-layer');\n            this.applyCurrentGroupOpacity(target);\n        }\n    }\n\n    handleDropLayer() {\n        const { currentGroup } = this;\n        if (currentGroup === this.el) {\n            return this.props.onLayerChange(\n                this.getLayerPath(currentGroup)\n            );\n        }\n\n        this.dropItems();\n        currentGroup.classList.remove('isolated-layer');\n        const nextCurrentGroup = currentGroup.parentNode;\n        this.currentGroup = nextCurrentGroup;\n        this.props.onLayerChange(\n            this.getLayerPath(nextCurrentGroup)\n        );\n\n        this.dropCurrentGroupOpacity(currentGroup);\n        this.applyCurrentGroupOpacity(nextCurrentGroup);\n        nextCurrentGroup.classList.add('isolated-layer');\n    }\n\n    getLayerPath(target) {\n        let node = target;\n        let layerChain = '';\n\n        while (node !== this.el) {\n            layerChain = (node.getAttribute('id') || node.nodeName) + ' / ' + layerChain;\n            node = node.parentNode;\n        }\n\n        return layerChain;\n    }\n\n    dropItems(nextItems = []) {\n        const { items } = this;\n        while (items.length > 0) items.pop().disable();\n        this.items = nextItems;\n    }\n\n    handleKeyDown(e) {\n        const { items } = this;\n        if (e.keyCode === 46) {\n            while (items.length > 0) {\n                const item = items.pop();\n                item.disable();\n                item.el.parentNode.removeChild(item.el);\n            }\n        } else if (e.keyCode === 65 && e.ctrlKey) {\n            while (items.length > 0) items.pop().disable();\n            e.preventDefault();\n        } else if (e.keyCode === 67) {\n            // c\n        } else if (e.keyCode === 86) {\n            // v\n        } else if (e.keyCode > 36 && e.keyCode < 41) {\n            e.preventDefault();\n            items.forEach((item) => {\n                item.exeDrag({\n                    dx: e.keyCode === 37 || e.keyCode === 39 ? e.keyCode === 37 ? -10 : 10 : 0,\n                    dy: e.keyCode === 38 || e.keyCode === 40 ? e.keyCode === 38 ? -10 : 10 : 0\n                });\n            });\n        }\n    }\n\n    applyCurrentGroupOpacity(el) {\n        el.setAttributeNS(null, 'opacity', 1);\n        if (el === this.el) return;\n        [...el.parentNode.childNodes].forEach(child => {\n            if (child.tagName === 'g' && child !== el) child.setAttributeNS(null, 'opacity', 0.3);\n        });\n        this.applyCurrentGroupOpacity(el.parentNode);\n    }\n\n    dropCurrentGroupOpacity(el) {\n        [...el.parentNode.childNodes].forEach(child => {\n            if (child.tagName === 'g' && child !== el) child.setAttributeNS(null, 'opacity', 1);\n        });\n    }\n\n    handleUndo() {\n        const { undoStack } = this.props;\n\n        const item = undoStack.undo();\n\n        if (item) {\n            this.ignoreStoring = true;\n            this.handleAction(item, true);\n        }\n    }\n\n    handleRedo() {\n        const { undoStack } = this.props;\n\n        const item = undoStack.redo();\n\n        if (item) {\n            this.ignoreStoring = true;\n            this.handleAction(item, false);\n        }\n    }\n\n    handleAction(action = {}, revert) {\n        this.dropItems();\n\n        switch (action.name) {\n\n            case 'rotate': {\n                const delta = action.data;\n                const sjxEl = this.setDraggable(action.el);\n\n                sjxEl.forEach((item) => {\n                    item.exeRotate({ delta: delta * (revert ? -1 : 1) });\n                    item.disable();\n                });\n\n                break;\n            }\n            case 'move': {\n                const [dx, dy] = action.data;\n                const sjxEl = this.setDraggable(action.el);\n\n                sjxEl.forEach((item) => {\n                    item.exeDrag({\n                        dx: dx * (revert ? -1 : 1),\n                        dy: dy * (revert ? -1 : 1)\n                    });\n                    item.disable();\n                });\n                break;\n            }\n            case 'resize': {\n                const { dx, dy, ...rest } = action.data;\n                const sjxEl = this.setDraggable(action.el);\n\n                sjxEl.forEach((item) => {\n                    item.exeResize({\n                        dx: dx * (revert ? -1 : 1),\n                        dy: dy * (revert ? -1 : 1),\n                        ...rest\n                    });\n                    item.disable();\n                });\n            }\n            default:\n                break;\n\n        }\n    }\n\n    render() {\n        return (\n            <g id='editable-content' ref={el => this.el = el} />\n        );\n    }\n\n}\n\nexport default connect(mapStateToProps)(EditorContainer);","import React, { useState, useRef, useEffect } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { Button } from '@material-ui/core';\r\nimport ZoomableGroup from '../helpers/ZoomableGroup';\r\nimport EditorContent from './EditorContent';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    root: {\r\n        '-webkit-box-flex': 1,\r\n        '-ms-flex': 1,\r\n        flex: 1,\r\n        visibility: 'visible'\r\n    },\r\n    workArea: {\r\n        overflow: 'auto'\r\n    },\r\n    canvas: {\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0\r\n    },\r\n    canvasContent: {\r\n        backgroundColor: 'white'\r\n    },\r\n    page: {\r\n        boxShadow: '0px 0px 2px 1px #d1d1d1'\r\n    },\r\n    layerBar: {\r\n        position: 'absolute',\r\n        zIndex: 99999,\r\n        margin: 4\r\n    }\r\n}));\r\n\r\nconst canvasGrid = (paperSize, gridSize) => {\r\n    const grid = gridSize * 10;\r\n    return (\r\n        <g>\r\n            <defs>\r\n                <pattern\r\n                    id='smallGrid'\r\n                    width={gridSize}\r\n                    height={gridSize}\r\n                    fill='white'\r\n                    patternUnits='userSpaceOnUse'\r\n                >\r\n                    <path\r\n                        d={`M ${gridSize} 0 L 0 0 0 ${gridSize}`}\r\n                        fill='none'\r\n                        stroke='gray'\r\n                        strokeWidth='0.5'\r\n                        vectorEffect='non-scaling-stroke'\r\n                    />\r\n                </pattern>\r\n                <pattern id='grid' width={grid} height={grid} patternUnits='userSpaceOnUse'>\r\n                    <rect width={grid} height={grid} fill='url(#smallGrid)' />\r\n                    <path\r\n                        d={`M ${grid} 0 L 0 0 0 ${grid}`}\r\n                        fill='none'\r\n                        stroke='gray'\r\n                        strokeWidth='1'\r\n                        vectorEffect='non-scaling-stroke'\r\n                    />\r\n                </pattern>\r\n            </defs>\r\n            <rect x='0' y='0' width={paperSize.w} height={paperSize.h} fill='url(#grid)' />\r\n        </g>\r\n    );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        editorAction: state.editorAction,\r\n        editorGrid: state.editorGrid,\r\n        editorGridSize: state.editorGridSize,\r\n        editorPaperSize: state.editorPaperSize\r\n    };\r\n};\r\n\r\nconst EditorCanvas = (props) => {\r\n    const classes = useStyles();\r\n    const {\r\n        editorAction,\r\n        editorGrid,\r\n        editorGridSize,\r\n        editorPaperSize,\r\n        // leftOffset,\r\n        // topOffset,\r\n        rightOffset,\r\n        children: content\r\n    } = props;\r\n\r\n    const {\r\n        width: initialW,\r\n        height: initialH\r\n    } = editorPaperSize;\r\n\r\n    const [paperWidth, paperHeight] = [window.outerWidth, window.outerHeight];\r\n\r\n    const [paperSize, setPaperSize] = useState({\r\n        w: initialW,\r\n        h: initialH,\r\n        x: (paperWidth - initialW) / 2,\r\n        y: (paperHeight - initialH) / 2\r\n    });\r\n\r\n    let canvasEl = null;\r\n    let controlsRef = null;\r\n    const workAreaRef = useRef(null);\r\n    const containerAreaRef = useRef(null);\r\n    const rootSVG = useRef(null);\r\n\r\n    const [localAction, setLocalAction] = useState(null);\r\n    const [layersBar, setLayersBar] = useState(null);\r\n    const [dropLayer, setParentLayer] = useState(false);\r\n    const [startPoint, setStartPoint] = useState({ x: 0, y: 0 });\r\n\r\n    const [dropItems, setDropItems] = useState(false);\r\n\r\n    const scrollToRef = (ref) => {\r\n        const container = containerAreaRef.current;\r\n        container.scrollTop = (ref.current.clientHeight - container.clientHeight) / 2;\r\n        container.scrollLeft = (ref.current.clientWidth - container.clientWidth) / 2;\r\n    };\r\n\r\n    useEffect(() => {\r\n        scrollToRef(workAreaRef);\r\n    }, [paperSize]);\r\n\r\n    // TODO: adopt to size of imported SVG\r\n    // useEffect(() => {\r\n    //     setPaperSize({\r\n    //         w: contentWidth > initialW ? contentWidth : initialW,\r\n    //         h: contentHeight > initialH ? contentHeight : initialH,\r\n    //         x: contentWidth > initialW ?  (paperWidth - contentWidth) / 2 : (paperWidth - initialW) / 2,\r\n    //         y: contentHeight > initialH ? (paperHeight - contentHeight) / 2 : (paperHeight - initialH) / 2\r\n    //     });\r\n    // }, [props.children]);\r\n\r\n    useEffect(() => {\r\n        setPaperSize({\r\n            w: initialW,\r\n            h: initialH,\r\n            x: (paperWidth - initialW) / 2,\r\n            y: (paperHeight - initialH) / 2\r\n        });\r\n    }, [props.editorPaperSize]);\r\n\r\n    const handleMouseDown = (e) => {\r\n        e.preventDefault();\r\n        switch (editorAction) {\r\n\r\n            case 'edit':\r\n                if (controlsRef.contains(e.target)) return;\r\n\r\n                if (!canvasEl.children[0].contains(e.target)) {\r\n                    setDropItems(true);\r\n                    return setTimeout(() => setDropItems(false), 100);\r\n                }\r\n                break;\r\n            case 'grab':\r\n                const container = containerAreaRef.current;\r\n\r\n                setStartPoint({\r\n                    x: e.clientX,\r\n                    y: e.clientY,\r\n                    scrollTop: container.scrollTop,\r\n                    scrollLeft: container.scrollLeft\r\n                });\r\n                break;\r\n            case 'select':\r\n                //onCanvasDown(e);\r\n                break;\r\n            case 'zoom':\r\n                break;\r\n            case 'drawRect':\r\n                drawElement(e);\r\n                break;\r\n            default:\r\n                break;\r\n\r\n        }\r\n\r\n        setLocalAction(editorAction);\r\n    };\r\n\r\n    const handleMouseMove = (e) => {\r\n        e.preventDefault();\r\n\r\n        switch (localAction) {\r\n\r\n            case 'grab': {\r\n                const dx = (startPoint.x - e.clientX) * 1; // scale\r\n                const dy = (startPoint.y - e.clientY) * 1; // scale\r\n\r\n                const container = containerAreaRef.current;\r\n                container.scrollTop = startPoint.scrollTop + dy;\r\n                container.scrollLeft = startPoint.scrollLeft + dx;\r\n                break;\r\n            }\r\n            case 'zoom': {\r\n                break;\r\n            }\r\n            case 'draw':\r\n                //drawSvgElement(e);\r\n                break;\r\n            default:\r\n                break;\r\n\r\n        }\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n        setLocalAction(null);\r\n    };\r\n\r\n    const dropLayers = (e) => {\r\n        e.stopPropagation();\r\n        setParentLayer(true);\r\n    };\r\n\r\n    const svgPoint = (elem, x, y) => {\r\n        let p = elem.createSVGPoint();\r\n        p.x = x;\r\n        p.y = y;\r\n        return p.matrixTransform(elem.getScreenCTM().inverse());\r\n    };\r\n\r\n    const drawElement = (event) => {\r\n        const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\r\n        rect.setAttributeNS(null, 'stroke-width', 2);\r\n        rect.setAttributeNS(null, 'fill', 'none');\r\n        rect.setAttributeNS(null, 'stroke', '#000');\r\n\r\n        const drawArea1 = document.getElementById('editor-background');\r\n\r\n        const start = svgPoint(drawArea1, event.clientX, event.clientY);\r\n        document.getElementById('editable-content').appendChild(rect);\r\n\r\n        const drawRect = (e) => {\r\n            let p = svgPoint(drawArea1, e.clientX, e.clientY);\r\n            let w = Math.abs(p.x - start.x);\r\n            let h = Math.abs(p.y - start.y);\r\n            if (p.x > start.x) {\r\n                p.x = start.x;\r\n            }\r\n\r\n            if (p.y > start.y) {\r\n                p.y = start.y;\r\n            }\r\n\r\n            rect.setAttributeNS(null, 'x', p.x);\r\n            rect.setAttributeNS(null, 'y', p.y);\r\n            rect.setAttributeNS(null, 'width', w);\r\n            rect.setAttributeNS(null, 'height', h);\r\n        };\r\n\r\n        const endDraw = () => {\r\n            drawArea1.removeEventListener('mousemove', drawRect);\r\n            drawArea1.removeEventListener('mouseup', endDraw);\r\n        };\r\n\r\n        drawArea1.addEventListener('mousemove', drawRect);\r\n        drawArea1.addEventListener('mouseup', endDraw);\r\n    };\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            {\r\n                layersBar && (\r\n                    <p className={classes.layerBar}>\r\n                        {layersBar}\r\n                        <Button\r\n                            style={{ marginLeft: 2 }}\r\n                            variant='contained'\r\n                            color='primary'\r\n                            size='small'\r\n                            onMouseUp={dropLayers}>\r\n                            Exit\r\n                        </Button>\r\n                    </p>\r\n                )\r\n            }\r\n            <div\r\n                id='work-area'\r\n                ref={containerAreaRef}\r\n                className={classes.workArea}\r\n                style={{\r\n                    top: 0, // topOffset,\r\n                    left: 0, // leftOffset,\r\n                    right: rightOffset,\r\n                    bottom: 0,\r\n                    position: 'absolute',\r\n                    cursor: 'auto',\r\n                    overflow: 'scroll'\r\n                }}\r\n                onMouseMove={handleMouseMove}\r\n                onMouseDown={handleMouseDown}\r\n                onMouseUp={handleMouseUp}\r\n            >\r\n                <div\r\n                    ref={workAreaRef}\r\n                    style={{\r\n                        display: 'inline-block',\r\n                        position: 'relative',\r\n                        width: paperWidth,\r\n                        height: paperHeight\r\n                    }}\r\n                >\r\n                    <svg\r\n                        id='editor-container'\r\n                        xmlns='http://www.w3.org/2000/svg'\r\n                        className={classes.canvas}\r\n                        width='100%'\r\n                        height='100%'\r\n                        overflow='visible'\r\n                        ref={rootSVG}\r\n                    >\r\n                        <ZoomableGroup enable={editorAction === 'zoom'}>\r\n                            <g id='content' transform={`translate(${paperSize.x}, ${paperSize.y})`}>\r\n                                <g id='editor-background'>\r\n                                    <rect id='editor-grid' x='0' y='0' width={paperSize.w} height={paperSize.h} fill='white' stroke='grey' />\r\n                                    {\r\n                                        editorGrid\r\n                                            ? canvasGrid(paperSize, editorGridSize)\r\n                                            : null\r\n                                    }\r\n                                </g>\r\n                                <g\r\n                                    id='editor-canvas'\r\n                                    ref={el => canvasEl = el}\r\n                                    className={classes.page}\r\n                                >\r\n                                    <EditorContent\r\n                                        root={rootSVG}\r\n                                        editable={editorAction === 'edit'}\r\n                                        selectable={editorAction === 'select'}\r\n                                        content={content}\r\n                                        onLayerChange={(value) => {\r\n                                            setLayersBar(value);\r\n                                            setParentLayer(false);\r\n                                        }}\r\n                                        dropLayer={dropLayer}\r\n                                        dropItems={dropItems}\r\n                                    />\r\n                                </g>\r\n                            </g>\r\n                        </ZoomableGroup>\r\n                        <g id='controls-container' ref={div => controlsRef = div} />\r\n                    </svg>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nEditorCanvas.defaultProps = {\r\n    grid: true,\r\n    mouseAction: 'edit',\r\n    initialW: 800,\r\n    initialH: 600\r\n};\r\n\r\nexport default connect(mapStateToProps)(EditorCanvas);","import React from 'react';\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\r\nimport { connect } from 'react-redux';\r\nimport { IconButton } from '@material-ui/core';\r\n\r\nimport {\r\n    Layers as LayersIcon,\r\n    VerticalAlignCenter as AlignCenter,\r\n    VerticalAlignBottom as AlignIcon,\r\n    GridOn as GridOnIcon,\r\n    GridOff as GridOffIcon,\r\n    Undo as UndoIcon,\r\n    Redo as RedoIcon,\r\n    Navigation as NavigationIcon,\r\n    PanTool as PanToolIcon,\r\n    PhotoSizeSelectSmall as PhotoSizeSelectSmallIcon,\r\n    Search as SearchIcon,\r\n    Crop32Outlined as Rectangle,\r\n    FormatShapes as ShapeSettingsIcon,\r\n    Tune as CanvasSettingsIcon\r\n} from '@material-ui/icons';\r\n\r\nimport { setEditorAction, activateEditorGrid } from '../../actions';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    root: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        height: '100%'\r\n    },\r\n    flex: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        height: '100%',\r\n        marginLeft: 10\r\n    },\r\n    verticalDivider: {\r\n        width: '1px',\r\n        backgroundColor: 'white',\r\n        height: '30px'\r\n    },\r\n    toolbar: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        padding: 2,\r\n        marginRight: 5\r\n    }\r\n}));\r\n\r\nconst ExtendedButton = withStyles({\r\n    root: {\r\n        color: 'rgba(0,0,0,0.65)',\r\n        padding: 6\r\n    }\r\n})(IconButton);\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        editorAction: state.editorAction,\r\n        editorGrid: state.editorGrid,\r\n        eventBus: state.eventBus\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => ({\r\n    $setEditorAction: (act) => dispatch(setEditorAction(act)),\r\n    $activateEditorGrid: (act) => dispatch(activateEditorGrid(act))\r\n});\r\n\r\nconst EditorToolbar = (props) => {\r\n    const classes = useStyles();\r\n\r\n    const {\r\n        editorAction,\r\n        editorGrid,\r\n        eventBus\r\n    } = props;\r\n\r\n    const setEditorAction = (editorAction) => () => {\r\n        props.$setEditorAction({ editorAction });\r\n    };\r\n\r\n    const activateEditorGrid = (editorGrid) => {\r\n        props.$activateEditorGrid({ editorGrid });\r\n    };\r\n\r\n    const buttons = [\r\n        { type: 'button', selected: editorAction === 'showLayers', component: <LayersIcon />, action: () => 'showLayers' },\r\n        { type: 'divider' },\r\n        { type: 'button', selected: editorAction === 'edit', component: <NavigationIcon />, action: setEditorAction('edit') },\r\n        { type: 'button', selected: editorAction === 'select', component: <PhotoSizeSelectSmallIcon />, action: setEditorAction('select') },\r\n        { type: 'button', selected: editorAction === 'grab', component: <PanToolIcon />, action: setEditorAction('grab') },\r\n        { type: 'button', selected: editorAction === 'zoom', component: <SearchIcon />, action: setEditorAction('zoom') },\r\n        { type: 'divider' },\r\n        // { type: 'button', selected: editorAction === 'zoom', component: <Rectangle />, action: setEditorAction('drawRect') },\r\n        // { type: 'divider' },\r\n        { type: 'button', selected: editorAction === 'alignLeft', component: <AlignIcon transform='rotate(90)' />, action: () => eventBus.emit('alignLeft') },\r\n        { type: 'button', selected: editorAction === 'alignHorizontal', component: <AlignCenter transform='rotate(90)' />, action: () => eventBus.emit('alignHorizontal') },\r\n        { type: 'button', selected: editorAction === 'alignRight', component: <AlignIcon transform='rotate(-90)' />, action: () => eventBus.emit('alignRight') },\r\n        { type: 'button', selected: editorAction === 'alignTop', component: <AlignIcon transform='rotate(180)' />, action: () => eventBus.emit('alignTop') },\r\n        { type: 'button', selected: editorAction === 'alignVertical', component: <AlignCenter transform='rotate(180)' />, action: () => eventBus.emit('alignVertical') },\r\n        { type: 'button', selected: editorAction === 'alignBottom', component: <AlignIcon />, action: () => eventBus.emit('alignBottom') },\r\n        { type: 'divider' },\r\n        { type: 'button', selected: editorGrid === true, component: <GridOnIcon />, action: () => activateEditorGrid(true) },\r\n        { type: 'button', selected: editorGrid === false, component: <GridOffIcon />, action: () => activateEditorGrid(false) },\r\n        { type: 'divider' },\r\n        { type: 'button', selected: false, component: <UndoIcon />, action: () => eventBus.emit('undo') },\r\n        { type: 'button', selected: false, component: <RedoIcon />, action: () => eventBus.emit('redo') }\r\n    ];\r\n\r\n    const options = [\r\n        { type: 'button', selected: false, component: <ShapeSettingsIcon />, action: () => eventBus.emit('settings', null, 'item') },\r\n        { type: 'button', selected: false, component: <CanvasSettingsIcon />, action: () => eventBus.emit('settings', null, 'canvas') }\r\n    ];\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <div className={classes.flex}>\r\n                {buttons.map(({ type, component, action, selected, value }, index) => (\r\n                    <div key={`${index}button`} className={classes.toolbar}>{\r\n                        type !== 'divider'\r\n                            ? <ExtendedButton disabled={selected} onClick={() => action()}>{component}</ExtendedButton>\r\n                            : <div className={classes.verticalDivider} />\r\n                    }</div>\r\n                ))}\r\n            </div>\r\n            <div className={classes.flex} style={{ width: '100%', justifyContent: 'flex-end' }}>\r\n                {options.map(({ type, component, action, selected, value }, index) => (\r\n                    <div key={`${index}button`} className={classes.toolbar}>{\r\n                        type !== 'divider'\r\n                            ? <ExtendedButton disabled={selected} onClick={() => action()}>{component}</ExtendedButton>\r\n                            : <div className={classes.verticalDivider} />\r\n                    }</div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditorToolbar);","export function setEditorAction({ editorAction }) {\r\n    return { type: 'SET_EDITOR_ACTION', editorAction };\r\n}\r\n\r\nexport function activateEditorGrid({ editorGrid }) {\r\n    return { type: 'ACTIVATE_EDITOR_GRID', editorGrid };\r\n}\r\n\r\nexport function setEditorGridSize({ editorGridSize }) {\r\n    return { type: 'SET_EDITOR_GRID_SIZE', editorGridSize };\r\n}\r\n\r\nexport function setEditorPaperSize({ editorPaperSize }) {\r\n    return { type: 'SET_EDITOR_PAPER_SIZE', editorPaperSize };\r\n}\r\n\r\nexport function setAllowDragging({ allowDragging }) {\r\n    return { type: 'SET_ALLOW_DRAGGING', allowDragging };\r\n}\r\n\r\nexport function setAllowResizing({ allowResizing }) {\r\n    return { type: 'SET_ALLOW_RESIZING', allowResizing };\r\n}\r\n\r\nexport function setAllowRotating({ allowRotating }) {\r\n    return { type: 'SET_ALLOW_ROTATING', allowRotating };\r\n}\r\n\r\nexport function setAllowProportions({ allowProportions }) {\r\n    return { type: 'SET_ALLOW_PROPORTIONS', allowProportions };\r\n}\r\n\r\nexport function setAllowRestrictions({ allowRestrictions }) {\r\n    return { type: 'SET_ALLOW_RESTRICTIONS', allowRestrictions };\r\n}\r\n\r\nexport function setSnapSteps({ snapSteps }) {\r\n    return { type: 'SET_SNAP_STEPS', snapSteps };\r\n}","export function readText(filePath) {\r\n    return new Promise((resolve, reject) => {\r\n        if (window.File && window.FileReader && window.FileList && window.Blob) {\r\n            const reader = new FileReader();\r\n            let output = '';\r\n            if (filePath.files && filePath.files[0]) {\r\n                reader.onload = (e) => {\r\n                    output = e.target.result;\r\n                    resolve(output);\r\n                };\r\n                reader.readAsText(filePath.files[0]);\r\n            }\r\n        } else {\r\n            reject();\r\n        }\r\n    });\r\n}","import React, { useState, useEffect } from 'react';\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ImportIcon from '@material-ui/icons/GetApp';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport Delete from '@material-ui/icons/Delete';\r\nimport { readText } from '../../util/fileReader';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        padding: '0 8px'\r\n    },\r\n    extendedIcon: {\r\n        marginRight: theme.spacing(1)\r\n    }\r\n}));\r\n\r\nconst ExtendedButton = withStyles({\r\n    root: {\r\n        color: '#fff',\r\n        marginRight: '10px'\r\n    }\r\n})(IconButton);\r\n\r\nconst EditorMenu = (props) => {\r\n    const classes = useStyles();\r\n\r\n    const [fileSelector, setFileSelector] = useState(\r\n        document.createElement('input')\r\n    );\r\n\r\n    useEffect(() => {\r\n        const fileSelector = document.createElement('input');\r\n        fileSelector.setAttribute('type', 'file');\r\n        fileSelector.setAttribute('accept', 'image/*');\r\n        fileSelector.setAttribute('id', 'file-upload');\r\n        fileSelector.style.display = 'none';\r\n\r\n        setFileSelector(fileSelector);\r\n\r\n        const loadFiles = async (e) => {\r\n            try {\r\n                const res = await readText(e.target);\r\n                props.onImport(res);\r\n            } catch (err) {\r\n                console.log(err);\r\n            }\r\n        };\r\n\r\n        fileSelector.addEventListener('change', loadFiles, false);\r\n    }, [props]);\r\n\r\n    const handleFileSelect = (e) => {\r\n        fileSelector.click();\r\n        e.preventDefault();\r\n        e.target.value = '';\r\n    };\r\n\r\n    const handleExportFile = () => {\r\n        props.onExport();\r\n    };\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <ExtendedButton onClick={handleFileSelect}>\r\n                <ImportIcon />\r\n            </ExtendedButton>\r\n            <ExtendedButton onClick={handleExportFile}>\r\n                <SaveIcon />\r\n            </ExtendedButton>\r\n            <ExtendedButton onClick={() => props.onClearArea()}>\r\n                <Delete />\r\n            </ExtendedButton>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default EditorMenu;","import React, { useState, useEffect } from 'react';\r\nimport subjx from 'subjx';\r\nimport {\r\n    List,\r\n    ListItem,\r\n    ListItemIcon,\r\n    ListItemText\r\n} from '@material-ui/core';\r\nimport {\r\n    Crop32Outlined as Rectangle,\r\n    RadioButtonUnchecked as Circle,\r\n    GradeOutlined as Shape,\r\n    CropOriginalOutlined as Image,\r\n    FormatShapes as Text\r\n} from '@material-ui/icons';\r\n\r\nconst items = [\r\n    ['rectangle', Rectangle],\r\n    ['circle', Circle],\r\n    ['shape', Shape],\r\n    ['text', Text],\r\n    // ['image', Image]\r\n];\r\n\r\nconst EditorItems = (props) => {\r\n    const droppables = [];\r\n    const [isCloneable, setAsCloneable] = useState(false);\r\n\r\n    const cloneConfig = {\r\n        appendTo: 'body',\r\n        stack: '#editor-background',\r\n        style: {\r\n            border: 'none',\r\n            background: 'transparent',\r\n            maxWidth: '150px',\r\n            textColor: 'transparent'\r\n        },\r\n        onInit() {},\r\n        onDrop(e) {\r\n            const itemType = this.el.getAttribute('data-type');\r\n            let newItem = null;\r\n\r\n            const editorRef = document.querySelector('#editor-background');\r\n\r\n            const offset = editorRef.getBoundingClientRect(),\r\n                x = e.clientX - offset.left + editorRef.scrollLeft,\r\n                y = e.clientY - offset.top + editorRef.scrollTop;\r\n\r\n            switch (itemType) {\r\n\r\n                case 'rectangle':\r\n                    newItem = [\r\n                        'rect',\r\n                        {\r\n                            x,\r\n                            y,\r\n                            width: 150,\r\n                            height: 100,\r\n                            stroke: 'black',\r\n                            fill: 'transparent'\r\n                        }\r\n                    ];\r\n                    break;\r\n                case 'circle':\r\n                    newItem = [\r\n                        'ellipse',\r\n                        {\r\n                            cx: x,\r\n                            cy: y,\r\n                            rx: 45,\r\n                            ry: 45,       \r\n                            stroke: 'black',\r\n                            fill: 'transparent'\r\n                        }\r\n                    ];\r\n                    break;\r\n                case 'shape':\r\n                    newItem = [\r\n                        'polygon',\r\n                        {\r\n                            strokeWidth: '1',\r\n                            stroke: 'black',\r\n                            fill: \"transparent\",\r\n                            strokeDasharray: \"0\",\r\n                            points: `${x + 80},${y} ${x + 160},${y + 50} ${x + 80},${y + 100} ${x},${y + 50}`\r\n                        },\r\n                        []\r\n                    ];\r\n                    break;\r\n                case 'image':\r\n                    newItem = [\r\n                        'foreignObject',\r\n                        {\r\n                            x,\r\n                            y,\r\n                            width: 150,\r\n                            height: 100,\r\n                            stroke: 'black',\r\n                            fill: 'transparent'\r\n                        },\r\n                        [\r\n                            [\r\n                                'div',\r\n                                {\r\n                                    display: 'block'\r\n                                },\r\n                                ['text']\r\n                            ]\r\n                        ]\r\n                    ];\r\n                    break;\r\n                case 'text':\r\n                    newItem = [\r\n                        'text',\r\n                        {\r\n                            x,\r\n                            y,\r\n                            textLength: 150\r\n                        },\r\n                        React.createElement(\r\n                            'tspan',\r\n                            {},\r\n                            'text'\r\n                        )\r\n                    ];\r\n                    break;\r\n                // case 'text':\r\n                //     newItem = [\r\n                //         'foreignObject',\r\n                //         {\r\n                //             x,\r\n                //             y,\r\n                //             width: 150,\r\n                //             height: 100,\r\n                //             stroke: 'black',\r\n                //             fill: 'transparent'\r\n                //         },\r\n                //         React.createElement(\r\n                //             'div',\r\n                //             {\r\n                //                 display: 'block'\r\n                //             },\r\n                //             'text'\r\n                //         )\r\n                //     ];\r\n                //     break;\r\n                default:\r\n                    break;\r\n\r\n            }\r\n\r\n            props.onDrop(\r\n                e,\r\n                newItem\r\n            );\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (isCloneable) return;\r\n        droppables.forEach(el => subjx(el).clone(cloneConfig));\r\n        setAsCloneable(true);\r\n    }, [droppables, isCloneable, cloneConfig]);\r\n\r\n    return (\r\n        <List>\r\n            {items.map(([text, Icon]) => (\r\n                <ListItem\r\n                    data-type={text}\r\n                    ref={(el) => droppables.push(el)}\r\n                    button\r\n                    key={text}\r\n                >\r\n                    <ListItemIcon>\r\n                        <Icon />\r\n                    </ListItemIcon>\r\n                    <ListItemText primary={text} />\r\n                </ListItem>\r\n            ))}\r\n        </List>\r\n    );\r\n};\r\n\r\nexport default EditorItems;","import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\n\nimport {\n    TextField,\n    Checkbox,\n    FormGroup,\n    FormControlLabel,\n    FormControl,\n    Divider,\n    Typography,\n    Grid,\n    Slider\n} from '@material-ui/core';\n\nimport {\n    setEditorPaperSize,\n    setAllowDragging,\n    setAllowResizing,\n    setAllowRotating,\n    setAllowProportions,\n    setAllowRestrictions,\n    setSnapSteps,\n    setEditorGridSize\n} from '../../../actions';\n\nconst useStyles = makeStyles(() => ({\n    root: {\n        position: 'absolute',\n        right: 0,\n        top: 0,\n        bottom: 0,\n        backgroundColor: '#fdfdfd',\n        zIndex: 999\n    },\n    container: {\n        display: 'flex',\n        flex: 1\n    },\n    containerColumn: {\n        display: 'flex',\n        flexDirection: 'column'\n    },\n    padding: {\n        padding: 10\n    },\n    label: {\n        paddingLeft: 10\n    }\n}));\n\nconst TextInput = withStyles({\n    root: {\n        margin: 10,\n        '& .MuiOutlinedInput-input': {\n            padding: '10px 10px'\n        }\n    }\n})(TextField);\n\nconst CheckboxLabel = withStyles({\n    root: {\n        margin: '0'\n    }\n})(FormControlLabel);\n\nconst mapStateToProps = (state) => ({\n    editorPaperSize: state.editorPaperSize,\n    allowDragging: state.allowDragging,\n    allowResizing: state.allowResizing,\n    allowRotating: state.allowRotating,\n    allowProportions: state.allowProportions,\n    allowRestrictions: state.allowRestrictions,\n    snapSteps: state.snapSteps,\n    editorGridSize: state.editorGridSize,\n    eventBus: state.eventBus\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n    $setEditorPaperSize: (act) => dispatch(setEditorPaperSize(act)),\n    $setAllowDragging: (act) => dispatch(setAllowDragging(act)),\n    $setAllowResizing: (act) => dispatch(setAllowResizing(act)),\n    $setAllowRotating: (act) => dispatch(setAllowRotating(act)),\n    $setAllowProportions: (act) => dispatch(setAllowProportions(act)),\n    $setAllowRestrictions: (act) => dispatch(setAllowRestrictions(act)),\n    $setSnapSteps: (act) => dispatch(setSnapSteps(act)),\n    $setEditorGridSize: (act) => dispatch(setEditorGridSize(act))\n});\n\nconst CanvasSettings = (props) => {\n    const classes = useStyles();\n\n    const {\n        editorPaperSize: { width, height },\n        allowDragging,\n        allowResizing,\n        allowRotating,\n        allowProportions,\n        allowRestrictions,\n        editorGridSize,\n        snapSteps\n    } = props;\n\n    const [paperSize, setPaperSize] = useState({ width, height });\n    const [dragging, setDragging] = useState(allowDragging);\n    const [resizing, setResizing] = useState(allowResizing);\n    const [rotating, setRotating] = useState(allowRotating);\n    const [proportions, setProportions] = useState(allowProportions);\n    const [restrictions, setRestrictions] = useState(allowRestrictions);\n    const [snap, setSnap] = useState(snapSteps);\n\n\n    const handleChange = ([w, h]) => {\n        if (Number(w) < 1 || Number(h) < 1) return;\n\n        const editorPaperSize = { width: w, height: h };\n        setPaperSize(editorPaperSize);\n        props.$setEditorPaperSize({ editorPaperSize });\n    };\n\n    const handleSettings = (name) => (e) => {\n        const value = e.target.checked;\n\n        switch (name) {\n\n            case 'drag': {\n                setDragging(value);\n                props.$setAllowDragging({ allowDragging: value });\n                break;\n            }\n\n            case 'resize': {\n                setResizing(value);\n                props.$setAllowResizing({ allowResizing: value });\n                break;\n            }\n\n            case 'rotate': {\n                setRotating(value);\n                props.$setAllowRotating({ allowRotating: value });\n                break;\n            }\n\n            case 'proportions': {\n                setProportions(value);\n                props.$setAllowProportions({ allowProportions: value });\n                break;\n            }\n\n            case 'restrictions': {\n                setRestrictions(value);\n                props.$setAllowRestrictions({ allowRestrictions: value });\n                break;\n            }\n\n        }\n    };\n\n    const handleSnapChange = (value) => {\n        const snapValues = { ...snap, ...value };\n        setSnap(snapValues);\n        props.$setSnapSteps({ snapSteps: snapValues });\n    };\n\n    return (\n        <div\n            className={classes.root}\n            style={{ width: props.width }}\n        >\n            <FormControl component='fieldset'>\n                <FormGroup aria-label='position'>\n                    <div className={classes.padding}>\n                        <Typography className={classes.label} variant='subtitle1' align='left'>Canvas</Typography>\n                        <div className={classes.container}>\n                            <TextInput label='width' value={paperSize.width} variant='outlined' size='small' onChange={(e) => handleChange([e.target.value, paperSize.height])} />\n                            <TextInput label='height' value={paperSize.height} variant='outlined' size='small' onChange={(e) => handleChange([paperSize.width, e.target.value])} />\n                        </div>\n                        <Grid container>\n                            <Grid item xs={12}>\n                                <Typography className={classes.label} variant='subtitle1' align='left'>Grid size</Typography>\n                                <div style={{ display: 'flex', alignItems: 'center', padding: '0 10px' }}>\n                                    <Slider valueLabelDisplay='auto' value={editorGridSize} onChange={(e, val) => props.$setEditorGridSize({ editorGridSize: val })} step={10} />\n                                </div>\n                            </Grid>\n                        </Grid>\n                    </div>\n                    <Divider />\n                    <div className={classes.padding}>\n                        <Typography className={classes.label} variant='subtitle1' align='left'>Effects</Typography>\n                        <div className={classes.containerColumn}>\n                            <CheckboxLabel\n                                value={dragging}\n                                control={<Checkbox checked={dragging} color='primary' onChange={handleSettings('drag')} />}\n                                label='Allow dragging'\n                                labelPlacement='end'\n                            />\n                            <CheckboxLabel\n                                value={resizing}\n                                control={<Checkbox checked={resizing} color='primary' onChange={handleSettings('resize')} />}\n                                label='Allow resizing'\n                                labelPlacement='end'\n                            />\n                            <CheckboxLabel\n                                value={rotating}\n                                control={<Checkbox checked={rotating} color='primary' onChange={handleSettings('rotate')} />}\n                                label='Allow rotating'\n                                labelPlacement='end'\n                            />\n                            <CheckboxLabel\n                                value={proportions}\n                                control={<Checkbox checked={proportions} color='primary' onChange={handleSettings('proportions')} />}\n                                label='Keep aspect ratio'\n                                labelPlacement='end'\n                            />\n                            <CheckboxLabel\n                                value={restrictions}\n                                control={<Checkbox checked={restrictions} color='primary' onChange={handleSettings('restrictions')} />}\n                                label='Activate bounding area'\n                                labelPlacement='end'\n                            />\n                        </div>\n                    </div>\n                    <Divider />\n                    <div className={classes.padding}>\n                        <Typography className={classes.label} variant='subtitle1' align='left'>Snap</Typography>\n                        <Grid container>\n                            <Grid item xs={6}>\n                                <TextInput label='grid step x' value={snap.x} variant='outlined' size='small' onChange={(e) => handleSnapChange({ x: Number(e.target.value) })} />\n                            </Grid>\n                            <Grid item xs={6}>\n                                <TextInput label='grid step y' value={snap.y} variant='outlined' size='small' onChange={(e) => handleSnapChange({ y: Number(e.target.value) })} />\n                            </Grid>\n                        </Grid>\n                        <Grid container>\n                            <Grid item xs={6}>\n                                <TextInput label='snap angle' value={snap.angle} variant='outlined' size='small' onChange={(e) => handleSnapChange({ angle: Number(e.target.value) })} />\n                            </Grid>\n                        </Grid>\n                    </div>\n                </FormGroup>\n            </FormControl>\n        </div>\n    );\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CanvasSettings);","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ChromePicker } from 'react-color';\nimport { withStyles } from '@material-ui/core/styles';\n\nconst styles = () => ({\n    root: {\n        width: '50%',\n        padding: 0,\n        border: 0,\n        margin: 0,\n        display: 'inline-flex',\n        padding: 0,\n        position: 'relative',\n        flexDirection: 'column',\n        verticalAlign: 'top'\n    },\n    wrapper: {\n        padding: 10,\n        color: 'rgba(0, 0, 0, 0.87)',\n        cursor: 'text',\n        display: 'inline-flex',\n        position: 'relative',\n        fontSize: '1rem',\n        boxSizing: 'border-box',\n        alignItems: 'center',\n        lineHeight: '1.0876em'\n    },\n    colorPicker: {\n        flex: '0 1 100%',\n        border: 0,\n        height: '1.0876em',\n        margin: 0,\n        display: 'block',\n        padding: '6px 0 7px',\n        minWidth: 0,\n        background: 'none',\n        boxSizing: 'content-box',\n        border: '2px solid #c7c7c7',\n        borderRadius: 4\n    }\n});\n\n\nclass ColorPicker extends React.Component {\n\n    state = {\n\n        displayColorPicker: false,\n        currentColor: {\n            hex: this.props.initValue || 'transparent'\n        },\n        popover: {\n            position: 'absolute',\n            zIndex: '9999',\n            top: 0,\n            left: 0\n        }\n    };\n\n    handleClick = (e) => {\n        const { clientX, clientY } = e;\n        const { clientWidth, clientHeight } = e.target;\n        this.setState({ \n            displayColorPicker: !this.state.displayColorPicker,\n            popover: {\n                ...this.state.popover,\n                left: clientX - clientWidth,\n                top: clientY\n            }\n        });\n    };\n\n    handleClose = () => {\n        this.setState({ displayColorPicker: false });\n    };\n\n    handleChange = (color) => {\n        this.setState({ currentColor: color });\n        this.props.onChange(color);\n    };\n\n    render() {\n        const cover = {\n            position: 'fixed',\n            top: '0px',\n            right: '0px',\n            bottom: '0px',\n            left: '0px'\n        };\n\n        return (\n            <div className={this.props.classes.root}>\n                <div className={this.props.classes.wrapper}>\n                    <div className={this.props.classes.colorPicker} onClick={this.handleClick} style={{ backgroundColor: this.state.currentColor.hex }} />\n                </div>\n                {this.state.displayColorPicker ?\n                    ReactDOM.createPortal(\n                        <div style={this.state.popover}>\n                            <div style={cover} onClick={this.handleClose} />\n                            <ChromePicker color={this.state.currentColor} onChange={this.handleChange} />\n                        </div>,\n                        document.body\n                    ) : null}\n            </div>\n        );\n    }\n\n};\n\nexport default withStyles(styles)(ColorPicker);","import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\nimport ColorPicker from '../../helpers/ColorPicker';\n\nimport {\n    FormGroup,\n    FormControl,\n    Divider,\n    Typography,\n    Grid,\n    Slider,\n    Select,\n    InputBase\n} from '@material-ui/core';\n\nconst BootstrapInput = withStyles((theme) => ({\n    root: {\n        'label + &': {\n            marginTop: theme.spacing(3)\n        }\n    },\n    input: {\n        borderRadius: 4,\n        position: 'relative',\n        backgroundColor: theme.palette.background.paper,\n        border: '1px solid #ced4da',\n        fontSize: 16,\n        paddingLeft: 10,\n        transition: theme.transitions.create(['border-color', 'box-shadow']),\n        '&:focus': {\n            borderRadius: 4,\n            borderColor: '#80bdff',\n            boxShadow: '0 0 0 0.2rem rgba(0,123,255,.25)'\n        }\n    }\n}))(InputBase);\n\nconst useStyles = makeStyles(() => ({\n    root: {\n        position: 'absolute',\n        right: 0,\n        top: 0,\n        bottom: 0,\n        backgroundColor: '#fdfdfd',\n        zIndex: 999\n    },\n    container: {\n        display: 'flex',\n        flex: 1\n    },\n    containerColumn: {\n        display: 'flex',\n        flexDirection: 'column'\n    },\n    padding: {\n        padding: 10\n    },\n    label: {\n        paddingLeft: 10,\n        width: '50%'\n    }\n}));\n\nconst mapStateToProps = (state) => ({\n    eventBus: state.eventBus\n});\n\n\nconst ItemSettings = (props) => {\n    const classes = useStyles();\n\n    const { eventBus } = props;\n\n    const [fill, setFill] = useState('none');\n    const [fillOptions, setFillOptions] = useState('none');\n    const [stroke, setStroke] = useState('none');\n    const [strokeOptions, setStrokeOptions] = useState('none');\n    const [thickness, setThickness] = useState(2);\n    const [opacity, setOpacity] = useState(100);\n\n    const setValue = (name, value) => {\n        switch (name) {\n\n            case 'fill':\n                setFill(value);\n                eventBus.emit(name, null, value);\n                break;\n            case 'stroke':\n                setStroke(value);\n                eventBus.emit(name, null, value.hex);\n                break;\n            case 'thickness':\n                setThickness(value);\n                eventBus.emit(name, null, value);\n                break;\n            case 'opacity':\n                setOpacity(value);\n                eventBus.emit(name, null, value / 100);\n            default:\n                break;\n\n        }\n    };\n\n    useEffect(() => {\n        setValue('fill', fillOptions === 'color' ? fill : 'none');\n    }, [fillOptions]);\n\n    return (\n        <div\n            className={classes.root}\n            style={{ width: props.width }}\n        >\n            <FormControl component='fieldset' style={{ width: '100%' }}>\n                <FormGroup aria-label='position'>\n                    <div className={classes.padding}>\n                        <div className={classes.container}>\n                            <Typography className={classes.label} variant='subtitle1' align='left'>Fill</Typography>\n                        </div>\n                        <div className={classes.container}>\n                            <ColorPicker initValue={fill} onChange={(value) => setValue('fill', value.hex)} />\n                            <Select\n                                style={{ width: '50%', padding: 10 }}\n                                variant='outlined'\n                                native\n                                value={fillOptions}\n                                onChange={(e) => setFillOptions(e.target.value)}\n                                name='age'\n                                input={<BootstrapInput />}\n                            >\n                                <option value={'none'}>none</option>\n                                <option value={'color'}>color</option>\n                            </Select>\n                        </div>\n                        <div className={classes.container}>\n                            <Typography className={classes.label} variant='subtitle1' align='left'>Stroke</Typography>\n                        </div>\n                        <div className={classes.container}>\n                            <ColorPicker initValue={stroke} onChange={(value) => setValue('stroke', value)} />\n                            <Select\n                                style={{ width: '50%', padding: 10 }}\n                                variant='outlined'\n                                native\n                                value={strokeOptions}\n                                onChange={(e) => setStrokeOptions(e.target.value)}\n                                name='age'\n                                input={<BootstrapInput />}\n                            >\n                                <option value={'none'}>none</option>\n                                <option value={'color'}>color</option>\n                            </Select>\n                        </div>\n                        <div className={classes.container}>\n                            <Grid item xs={12}>\n                                <Typography className={classes.label} variant='subtitle1' align='left'>Thickness</Typography>\n                                <div style={{ display: 'flex', alignItems: 'center', padding: '0 10px' }}>\n                                    <Slider valueLabelDisplay='auto' max={30} value={thickness} onChange={(e, val) => setValue('thickness', val)} step={1} />\n                                </div>\n                            </Grid>\n                        </div>\n                    </div>\n                    <Divider />\n                    <div className={classes.padding}>\n                        <div className={classes.container}>\n                            <Grid item xs={12}>\n                                <Typography className={classes.label} variant='subtitle1' align='left'>Opacity</Typography>\n                                <div style={{ display: 'flex', alignItems: 'center', padding: '0 10px' }}>\n                                    <Slider valueLabelDisplay='auto' max={100} value={opacity} onChange={(e, val) => setValue('opacity', val)} step={1} />\n                                </div>\n                            </Grid>\n                        </div>\n                    </div>\n                    <Divider />\n                </FormGroup>\n            </FormControl>\n        </div>\n    );\n};\n\nexport default connect(mapStateToProps)(ItemSettings);","import React, { useState, useEffect } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { connect } from 'react-redux';\r\nimport clsx from 'clsx';\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\r\nimport parse from 'html-react-parser';\r\nimport { saveAs } from 'file-saver';\r\nimport 'construct-style-sheets-polyfill';\r\n\r\nimport {\r\n    Drawer,\r\n    AppBar,\r\n    CssBaseline,\r\n    Divider,\r\n    IconButton\r\n} from '@material-ui/core';\r\n\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\n\r\nimport EditorCanvas from './EditorCanvas';\r\nimport EditorToolbar from './EditorToolbar';\r\nimport EditorMenu from './EditorMenu';\r\nimport EditorItems from './EditorItems';\r\nimport { CanvasSettings, ItemSettings } from './settings';\r\n\r\nconst allowedSvgs = [\r\n    'g', 'rect', 'path', 'polygon', 'polyline',\r\n    'circle', 'ellipse', 'text', 'line', 'foreighobject'\r\n];\r\n\r\nconst drawerWidth = 240;\r\n\r\nconst mapStateToProps = (state) => ({\r\n    eventBus: state.eventBus\r\n});\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        display: 'flex',\r\n        marginTop: 46,\r\n        minHeight: 'calc(100vh - 46px)',\r\n        height: 'calc(100vh - 46px)',\r\n        justifyItems: 'center',\r\n        backgroundColor: '#e6e5e5'\r\n    },\r\n    menu: {\r\n        display: 'flex',\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        height: 46,\r\n        width: '100%',\r\n        zIndex: 999,\r\n        backgroundColor: theme.palette.primary.main\r\n    },\r\n    canvas: {\r\n        flexGrow: 1\r\n        // overflow: 'hidden auto'\r\n    },\r\n    canvasContainer: {\r\n        display: 'flex',\r\n        flex: 1,\r\n        flexDirection: 'column'\r\n    },\r\n    appBar: {\r\n        borderTop: '1px solid #fff',\r\n        color: 'rgba(0,0,0,0.65)',\r\n        backgroundColor: 'rgb(230 229 229)',\r\n        zIndex: theme.zIndex.drawer + 1,\r\n        transition: theme.transitions.create(['width', 'margin'], {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.leavingScreen\r\n        }),\r\n        position: 'relative',\r\n        height: 46\r\n    },\r\n    appBarShift: {\r\n        // marginLeft: drawerWidth,\r\n        // width: `calc(100% - ${drawerWidth}px)`,\r\n        transition: theme.transitions.create(['width', 'margin'], {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.enteringScreen\r\n        })\r\n    },\r\n    menuButton: {\r\n        marginRight: 36\r\n    },\r\n    hide: {\r\n        display: 'none'\r\n    },\r\n    drawer: {\r\n        width: drawerWidth,\r\n        flexShrink: 0,\r\n        whiteSpace: 'nowrap'\r\n    },\r\n    drawerPaper: {\r\n        position: 'relative',\r\n        backgroundColor: '#fdfdfd'\r\n    },\r\n    drawerOpen: {\r\n        width: drawerWidth,\r\n        transition: theme.transitions.create('width', {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.enteringScreen\r\n        })\r\n    },\r\n    drawerClose: {\r\n        transition: theme.transitions.create('width', {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.leavingScreen\r\n        }),\r\n        overflowX: 'hidden',\r\n        width: theme.spacing(7) + 1,\r\n        [theme.breakpoints.up('sm')]: {\r\n            width: theme.spacing(7) + 1\r\n        }\r\n    },\r\n    toolbar: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'flex-end',\r\n        padding: theme.spacing(0, 1)\r\n    },\r\n    content: {\r\n        flexGrow: 1,\r\n        padding: theme.spacing(2)\r\n    }\r\n}));\r\n\r\nconst Editor = (props) => {\r\n    const classes = useStyles();\r\n    const theme = useTheme();\r\n    const [open, setOpen] = useState(false);\r\n    const [leftOffset, setLeftOffset] = useState(57);\r\n    const [content, setContent] = useState(null);\r\n    const [showSettings, setSettingsTab] = useState('canvas');\r\n\r\n    const parsedStyleSheet = new CSSStyleSheet();\r\n\r\n    const handleDrawerOpen = () => {\r\n        setOpen(true);\r\n    };\r\n\r\n    const handleDrawerClose = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    const getStyleRule = (className) => {\r\n        let cssText = {};\r\n        const classes = parsedStyleSheet.rules || parsedStyleSheet.cssRules;\r\n        for (let x = 0; x < classes.length; x++) {\r\n            if (classes[x].selectorText === className) {\r\n                for (let index = 0; index < classes[x].style.length; index++) {\r\n                    const propertyName = classes[x].style.item(index);\r\n                    cssText = {\r\n                        ...cssText,\r\n                        [propertyName]: classes[x].style[propertyName]\r\n                    };\r\n                }\r\n            }\r\n        }\r\n        return cssText;\r\n    };\r\n\r\n    const parserOptions = {\r\n        replace(domNode) {\r\n            if (domNode.name === 'style') {\r\n                const styleSheet = new CSSStyleSheet();\r\n                styleSheet.replace(domNode.children[0].data);\r\n\r\n                [...styleSheet.rules].map((rule) => (\r\n                    parsedStyleSheet.insertRule(rule.cssText, parsedStyleSheet.cssRules.length)\r\n                ));\r\n\r\n                return <></>;\r\n            }\r\n\r\n            if (domNode.name === 'use') {\r\n                const ref = domNode.attribs['xlink:href'] || domNode.attribs.href;\r\n\r\n                if (!ref) return domNode;\r\n                const source = domNode.parent.children.find((childNode) => {\r\n                    return childNode.attribs && ('#' + childNode.attribs.id === ref);\r\n                });\r\n            }\r\n\r\n            if (domNode.type === 'tag' && allowedSvgs.indexOf(domNode.name) !== -1) {\r\n                domNode.attribs = domNode.attribs || {};\r\n\r\n                const { class: className = '' } = domNode.attribs;\r\n\r\n                if (domNode.name === 'g') {\r\n                    domNode.attribs = {\r\n                        ...domNode.attribs,\r\n                        ...getStyleRule(`.${domNode.attribs.class}`),\r\n                        class: `layer ${className}`\r\n                    };\r\n                } else {\r\n                    domNode.attribs = {\r\n                        ...domNode.attribs,\r\n                        ...getStyleRule(`.${domNode.attribs.class}`),\r\n                        class: className\r\n                    };\r\n                }\r\n            }\r\n            return domNode;\r\n        }\r\n    };\r\n\r\n    const handleImport = (res) => {\r\n        let reactSVGEl = parse(res, parserOptions);\r\n\r\n        if (Array.isArray(reactSVGEl)) {\r\n            reactSVGEl = reactSVGEl.find(item => (\r\n                typeof item === 'object' && item.type === 'svg'\r\n            ));\r\n        }\r\n\r\n        const element = document.createElement('div');\r\n        // this is a temporary decision to convert html to dom\r\n        // maybe in the future it is need to use react way to import complex html tree\r\n        ReactDOM.render(reactSVGEl, element, () => {\r\n            ReactDOM.unmountComponentAtNode(element);\r\n            setContent(element.childNodes[0]);\r\n        });\r\n    };\r\n\r\n    const handleExport = () => {\r\n        const rootSVG = document.getElementById('editor-canvas');\r\n        const [width, height] = ['width', 'height'].map((attr) => (\r\n            rootSVG.getAttributeNS(null, attr)\r\n        ));\r\n\r\n        const rootHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${width}\" height=\"${height}\">\r\n            ${document.getElementById('editable-content').innerHTML}\r\n        </svg>`;\r\n\r\n        const blob = new Blob([rootHTML]);\r\n        saveAs(blob, `export_${(new Date()).toISOString()}.svg`);\r\n    };\r\n\r\n    const handleClearArea = () => {\r\n        setContent(!Boolean(content));\r\n    };\r\n\r\n    const appendNewItem = (_, nodeProps) => {\r\n        const element = document.createElement('div');\r\n\r\n        ReactDOM.render(\r\n            <svg>{React.createElement(...nodeProps)}</svg>,\r\n            element,\r\n            () => {\r\n                ReactDOM.unmountComponentAtNode(element);\r\n                document.querySelector('#editable-content').appendChild(element.childNodes[0].childNodes[0]);\r\n            }\r\n        );\r\n    };\r\n\r\n    useEffect(() => {\r\n        setLeftOffset(open ? drawerWidth : 57);\r\n    }, [open]);\r\n\r\n    useState(() => {\r\n        props.eventBus.on('settings', (value) => setSettingsTab(value));\r\n    }, []);\r\n\r\n    return (\r\n        // <div style={{ paddingTop: '60px' }}></div>\r\n        <div>\r\n            <div className={classes.menu}>\r\n                <EditorMenu\r\n                    onImport={handleImport}\r\n                    onExport={handleExport}\r\n                    onClearArea={handleClearArea}\r\n                />\r\n            </div>\r\n            <div className={classes.root}>\r\n                <CssBaseline />\r\n                <Drawer\r\n                    open={open}\r\n                    variant='permanent'\r\n                    className={clsx(classes.drawer, {\r\n                        [classes.drawerOpen]: open,\r\n                        [classes.drawerClose]: !open\r\n                    })}\r\n                    classes={{\r\n                        paper: clsx(classes.drawerPaper, {\r\n                            [classes.drawerOpen]: open,\r\n                            [classes.drawerClose]: !open\r\n                        })\r\n                    }}\r\n                >\r\n                    <div className={classes.toolbar}>\r\n                        <IconButton onClick={handleDrawerClose}>\r\n                            {\r\n                                theme.direction === 'rtl'\r\n                                    ? <ChevronRightIcon />\r\n                                    : <ChevronLeftIcon />\r\n                            }\r\n                        </IconButton>\r\n                        <IconButton\r\n                            color='inherit'\r\n                            aria-label='open drawer'\r\n                            onClick={handleDrawerOpen}\r\n                            edge='start'\r\n                            className={clsx({\r\n                                [classes.hide]: open\r\n                            })}\r\n                        >\r\n                            <ChevronRightIcon />\r\n                        </IconButton>\r\n                    </div>\r\n                    <Divider />\r\n                    <EditorItems onDrop={appendNewItem} />\r\n                    <Divider />\r\n                </Drawer>\r\n                <div className={classes.canvasContainer}>\r\n                    <AppBar\r\n                        // position='fixed'\r\n                        className={clsx(classes.appBar, {\r\n                            [classes.appBarShift]: open\r\n                        })}\r\n                    >\r\n                        <EditorToolbar />\r\n                    </AppBar>\r\n                    {/* <div className={classes.content}> */}\r\n                    <div style={{ position: 'relative', height: '100%' }}>\r\n                        <EditorCanvas\r\n                            leftOffset={leftOffset}\r\n                            topOffset={87}\r\n                            rightOffset={drawerWidth}\r\n                            mouseAction='edit'\r\n                        >\r\n                            {content}\r\n                        </EditorCanvas>\r\n                        {showSettings === 'canvas'\r\n                            ? <CanvasSettings width={drawerWidth}/>\r\n                            : <ItemSettings width={drawerWidth} />\r\n                        }\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default connect(mapStateToProps)(Editor);","import React from 'react';\r\nimport Editor from './editor';\r\n\r\nexport default function Main() {\r\n    return (\r\n        <Editor />\r\n    );\r\n}","import React from 'react';\nimport { Provider } from 'react-redux';\nimport { createMuiTheme } from '@material-ui/core/styles';\nimport { ThemeProvider } from '@material-ui/styles';\nimport './App.css';\nimport store from './store';\nimport Main from './components/Main';\n\nconst outerTheme = createMuiTheme({\n    palette: {\n        primary: {\n            main: '#0c9696',\n            auxiliary: '#0a7e95',\n            contrastText: '#fff'\n        },\n        secondary: {\n            main: '#43a047'\n        },\n        error: {\n            main: '#f33732',\n            hover: '#b71c1c'\n        },\n        warning: {\n            main: '#f57c00',\n            hover: '#ffa726'\n        },\n        text: {\n            primary: 'rgba(0, 0, 0, 0.87)',\n            secondary: 'rgba(0, 0, 0, 0.54)'\n        },\n        disabled: {\n            primary: '#1b202a',\n            secondary: '#757575'\n        }\n    },\n    typography: {\n        fontSize: 14,\n        fontWeight: 'normal',\n        fontFamily: '-apple-system,system-ui,BlinkMacSystemFont,' +\n            '\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial,sans-serif',\n        subtitle1: {\n            fontSize: 12,\n            fontWeight: 400\n        },\n        h6: {\n            fontSize: 18,\n            fontWeight: 400,\n            lineHeight: 1.5\n        },\n        h5: {\n            fontSize: 20,\n            fontWeight: 400\n        },\n        h4: {\n            fontSize: 22,\n            fontWeight: 400\n        },\n        overline: {\n            color: '#546e7a',\n            fontSize: 11,\n            fontWeight: 500,\n            lineHeight: '13px'\n        },\n        caption: {\n            fontSize: '0.8rem',\n            fontWeight: 400\n        }\n    },\n    MuiPaper: {\n        rounded: {\n            borderRadius: '0.2rem'\n        },\n        elevation1: {\n            boxShadow: '0 1px 5px 0 rgba(0,0,0,0.16), 0 1px 5px 0 rgba(0,0,0,0.12)'\n        },\n        elevation2: {\n            boxShadow: '0px 3px 1px -2px rgba(0,0,0,0.2), 0px 2px 2px 0px rgba(0,0,0,0.14), 0px 1px 5px 0px rgba(0,0,0,0.12)'\n        },\n        elevation4: {\n            boxShadow: '0 5px 10px -5px rgba(0,0,0,0.5)'\n        }\n    }\n});\n\nfunction App() {\n    return (\n        <Provider store={store}>\n            <ThemeProvider theme={outerTheme}>\n                <div className=\"App\">\n                    <Main />\n                </div>\n            </ThemeProvider>\n        </Provider>\n    );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}