{"version":3,"sources":["containers/UndoStack.js","reducers/index.js","store/index.js","components/helpers/ZoomableGroup.js","components/editor/EditorContent.js","actions/index.js","components/editor/EditorCanvas.js","components/editor/EditorToolbar.js","util/fileReader.js","components/editor/EditorMenu.js","components/editor/EditorItems.js","components/editor/settings/CanvasSettings.js","components/helpers/ColorPicker.js","components/editor/settings/ItemSettings.js","components/editor/Editor.js","components/Main.js","App.js","serviceWorker.js","index.js"],"names":["UndoStack","self","this","stack","step","length","push","data","shift","splice","item","initialState","editorAction","editorGrid","editorGridSize","editorPaperSize","width","height","allowDragging","allowResizing","allowRotating","allowProportions","allowRestrictions","snapSteps","x","y","angle","eventBus","EventBus","undoStack","items","rootReducer","state","action","type","store","createStore","ZoomableGroup","props","zoomEl","useRef","useState","transform","setTransform","mouse","oldX","oldY","button","matrix","scale","pos","view","m","dirty","applyTo","update","join","toFixed","pan","amount","scaleAt","at","prescale","mouseEvent","useCallback","event","enable","el","current","clientX","clientY","preventDefault","events","e","offset","parentNode","getBoundingClientRect","left","top","deltaY","useEffect","map","eventName","eventFunc","addEventListener","passive","removeEventListener","id","ref","children","subjxConfiguration","container","controlsContainer","rotatorAnchor","rotatorOffset","EditorContainer","editable","selectable","currentGroup","ignoreStoring","nextProps","content","dropItems","childNodes","appendChild","firstChild","handleDropLayer","lastElementChild","removeChild","dropLayer","Boolean","makeSelectables","stop","handleClick","bind","handleDoubleClick","handleKeyDown","handleUndo","handleRedo","reloadDraggables","document","classList","add","subscribeToEvents","on","Object","entries","fill","stroke","thickness","opacity","attribute","val","forEach","setAttributeNS","l","r","h","t","b","v","key","applyAlignment","value","target","nextItems","subjx","drag","restrict","draggable","resizable","rotatable","proportions","snap","onInit","console","log","options","scalable","tagName","toLowerCase","te","storage","handles","lx1","x1","baseVal","ly1","y1","lx2","x2","ly2","y2","lineLength","calcTooltipPosition","nextX","nextY","tooltip","createElementNS","actionButton","indexOf","disable","controls","onResize","dx","dy","setEditable","tr","tl","cx","cy","querySelector","revX","revY","doW","doH","setItem","name","onMove","onRotate","delta","onDrop","setTimeout","next","onDestroy","remove","start","emit","$setSelectedItems","newItems","setDraggable","direction","startPoint","lengthX","lengthY","theta","Math","atan2","PI","Number","cos","sin","ds","DragSelect","selectables","area","root","subscribe","selected","pop","find","child","contains","stopPropagation","ctrlKey","onLayerChange","getLayerPath","applyCurrentGroupOpacity","nextCurrentGroup","dropCurrentGroupOpacity","node","layerChain","getAttribute","nodeName","keyCode","exeDrag","undo","handleAction","redo","revert","sjxEl","exeRotate","rest","exeResize","React","Component","connect","dispatch","act","useStyles","makeStyles","flex","visibility","workArea","overflow","canvas","position","canvasContent","backgroundColor","page","boxShadow","layerBar","zIndex","margin","EditorCanvas","classes","rightOffset","initialW","initialH","window","outerWidth","outerHeight","paperWidth","paperHeight","w","paperSize","setPaperSize","canvasEl","controlsRef","workAreaRef","containerAreaRef","rootSVG","localAction","setLocalAction","layersBar","setLayersBar","setParentLayer","setStartPoint","setDropItems","scrollTop","clientHeight","scrollLeft","clientWidth","scrollToRef","svgPoint","elem","p","createSVGPoint","matrixTransform","getScreenCTM","inverse","drawElement","rect","drawArea1","getElementById","drawRect","abs","endDraw","className","Button","style","marginLeft","variant","color","size","onMouseUp","right","bottom","cursor","onMouseMove","onMouseDown","display","xmlns","gridSize","grid","patternUnits","d","strokeWidth","vectorEffect","canvasGrid","EditorContent","div","defaultProps","mouseAction","alignItems","verticalDivider","toolbar","padding","marginRight","ExtendedButton","withStyles","IconButton","$setEditorAction","$activateEditorGrid","setEditorAction","activateEditorGrid","buttons","component","Layers","Navigation","PhotoSizeSelectSmall","PanTool","Search","GridOn","GridOff","Undo","Redo","index","disabled","onClick","justifyContent","readText","filePath","Promise","resolve","reject","File","FileReader","FileList","Blob","reader","output","files","onload","result","readAsText","theme","extendedIcon","spacing","EditorMenu","createElement","fileSelector","setFileSelector","setAttribute","loadFiles","a","res","onImport","click","onExport","onClearArea","Rectangle","Circle","Shape","Text","EditorItems","droppables","isCloneable","setAsCloneable","cloneConfig","appendTo","border","background","maxWidth","textColor","itemType","newItem","editorRef","rx","ry","strokeDasharray","points","textLength","clone","List","text","Icon","ListItem","data-type","ListItemIcon","ListItemText","primary","containerColumn","flexDirection","label","paddingLeft","TextInput","TextField","CheckboxLabel","FormControlLabel","$setEditorPaperSize","$setAllowDragging","$setAllowResizing","$setAllowRotating","$setAllowProportions","$setAllowRestrictions","$setSnapSteps","$setEditorGridSize","dragging","setDragging","resizing","setResizing","rotating","setRotating","setProportions","restrictions","setRestrictions","setSnap","handleChange","handleSettings","checked","handleSnapChange","snapValues","FormControl","FormGroup","aria-label","Typography","align","onChange","Grid","xs","Slider","valueLabelDisplay","Divider","control","Checkbox","labelPlacement","ColorPicker","displayColorPicker","currentColor","hex","initValue","popover","setState","handleClose","wrapper","colorPicker","ReactDOM","createPortal","body","fontSize","boxSizing","lineHeight","minWidth","BootstrapInput","marginTop","input","borderRadius","palette","paper","transition","transitions","create","borderColor","InputBase","selectedItems","setFill","fillOptions","setFillOptions","setStroke","strokeOptions","setStrokeOptions","setThickness","setOpacity","setValue","isEmit","nextVal","getAttributeNS","Select","native","max","allowedSvgs","minHeight","justifyItems","menu","main","flexGrow","canvasContainer","appBar","borderTop","drawer","easing","sharp","duration","leavingScreen","appBarShift","enteringScreen","menuButton","hide","flexShrink","whiteSpace","drawerPaper","drawerOpen","drawerClose","overflowX","breakpoints","up","useTheme","open","setOpen","leftOffset","setLeftOffset","setContent","showSettings","setSettingsTab","parsedStyleSheet","CSSStyleSheet","getStyleRule","cssText","rules","cssRules","selectorText","propertyName","parserOptions","replace","domNode","styleSheet","rule","insertRule","attribs","href","parent","childNode","class","reactSVGEl","parse","Array","isArray","element","render","unmountComponentAtNode","attr","rootHTML","innerHTML","blob","saveAs","Date","toISOString","CssBaseline","Drawer","clsx","edge","_","nodeProps","AppBar","topOffset","Main","outerTheme","createMuiTheme","auxiliary","contrastText","secondary","error","hover","warning","typography","fontWeight","fontFamily","subtitle1","h6","h5","h4","overline","caption","MuiPaper","rounded","elevation1","elevation2","elevation4","App","ThemeProvider","location","hostname","match","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.0f04d68c.chunk.js","sourcesContent":["class UndoStack {\r\n\r\n    constructor(self) {\r\n        this.stack = [null];\r\n        this.step = -1;\r\n        this.self = self;\r\n    }\r\n\r\n    next() {\r\n        const { stack } = this;\r\n        if (stack[stack.length - 1] !== null) {\r\n            this.step++;\r\n            stack.push(null);\r\n        }\r\n    }\r\n\r\n    setItem(data) {\r\n        const { stack } = this;\r\n        stack[stack.length - 1] = data;\r\n\r\n        if (stack.length > 9) {\r\n            stack.shift();\r\n        };\r\n    }\r\n\r\n    push(data) {\r\n        this.step++;\r\n\r\n        this.stack.splice(this.step);\r\n        this.stack.push(data);\r\n    }\r\n\r\n    undo() {\r\n        let item;\r\n        const { stack } = this;\r\n\r\n        if (this.step >= 0) {\r\n            item = stack[this.step];\r\n            this.step--;\r\n            return item;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n    redo() {\r\n        const { stack } = this;\r\n\r\n        this.step = this.step === -1 ? 0 : this.step;\r\n        if (stack.length - 1 > this.step) {\r\n            return stack[this.step++];\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    invalidateAll() {\r\n        this.stack = [];\r\n        this.step = -1;\r\n    }\r\n\r\n}\r\n\r\nexport default UndoStack;","import EventBus from 'js-event-bus';\r\nimport UndoStack from '../containers/UndoStack';\r\n\r\nconst initialState = {\r\n    editorAction: 'edit',\r\n    editorGrid: true,\r\n    editorGridSize: 10,\r\n    editorPaperSize: {\r\n        width: 800,\r\n        height: 600\r\n    },\r\n    allowDragging: true,\r\n    allowResizing: true,\r\n    allowRotating: true,\r\n    allowProportions: true,\r\n    allowRestrictions: false,\r\n    snapSteps: {\r\n        x: 10,\r\n        y: 10,\r\n        angle: 15\r\n    },\r\n    eventBus: new EventBus(),\r\n    undoStack: new UndoStack(),\r\n    items: []\r\n};\r\n\r\nfunction rootReducer(state = { ...initialState }, action) {\r\n    switch (action.type) {\r\n\r\n        case 'SET_EDITOR_ACTION':\r\n            return {\r\n                ...state,\r\n                editorAction: action.editorAction\r\n            };\r\n        case 'ACTIVATE_EDITOR_GRID':\r\n            return {\r\n                ...state,\r\n                editorGrid: action.editorGrid\r\n            };\r\n        case 'SET_EDITOR_GRID_SIZE':\r\n            return {\r\n                ...state,\r\n                editorGridSize: action.editorGridSize\r\n            };\r\n        case 'SET_EDITOR_PAPER_SIZE':\r\n            return {\r\n                ...state,\r\n                editorPaperSize: action.editorPaperSize\r\n            };\r\n        case 'SET_ALLOW_DRAGGING':\r\n            return {\r\n                ...state,\r\n                allowDragging: action.allowDragging\r\n            };\r\n        case 'SET_ALLOW_RESIZING':\r\n            return {\r\n                ...state,\r\n                allowResizing: action.allowResizing\r\n            };\r\n        case 'SET_ALLOW_ROTATING':\r\n            return {\r\n                ...state,\r\n                allowRotating: action.allowRotating\r\n            };\r\n        case 'SET_ALLOW_PROPORTIONS':\r\n            return {\r\n                ...state,\r\n                allowProportions: action.allowProportions\r\n            };\r\n        case 'SET_ALLOW_RESTRICTIONS':\r\n            return {\r\n                ...state,\r\n                allowRestrictions: action.allowRestrictions\r\n            };\r\n        case 'SET_SNAP_STEPS':\r\n            return {\r\n                ...state,\r\n                snapSteps: action.snapSteps\r\n            };\r\n        case 'SET_SELECTED_ITEMS':\r\n            return {\r\n                ...state,\r\n                items: action.items\r\n            };\r\n        default:\r\n            return state;\r\n\r\n    }\r\n};\r\n\r\nexport default rootReducer;","import { createStore } from 'redux';\r\nimport rootReducer from '../reducers';\r\n\r\nconst store = createStore(rootReducer);\r\n\r\nexport default store;","import React, { useEffect, useState, useRef, useCallback } from 'react';\n\nconst ZoomableGroup = (props) => {\n    let zoomEl = useRef(null);\n    const [transform, setTransform] = useState('matrix(1,0,0,1,0,0)');\n    const mouse = { x: 0, y: 0, oldX: 0, oldY: 0, button: false };\n    const matrix = [1, 0, 0, 1, 0, 0];\n    let scale = 1;\n    const pos = { x: 0, y: 0 };\n\n    const view = (() => {\n        const m = matrix;\n\n        let dirty = true;\n        const API = {\n            applyTo() {\n                if (dirty) { this.update(); }\n                setTransform(`matrix(${m.join(',')})`);\n            },\n            update() {\n                dirty = false;\n                m[3] = m[0] = scale.toFixed(5);\n                m[2] = m[1] = 0;\n                m[4] = pos.x.toFixed(5);\n                m[5] = pos.y.toFixed(5);\n            },\n            pan(amount) {\n                if (dirty) { this.update(); }\n                pos.x += amount.x;\n                pos.y += amount.y;\n                dirty = true;\n            },\n            scaleAt(at, amount) {\n                const prescale = scale * amount;\n                if (prescale < 0.4 || prescale > 5) return;\n\n                if (dirty) { this.update(); }\n                scale *= amount;\n                pos.x = at.x - (at.x - pos.x) * amount;\n                pos.y = at.y - (at.y - pos.y) * amount;\n                dirty = true;\n            }\n        };\n        return API;\n    })();\n\n    const mouseEvent = useCallback((event) => {\n        if (props.enable === false) return;\n        const el = zoomEl.current;\n        if (event.type === 'mousedown') { mouse.button = true; }\n        if (event.type === 'mouseup' || event.type === 'mouseout') { mouse.button = false; }\n        mouse.oldX = mouse.x;\n        mouse.oldY = mouse.y;\n        mouse.x = event.clientX;\n        mouse.y = event.clientY;\n        if (mouse.button) {\n            view.pan({ x: mouse.x - mouse.oldX, y: mouse.y - mouse.oldY });\n            view.applyTo(el);\n        }\n        event.preventDefault();\n    });\n\n    const mouseWheelEvent = useCallback((e) => {\n        if (props.enable === false) return;\n        const el = zoomEl.current;\n        const offset = el.parentNode.getBoundingClientRect();\n        const x = e.clientX - offset.left;\n        const y = e.clientY - offset.top;\n\n        view.scaleAt({ x, y }, e.deltaY < 0 ? 1.1 : (1 / 1.1));\n        view.applyTo(el);\n        e.preventDefault();\n    }, [props.enable]);\n\n    const resetZoom = useCallback(() => {\n        scale = 1;\n        pos.x = pos.y = 0;\n        matrix[0] = matrix[3] = 1;\n        matrix[1] = matrix[2] = matrix[4] = matrix[5] = 0;\n        view.pan(pos);\n        view.scaleAt({ x: 0, y: 0 }, 1);\n        view.applyTo(zoomEl.current);\n    });\n\n    const events = [\n        ['mousemove', mouseEvent],\n        ['mousedown', mouseEvent],\n        ['mouseup', mouseEvent],\n        ['mouseout', mouseEvent],\n        ['wheel', mouseWheelEvent],\n        ['dblclick', resetZoom]\n    ];\n\n    useEffect(() => {\n        const el = zoomEl.current;\n\n        if (props.enable) {\n            events.map(([eventName, eventFunc]) => {\n                el.parentNode.addEventListener(eventName, eventFunc, { passive: false });\n            });\n        }\n\n        return () => {\n            events.map(([eventName, eventFunc]) => {\n                el.parentNode.removeEventListener(eventName, eventFunc, { passive: false });\n            });\n        };\n    }, [props.enable]);\n\n    return (\n        <g id='zoom-container' ref={zoomEl} transform={transform}>\n            {props.children}\n        </g>\n    );\n};\n\nexport default ZoomableGroup;","import React from 'react';\nimport { connect } from 'react-redux';\nimport subjx from 'subjx';\nimport DragSelect from 'dragselect';\nimport { setSelectedItems } from '../../actions';\n\nconst mapDispatchToProps = (dispatch) => ({\n    $setSelectedItems: (act) => dispatch(setSelectedItems(act))\n});\n\nconst subjxConfiguration = {\n    container: '#editor-container',\n    controlsContainer: '#controls-container',\n    rotatorAnchor: 'n',\n    rotatorOffset: 30\n};\n\nconst mapStateToProps = (state) => ({\n    editorGridSize: state.editorGridSize,\n    allowDragging: state.allowDragging,\n    allowResizing: state.allowResizing,\n    allowRotating: state.allowRotating,\n    allowProportions: state.allowProportions,\n    allowRestrictions: state.allowRestrictions,\n    snapSteps: state.snapSteps,\n    eventBus: state.eventBus,\n    undoStack: state.undoStack\n});\n\nclass EditorContainer extends React.Component {\n\n    el = null;\n    editable = false;\n    selectable = null;\n    items = [];\n    currentGroup = null;\n    ignoreStoring = false;\n\n    shouldComponentUpdate(nextProps) {\n        if (this.el) {\n            if (nextProps.content !== this.props.content) {\n                this.dropItems();\n                this.currentGroup = this.el;\n\n                if (nextProps.content && nextProps.content.childNodes) {\n                    while (nextProps.content.childNodes.length) {\n                        this.el.appendChild(nextProps.content.firstChild);\n                    }\n                } else {\n                    this.handleDropLayer();\n                    while (this.el.lastElementChild) {\n                        this.el.removeChild(this.el.lastElementChild);\n                    }\n                }\n            }\n        }\n\n        if (nextProps.dropLayer) {\n            this.handleDropLayer();\n        }\n\n        if (\n            (nextProps.dropItems === true || !nextProps.editable) &&\n            this.items.length\n        ) {\n            this.dropItems();\n        }\n\n        if (nextProps.selectable !== Boolean(this.selectable)) {\n            if (nextProps.selectable) {\n                this.selectable = this.makeSelectables();\n            }\n            if (!nextProps.selectable && this.selectable) {\n                this.selectable.stop();\n                this.selectable = null;\n            }\n        }\n\n        return false;\n    }\n\n    componentDidMount() {\n        this.currentGroup = this.el;\n\n        this.handleClick = this.handleClick.bind(this);\n        this.handleDoubleClick = this.handleDoubleClick.bind(this);\n        this.handleKeyDown = this.handleKeyDown.bind(this);\n        this.handleUndo = this.handleUndo.bind(this);\n        this.handleRedo = this.handleRedo.bind(this);\n        this.reloadDraggables = this.reloadDraggables.bind(this);\n\n        this.el.addEventListener('mouseup', this.handleClick);\n        this.el.addEventListener('dblclick', this.handleDoubleClick);\n        document.addEventListener('keydown', this.handleKeyDown);\n\n        this.el.classList.add('isolated-layer');\n\n        this.subscribeToEvents();\n    }\n\n    componentWillUnmount() {\n        this.el.removeEventListener('mouseup', this.handleClick);\n        this.el.removeEventListener('dblclick', this.handleDoubleClick);\n        document.removeEventListener('keydown', this.handleKeyDown);\n    }\n\n    subscribeToEvents() {\n        const { props: { eventBus } } = this;\n        eventBus.on('undo', this.handleUndo);\n        eventBus.on('redo', this.handleRedo);\n        eventBus.on('settingUpdated', this.reloadDraggables);\n\n        Object.entries({\n            fill: 'fill',\n            stroke: 'stroke',\n            thickness: 'stroke-width',\n            opacity: 'opacity'\n        }).map(([event, attribute]) => eventBus.on(event, (val) => {\n            this.items.forEach(item => item.el.setAttributeNS(null, attribute, val));\n        }));\n\n        Object.entries({\n            l: 'alignLeft',\n            r: 'alignRight',\n            h: 'alignHorizontal',\n            t: 'alignTop',\n            b: 'alignBottom',\n            v: 'alignVertical'\n        }).map(([key, event]) => eventBus.on(event, () => this.applyAlignment(key)));\n    }\n\n    setEditable(value) {\n        this.editable = value;\n    }\n\n    setDraggable(target) {\n        const self = this;\n        const {\n            items,\n            props\n        } = this;\n\n        const {\n            undoStack,\n            allowDragging,\n            allowResizing,\n            allowRotating,\n            allowProportions,\n            allowRestrictions,\n            snapSteps\n        } = props;\n\n        const nextItems = subjx(target).drag({\n            ...subjxConfiguration,\n            ...(allowRestrictions && { restrict: '#editor-grid' }),\n            draggable: allowDragging,\n            resizable: allowResizing,\n            rotatable: allowRotating,\n            proportions: allowProportions,\n            snap: {\n                x: snapSteps.x,\n                y: snapSteps.y,\n                angle: snapSteps.y\n            },\n            onInit() {\n                // eslint-disable-next-line no-console\n                console.log('Draggable:: ', this.el);\n\n                this.options.scalable = this.el.tagName.toLowerCase() === 'text';\n\n                // disables selection if active\n                if (self.selectable && self.props.selectable) {\n                    self.selectable.stop();\n                }\n\n                const { te } = this.storage.handles;\n\n                const lx1 = te.x1.baseVal.value;\n                const ly1 = te.y1.baseVal.value;\n                const lx2 = te.x2.baseVal.value;\n                const ly2 = te.y2.baseVal.value;\n\n                const lineLength = [lx1 - lx2, ly1 - ly2];\n\n                const [nextX, nextY] = self.calcTooltipPosition(\n                    [lx2, ly2],\n                    lineLength,\n                    -30,\n                    45\n                );\n\n                const tooltip = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n                tooltip.setAttributeNS(null, 'transform', `translate(${nextX - 12}, ${nextY - 12})`);\n                tooltip.classList.add('delete-sjx-item');\n\n                const actionButton = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n                actionButton.setAttributeNS(null, 'd', 'M14.59 8L12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8');\n                actionButton.setAttributeNS(null, 'pointer-events', 'bounding-box');\n                actionButton.setAttributeNS(null, 'fill', 'rgb(237, 28, 36)');\n\n                tooltip.addEventListener('click', () => {\n                    items.splice(items.indexOf(this), 1);\n                    this.disable();\n                    this.el.parentNode.removeChild(this.el);\n                });\n                tooltip.appendChild(actionButton);\n\n                this.controls.appendChild(tooltip);\n            },\n            onResize({ dx, dy }) {\n                self.setEditable(true);\n\n                const { tr, tl } = this.storage.handles;\n\n                const lx1 = tl.cx.baseVal.value;\n                const ly1 = tl.cy.baseVal.value;\n                const lx2 = tr.cx.baseVal.value;\n                const ly2 = tr.cy.baseVal.value;\n\n                const lineLength = [lx1 - lx2, ly1 - ly2];\n\n                const [nextX, nextY] = self.calcTooltipPosition(\n                    [lx2, ly2],\n                    lineLength,\n                    -30,\n                    45\n                );\n\n                const tooltip = this.controls.querySelector('.delete-sjx-item');\n                tooltip.setAttributeNS(null, 'transform', `translate(${nextX - 12}, ${nextY - 12})`);\n\n                if (self.ignoreStoring) return self.ignoreStoring = false;\n                const { revX, revY, doW, doH } = this.storage;\n\n                undoStack.setItem({\n                    name: 'resize',\n                    el: this.el,\n                    data: {\n                        dx,\n                        dy,\n                        revX,\n                        revY,\n                        doW,\n                        doH\n                    }\n                });\n            },\n            onMove({ dx, dy }) {\n                self.setEditable(true);\n\n                if (self.ignoreStoring) return self.ignoreStoring = false;\n                undoStack.setItem({ name: 'move', el: this.el, data: [dx, dy] });\n            },\n            onRotate({ clientX, clientY, transform, delta }) {\n                self.setEditable(true);\n\n                if (self.ignoreStoring) return self.ignoreStoring = false;\n                undoStack.setItem({ name: 'rotate', data: delta, el: this.el });\n            },\n            onDrop() {\n                setTimeout(() => (\n                    self.setEditable(false)\n                ), 100);\n\n                if (self.ignoreStoring) return self.ignoreStoring = false;\n                undoStack.next();\n            },\n            onDestroy() {\n                setTimeout(() => (\n                    self.setEditable(false)\n                ), 100);\n                this.el.classList.remove('subjx-selected');\n                // enables selection if active\n                if (self.selectable && self.props.selectable) {\n                    self.selectable.start();\n                }\n            }\n        });\n\n        this.props.eventBus.emit('settings', null, 'item');\n        this.props.$setSelectedItems({ items: [...nextItems] });\n        return nextItems;\n    }\n\n    reloadDraggables() {\n        const { items } = this;\n        const newItems = items.map((item) => {\n            item.disable();\n            return item.el;\n        });\n\n        this.items = [...this.setDraggable(newItems)];\n    }\n\n    applyAlignment(direction) {\n        this.items.map((item) => {\n            item.applyAlignment(direction);\n            const { te } = item.storage.handles;\n\n            const lx1 = te.x1.baseVal.value;\n            const ly1 = te.y1.baseVal.value;\n            const lx2 = te.x2.baseVal.value;\n            const ly2 = te.y2.baseVal.value;\n\n            const lineLength = [lx1 - lx2, ly1 - ly2];\n\n            const [nextX, nextY] = this.calcTooltipPosition(\n                [lx2, ly2],\n                lineLength,\n                -30,\n                45\n            );\n\n            const tooltip = item.controls.querySelector('.delete-sjx-item');\n            tooltip.setAttributeNS(null, 'transform', `translate(${nextX - 12}, ${nextY - 12})`);\n        });\n    }\n\n    calcTooltipPosition(startPoint, lineLength, offset, angle) {\n        const [x, y] = startPoint;\n        const [lengthX, lengthY] = lineLength;\n\n        const theta = Math.atan2(\n            lengthY,\n            lengthX\n        ) - (angle * Math.PI / 180);\n\n        return [\n            Number(x) + offset * Math.cos(theta),\n            Number(y) + offset * Math.sin(theta)\n        ];\n    }\n\n    makeSelectables() {\n        const ds = new DragSelect({\n            selectables: this.currentGroup.children,\n            area: this.props.root.current\n        });\n\n        ds.subscribe('callback', ({ items: selected }) => {\n            const { items } = this;\n\n            while (items.length > 0) items.pop().disable();\n            if (!selected.length) return;\n\n            const newItems = this.setDraggable(selected);\n\n            this.items = [...newItems];\n        });\n\n        return ds;\n    }\n\n    handleClick(e) {\n        if (this.editable || !this.props.editable) return;\n\n        const {\n            currentGroup,\n            items\n        } = this;\n\n        const target = [...currentGroup.childNodes]\n            .find((child) => (\n                !(child.classList && child.classList.contains('sjx-drag')) &&\n                child.contains(e.target)\n            )) || (currentGroup === e.target ? e.target : null);\n\n        //console.log('Target:: ', target);\n        //console.log('Current group:: ', currentGroup);\n\n        if (!target) return;\n\n        e.stopPropagation();\n\n        if (!e.ctrlKey) {\n            while (items.length > 0) items.pop().disable();\n        }\n\n        const newItems = this.setDraggable(target);\n\n        items.push(...newItems);\n        this.items = items;\n    }\n\n    handleDoubleClick(e) {\n        e.preventDefault();\n        if (this.editable || !this.props.editable) return;\n\n        const { currentGroup } = this;\n\n        const target = [...currentGroup.childNodes]\n            .find((child) => (\n                (child.classList && child.classList.contains('sjx-drag')) &&\n                child.contains(e.target)\n            ));\n\n        if (target && target.tagName === 'g') {\n            this.dropItems();\n            this.currentGroup = target;\n            this.props.onLayerChange(\n                this.getLayerPath(target)\n            );\n            currentGroup.classList.remove('isolated-layer');\n            target.classList.add('isolated-layer');\n            this.applyCurrentGroupOpacity(target);\n        }\n    }\n\n    handleDropLayer() {\n        const { currentGroup } = this;\n        if (currentGroup === this.el) {\n            return this.props.onLayerChange(\n                this.getLayerPath(currentGroup)\n            );\n        }\n\n        this.dropItems();\n        currentGroup.classList.remove('isolated-layer');\n        const nextCurrentGroup = currentGroup.parentNode;\n        this.currentGroup = nextCurrentGroup;\n        this.props.onLayerChange(\n            this.getLayerPath(nextCurrentGroup)\n        );\n\n        this.dropCurrentGroupOpacity(currentGroup);\n        this.applyCurrentGroupOpacity(nextCurrentGroup);\n        nextCurrentGroup.classList.add('isolated-layer');\n    }\n\n    getLayerPath(target) {\n        let node = target;\n        let layerChain = '';\n\n        while (node !== this.el) {\n            layerChain = (node.getAttribute('id') || node.nodeName) + ' / ' + layerChain;\n            node = node.parentNode;\n        }\n\n        return layerChain;\n    }\n\n    dropItems(nextItems = []) {\n        const { items } = this;\n        while (items.length > 0) items.pop().disable();\n        this.items = nextItems;\n    }\n\n    handleKeyDown(e) {\n        const { items } = this;\n        if (e.keyCode === 46) {\n            while (items.length > 0) {\n                const item = items.pop();\n                item.disable();\n                item.el.parentNode.removeChild(item.el);\n            }\n        } else if (e.keyCode === 65 && e.ctrlKey) {\n            while (items.length > 0) items.pop().disable();\n            e.preventDefault();\n        } else if (e.keyCode === 67) {\n            // c\n        } else if (e.keyCode === 86) {\n            // v\n        } else if (e.keyCode > 36 && e.keyCode < 41) {\n            e.preventDefault();\n            items.forEach((item) => {\n                item.exeDrag({\n                    dx: e.keyCode === 37 || e.keyCode === 39 ? e.keyCode === 37 ? -10 : 10 : 0,\n                    dy: e.keyCode === 38 || e.keyCode === 40 ? e.keyCode === 38 ? -10 : 10 : 0\n                });\n            });\n        }\n    }\n\n    applyCurrentGroupOpacity(el) {\n        el.setAttributeNS(null, 'opacity', 1);\n        if (el === this.el) return;\n        [...el.parentNode.childNodes].forEach(child => {\n            if (child.tagName === 'g' && child !== el) child.setAttributeNS(null, 'opacity', 0.3);\n        });\n        this.applyCurrentGroupOpacity(el.parentNode);\n    }\n\n    dropCurrentGroupOpacity(el) {\n        [...el.parentNode.childNodes].forEach(child => {\n            if (child.tagName === 'g' && child !== el) child.setAttributeNS(null, 'opacity', 1);\n        });\n    }\n\n    handleUndo() {\n        const { undoStack } = this.props;\n\n        const item = undoStack.undo();\n\n        if (item) {\n            this.ignoreStoring = true;\n            this.handleAction(item, true);\n        }\n    }\n\n    handleRedo() {\n        const { undoStack } = this.props;\n\n        const item = undoStack.redo();\n\n        if (item) {\n            this.ignoreStoring = true;\n            this.handleAction(item, false);\n        }\n    }\n\n    handleAction(action = {}, revert) {\n        this.dropItems();\n\n        switch (action.name) {\n\n            case 'rotate': {\n                const delta = action.data;\n                const sjxEl = this.setDraggable(action.el);\n\n                sjxEl.forEach((item) => {\n                    item.exeRotate({ delta: delta * (revert ? -1 : 1) });\n                    item.disable();\n                });\n\n                break;\n            }\n            case 'move': {\n                const [dx, dy] = action.data;\n                const sjxEl = this.setDraggable(action.el);\n\n                sjxEl.forEach((item) => {\n                    item.exeDrag({\n                        dx: dx * (revert ? -1 : 1),\n                        dy: dy * (revert ? -1 : 1)\n                    });\n                    item.disable();\n                });\n                break;\n            }\n            case 'resize': {\n                const { dx, dy, ...rest } = action.data;\n                const sjxEl = this.setDraggable(action.el);\n\n                sjxEl.forEach((item) => {\n                    item.exeResize({\n                        dx: dx * (revert ? -1 : 1),\n                        dy: dy * (revert ? -1 : 1),\n                        ...rest\n                    });\n                    item.disable();\n                });\n            }\n            default:\n                break;\n\n        }\n    }\n\n    render() {\n        return (\n            <g id='editable-content' ref={el => this.el = el} />\n        );\n    }\n\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EditorContainer);","export function setEditorAction({ editorAction }) {\r\n    return { type: 'SET_EDITOR_ACTION', editorAction };\r\n}\r\n\r\nexport function activateEditorGrid({ editorGrid }) {\r\n    return { type: 'ACTIVATE_EDITOR_GRID', editorGrid };\r\n}\r\n\r\nexport function setEditorGridSize({ editorGridSize }) {\r\n    return { type: 'SET_EDITOR_GRID_SIZE', editorGridSize };\r\n}\r\n\r\nexport function setEditorPaperSize({ editorPaperSize }) {\r\n    return { type: 'SET_EDITOR_PAPER_SIZE', editorPaperSize };\r\n}\r\n\r\nexport function setAllowDragging({ allowDragging }) {\r\n    return { type: 'SET_ALLOW_DRAGGING', allowDragging };\r\n}\r\n\r\nexport function setAllowResizing({ allowResizing }) {\r\n    return { type: 'SET_ALLOW_RESIZING', allowResizing };\r\n}\r\n\r\nexport function setAllowRotating({ allowRotating }) {\r\n    return { type: 'SET_ALLOW_ROTATING', allowRotating };\r\n}\r\n\r\nexport function setAllowProportions({ allowProportions }) {\r\n    return { type: 'SET_ALLOW_PROPORTIONS', allowProportions };\r\n}\r\n\r\nexport function setAllowRestrictions({ allowRestrictions }) {\r\n    return { type: 'SET_ALLOW_RESTRICTIONS', allowRestrictions };\r\n}\r\n\r\nexport function setSnapSteps({ snapSteps }) {\r\n    return { type: 'SET_SNAP_STEPS', snapSteps };\r\n}\r\n\r\nexport function setSelectedItems({ items }) {\r\n    return { type: 'SET_SELECTED_ITEMS', items };\r\n}","import React, { useState, useRef, useEffect } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { Button } from '@material-ui/core';\r\nimport ZoomableGroup from '../helpers/ZoomableGroup';\r\nimport EditorContent from './EditorContent';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    root: {\r\n        '-webkit-box-flex': 1,\r\n        '-ms-flex': 1,\r\n        flex: 1,\r\n        visibility: 'visible'\r\n    },\r\n    workArea: {\r\n        overflow: 'auto'\r\n    },\r\n    canvas: {\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0\r\n    },\r\n    canvasContent: {\r\n        backgroundColor: 'white'\r\n    },\r\n    page: {\r\n        boxShadow: '0px 0px 2px 1px #d1d1d1'\r\n    },\r\n    layerBar: {\r\n        position: 'absolute',\r\n        zIndex: 99999,\r\n        margin: 4\r\n    }\r\n}));\r\n\r\nconst canvasGrid = (paperSize, gridSize) => {\r\n    const grid = gridSize * 10;\r\n    return (\r\n        <g>\r\n            <defs>\r\n                <pattern\r\n                    id='smallGrid'\r\n                    width={gridSize}\r\n                    height={gridSize}\r\n                    fill='white'\r\n                    patternUnits='userSpaceOnUse'\r\n                >\r\n                    <path\r\n                        d={`M ${gridSize} 0 L 0 0 0 ${gridSize}`}\r\n                        fill='none'\r\n                        stroke='gray'\r\n                        strokeWidth='0.5'\r\n                        vectorEffect='non-scaling-stroke'\r\n                    />\r\n                </pattern>\r\n                <pattern id='grid' width={grid} height={grid} patternUnits='userSpaceOnUse'>\r\n                    <rect width={grid} height={grid} fill='url(#smallGrid)' />\r\n                    <path\r\n                        d={`M ${grid} 0 L 0 0 0 ${grid}`}\r\n                        fill='none'\r\n                        stroke='gray'\r\n                        strokeWidth='1'\r\n                        vectorEffect='non-scaling-stroke'\r\n                    />\r\n                </pattern>\r\n            </defs>\r\n            <rect x='0' y='0' width={paperSize.w} height={paperSize.h} fill='url(#grid)' />\r\n        </g>\r\n    );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        editorAction: state.editorAction,\r\n        editorGrid: state.editorGrid,\r\n        editorGridSize: state.editorGridSize,\r\n        editorPaperSize: state.editorPaperSize,\r\n        eventBus: state.eventBus\r\n    };\r\n};\r\n\r\nconst EditorCanvas = (props) => {\r\n    const classes = useStyles();\r\n    const {\r\n        editorAction,\r\n        editorGrid,\r\n        editorGridSize,\r\n        editorPaperSize,\r\n        // leftOffset,\r\n        // topOffset,\r\n        rightOffset,\r\n        children: content\r\n    } = props;\r\n\r\n    const {\r\n        width: initialW,\r\n        height: initialH\r\n    } = editorPaperSize;\r\n\r\n    const [paperWidth, paperHeight] = [window.outerWidth, window.outerHeight];\r\n\r\n    const [paperSize, setPaperSize] = useState({\r\n        w: initialW,\r\n        h: initialH,\r\n        x: (paperWidth - initialW) / 2,\r\n        y: (paperHeight - initialH) / 2\r\n    });\r\n\r\n    let canvasEl = null;\r\n    let controlsRef = null;\r\n    const workAreaRef = useRef(null);\r\n    const containerAreaRef = useRef(null);\r\n    const rootSVG = useRef(null);\r\n\r\n    const [localAction, setLocalAction] = useState(null);\r\n    const [layersBar, setLayersBar] = useState(null);\r\n    const [dropLayer, setParentLayer] = useState(false);\r\n    const [startPoint, setStartPoint] = useState({ x: 0, y: 0 });\r\n\r\n    const [dropItems, setDropItems] = useState(false);\r\n\r\n    const scrollToRef = (ref) => {\r\n        const container = containerAreaRef.current;\r\n        container.scrollTop = (ref.current.clientHeight - container.clientHeight) / 2;\r\n        container.scrollLeft = (ref.current.clientWidth - container.clientWidth) / 2;\r\n    };\r\n\r\n    useEffect(() => {\r\n        scrollToRef(workAreaRef);\r\n    }, [paperSize]);\r\n\r\n    // TODO: adopt to size of imported SVG\r\n    // useEffect(() => {\r\n    //     setPaperSize({\r\n    //         w: contentWidth > initialW ? contentWidth : initialW,\r\n    //         h: contentHeight > initialH ? contentHeight : initialH,\r\n    //         x: contentWidth > initialW ?  (paperWidth - contentWidth) / 2 : (paperWidth - initialW) / 2,\r\n    //         y: contentHeight > initialH ? (paperHeight - contentHeight) / 2 : (paperHeight - initialH) / 2\r\n    //     });\r\n    // }, [props.children]);\r\n\r\n    useEffect(() => {\r\n        setPaperSize({\r\n            w: initialW,\r\n            h: initialH,\r\n            x: (paperWidth - initialW) / 2,\r\n            y: (paperHeight - initialH) / 2\r\n        });\r\n    }, [props.editorPaperSize]);\r\n\r\n    const handleMouseDown = (e) => {\r\n        e.preventDefault();\r\n        switch (editorAction) {\r\n\r\n            case 'edit':\r\n                if (controlsRef.contains(e.target)) return;\r\n\r\n                if (!canvasEl.children[0].contains(e.target)) {\r\n                    setDropItems(true);\r\n                    props.eventBus.emit('settings', null, 'canvas');\r\n                    return setTimeout(() => setDropItems(false), 100);\r\n                }\r\n                break;\r\n            case 'grab':\r\n                const container = containerAreaRef.current;\r\n\r\n                setStartPoint({\r\n                    x: e.clientX,\r\n                    y: e.clientY,\r\n                    scrollTop: container.scrollTop,\r\n                    scrollLeft: container.scrollLeft\r\n                });\r\n                break;\r\n            case 'select':\r\n                //onCanvasDown(e);\r\n                break;\r\n            case 'zoom':\r\n                break;\r\n            case 'drawRect':\r\n                drawElement(e);\r\n                break;\r\n            default:\r\n                break;\r\n\r\n        }\r\n\r\n        setLocalAction(editorAction);\r\n    };\r\n\r\n    const handleMouseMove = (e) => {\r\n        e.preventDefault();\r\n\r\n        switch (localAction) {\r\n\r\n            case 'grab': {\r\n                const dx = (startPoint.x - e.clientX) * 1; // scale\r\n                const dy = (startPoint.y - e.clientY) * 1; // scale\r\n\r\n                const container = containerAreaRef.current;\r\n                container.scrollTop = startPoint.scrollTop + dy;\r\n                container.scrollLeft = startPoint.scrollLeft + dx;\r\n                break;\r\n            }\r\n            case 'zoom': {\r\n                break;\r\n            }\r\n            case 'draw':\r\n                //drawSvgElement(e);\r\n                break;\r\n            default:\r\n                break;\r\n\r\n        }\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n        setLocalAction(null);\r\n    };\r\n\r\n    const dropLayers = (e) => {\r\n        e.stopPropagation();\r\n        setParentLayer(true);\r\n    };\r\n\r\n    const svgPoint = (elem, x, y) => {\r\n        let p = elem.createSVGPoint();\r\n        p.x = x;\r\n        p.y = y;\r\n        return p.matrixTransform(elem.getScreenCTM().inverse());\r\n    };\r\n\r\n    const drawElement = (event) => {\r\n        const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\r\n        rect.setAttributeNS(null, 'stroke-width', 2);\r\n        rect.setAttributeNS(null, 'fill', 'none');\r\n        rect.setAttributeNS(null, 'stroke', '#000');\r\n\r\n        const drawArea1 = document.getElementById('editor-background');\r\n\r\n        const start = svgPoint(drawArea1, event.clientX, event.clientY);\r\n        document.getElementById('editable-content').appendChild(rect);\r\n\r\n        const drawRect = (e) => {\r\n            let p = svgPoint(drawArea1, e.clientX, e.clientY);\r\n            let w = Math.abs(p.x - start.x);\r\n            let h = Math.abs(p.y - start.y);\r\n            if (p.x > start.x) {\r\n                p.x = start.x;\r\n            }\r\n\r\n            if (p.y > start.y) {\r\n                p.y = start.y;\r\n            }\r\n\r\n            rect.setAttributeNS(null, 'x', p.x);\r\n            rect.setAttributeNS(null, 'y', p.y);\r\n            rect.setAttributeNS(null, 'width', w);\r\n            rect.setAttributeNS(null, 'height', h);\r\n        };\r\n\r\n        const endDraw = () => {\r\n            drawArea1.removeEventListener('mousemove', drawRect);\r\n            drawArea1.removeEventListener('mouseup', endDraw);\r\n        };\r\n\r\n        drawArea1.addEventListener('mousemove', drawRect);\r\n        drawArea1.addEventListener('mouseup', endDraw);\r\n    };\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            {\r\n                layersBar && (\r\n                    <p className={classes.layerBar}>\r\n                        {layersBar}\r\n                        <Button\r\n                            style={{ marginLeft: 2 }}\r\n                            variant='contained'\r\n                            color='primary'\r\n                            size='small'\r\n                            onMouseUp={dropLayers}>\r\n                            Exit\r\n                        </Button>\r\n                    </p>\r\n                )\r\n            }\r\n            <div\r\n                id='work-area'\r\n                ref={containerAreaRef}\r\n                className={classes.workArea}\r\n                style={{\r\n                    top: 0, // topOffset,\r\n                    left: 0, // leftOffset,\r\n                    right: rightOffset,\r\n                    bottom: 0,\r\n                    position: 'absolute',\r\n                    cursor: 'auto',\r\n                    overflow: 'scroll'\r\n                }}\r\n                onMouseMove={handleMouseMove}\r\n                onMouseDown={handleMouseDown}\r\n                onMouseUp={handleMouseUp}\r\n            >\r\n                <div\r\n                    ref={workAreaRef}\r\n                    style={{\r\n                        display: 'inline-block',\r\n                        position: 'relative',\r\n                        width: paperWidth,\r\n                        height: paperHeight\r\n                    }}\r\n                >\r\n                    <svg\r\n                        id='editor-container'\r\n                        xmlns='http://www.w3.org/2000/svg'\r\n                        className={classes.canvas}\r\n                        width='100%'\r\n                        height='100%'\r\n                        overflow='visible'\r\n                        ref={rootSVG}\r\n                    >\r\n                        <ZoomableGroup enable={editorAction === 'zoom'}>\r\n                            <g id='content' transform={`translate(${paperSize.x}, ${paperSize.y})`}>\r\n                                <g id='editor-background'>\r\n                                    <rect id='editor-grid' x='0' y='0' width={paperSize.w} height={paperSize.h} fill='white' stroke='grey' />\r\n                                    {\r\n                                        editorGrid\r\n                                            ? canvasGrid(paperSize, editorGridSize)\r\n                                            : null\r\n                                    }\r\n                                </g>\r\n                                <g\r\n                                    id='editor-canvas'\r\n                                    ref={el => canvasEl = el}\r\n                                    className={classes.page}\r\n                                >\r\n                                    <EditorContent\r\n                                        root={rootSVG}\r\n                                        editable={editorAction === 'edit'}\r\n                                        selectable={editorAction === 'select'}\r\n                                        content={content}\r\n                                        onLayerChange={(value) => {\r\n                                            setLayersBar(value);\r\n                                            setParentLayer(false);\r\n                                        }}\r\n                                        dropLayer={dropLayer}\r\n                                        dropItems={dropItems}\r\n                                    />\r\n                                </g>\r\n                            </g>\r\n                        </ZoomableGroup>\r\n                        <g id='controls-container' ref={div => controlsRef = div} />\r\n                    </svg>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nEditorCanvas.defaultProps = {\r\n    grid: true,\r\n    mouseAction: 'edit',\r\n    initialW: 800,\r\n    initialH: 600\r\n};\r\n\r\nexport default connect(mapStateToProps)(EditorCanvas);","import React from 'react';\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\r\nimport { connect } from 'react-redux';\r\nimport { IconButton } from '@material-ui/core';\r\n\r\nimport {\r\n    Layers as LayersIcon,\r\n    VerticalAlignCenter as AlignCenter,\r\n    VerticalAlignBottom as AlignIcon,\r\n    GridOn as GridOnIcon,\r\n    GridOff as GridOffIcon,\r\n    Undo as UndoIcon,\r\n    Redo as RedoIcon,\r\n    Navigation as NavigationIcon,\r\n    PanTool as PanToolIcon,\r\n    PhotoSizeSelectSmall as PhotoSizeSelectSmallIcon,\r\n    Search as SearchIcon,\r\n    Crop32Outlined as Rectangle,\r\n    FormatShapes as ShapeSettingsIcon,\r\n    Tune as CanvasSettingsIcon\r\n} from '@material-ui/icons';\r\n\r\nimport { setEditorAction, activateEditorGrid } from '../../actions';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    root: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        height: '100%'\r\n    },\r\n    flex: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        height: '100%',\r\n        marginLeft: 10\r\n    },\r\n    verticalDivider: {\r\n        width: '1px',\r\n        backgroundColor: 'white',\r\n        height: '30px'\r\n    },\r\n    toolbar: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        padding: 2,\r\n        marginRight: 5\r\n    }\r\n}));\r\n\r\nconst ExtendedButton = withStyles({\r\n    root: {\r\n        color: 'rgba(0,0,0,0.65)',\r\n        padding: 6\r\n    }\r\n})(IconButton);\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        editorAction: state.editorAction,\r\n        editorGrid: state.editorGrid,\r\n        eventBus: state.eventBus\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => ({\r\n    $setEditorAction: (act) => dispatch(setEditorAction(act)),\r\n    $activateEditorGrid: (act) => dispatch(activateEditorGrid(act))\r\n});\r\n\r\nconst EditorToolbar = (props) => {\r\n    const classes = useStyles();\r\n\r\n    const {\r\n        editorAction,\r\n        editorGrid,\r\n        eventBus\r\n    } = props;\r\n\r\n    const setEditorAction = (editorAction) => () => {\r\n        props.$setEditorAction({ editorAction });\r\n    };\r\n\r\n    const activateEditorGrid = (editorGrid) => {\r\n        props.$activateEditorGrid({ editorGrid });\r\n    };\r\n\r\n    const buttons = [\r\n        { type: 'button', selected: editorAction === 'showLayers', component: <LayersIcon />, action: () => 'showLayers' },\r\n        { type: 'divider' },\r\n        { type: 'button', selected: editorAction === 'edit', component: <NavigationIcon />, action: setEditorAction('edit') },\r\n        { type: 'button', selected: editorAction === 'select', component: <PhotoSizeSelectSmallIcon />, action: setEditorAction('select') },\r\n        { type: 'button', selected: editorAction === 'grab', component: <PanToolIcon />, action: setEditorAction('grab') },\r\n        { type: 'button', selected: editorAction === 'zoom', component: <SearchIcon />, action: setEditorAction('zoom') },\r\n        { type: 'divider' },\r\n        // { type: 'button', selected: editorAction === 'zoom', component: <Rectangle />, action: setEditorAction('drawRect') },\r\n        // { type: 'divider' },\r\n        { type: 'button', selected: editorAction === 'alignLeft', component: <AlignIcon transform='rotate(90)' />, action: () => eventBus.emit('alignLeft') },\r\n        { type: 'button', selected: editorAction === 'alignHorizontal', component: <AlignCenter transform='rotate(90)' />, action: () => eventBus.emit('alignHorizontal') },\r\n        { type: 'button', selected: editorAction === 'alignRight', component: <AlignIcon transform='rotate(-90)' />, action: () => eventBus.emit('alignRight') },\r\n        { type: 'button', selected: editorAction === 'alignTop', component: <AlignIcon transform='rotate(180)' />, action: () => eventBus.emit('alignTop') },\r\n        { type: 'button', selected: editorAction === 'alignVertical', component: <AlignCenter transform='rotate(180)' />, action: () => eventBus.emit('alignVertical') },\r\n        { type: 'button', selected: editorAction === 'alignBottom', component: <AlignIcon />, action: () => eventBus.emit('alignBottom') },\r\n        { type: 'divider' },\r\n        { type: 'button', selected: editorGrid === true, component: <GridOnIcon />, action: () => activateEditorGrid(true) },\r\n        { type: 'button', selected: editorGrid === false, component: <GridOffIcon />, action: () => activateEditorGrid(false) },\r\n        { type: 'divider' },\r\n        { type: 'button', selected: false, component: <UndoIcon />, action: () => eventBus.emit('undo') },\r\n        { type: 'button', selected: false, component: <RedoIcon />, action: () => eventBus.emit('redo') }\r\n    ];\r\n\r\n    const options = [\r\n        { type: 'button', selected: false, component: <ShapeSettingsIcon />, action: () => eventBus.emit('settings', null, 'item') },\r\n        { type: 'button', selected: false, component: <CanvasSettingsIcon />, action: () => eventBus.emit('settings', null, 'canvas') }\r\n    ];\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <div className={classes.flex}>\r\n                {buttons.map(({ type, component, action, selected, value }, index) => (\r\n                    <div key={`${index}button`} className={classes.toolbar}>{\r\n                        type !== 'divider'\r\n                            ? <ExtendedButton disabled={selected} onClick={() => action()}>{component}</ExtendedButton>\r\n                            : <div className={classes.verticalDivider} />\r\n                    }</div>\r\n                ))}\r\n            </div>\r\n            <div className={classes.flex} style={{ width: '100%', justifyContent: 'flex-end' }}>\r\n                {options.map(({ type, component, action, selected, value }, index) => (\r\n                    <div key={`${index}button`} className={classes.toolbar}>{\r\n                        type !== 'divider'\r\n                            ? <ExtendedButton disabled={selected} onClick={() => action()}>{component}</ExtendedButton>\r\n                            : <div className={classes.verticalDivider} />\r\n                    }</div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditorToolbar);","export function readText(filePath) {\r\n    return new Promise((resolve, reject) => {\r\n        if (window.File && window.FileReader && window.FileList && window.Blob) {\r\n            const reader = new FileReader();\r\n            let output = '';\r\n            if (filePath.files && filePath.files[0]) {\r\n                reader.onload = (e) => {\r\n                    output = e.target.result;\r\n                    resolve(output);\r\n                };\r\n                reader.readAsText(filePath.files[0]);\r\n            }\r\n        } else {\r\n            reject();\r\n        }\r\n    });\r\n}","import React, { useState, useEffect } from 'react';\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ImportIcon from '@material-ui/icons/GetApp';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport Delete from '@material-ui/icons/Delete';\r\nimport { readText } from '../../util/fileReader';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        padding: '0 8px'\r\n    },\r\n    extendedIcon: {\r\n        marginRight: theme.spacing(1)\r\n    }\r\n}));\r\n\r\nconst ExtendedButton = withStyles({\r\n    root: {\r\n        color: '#fff',\r\n        marginRight: '10px'\r\n    }\r\n})(IconButton);\r\n\r\nconst EditorMenu = (props) => {\r\n    const classes = useStyles();\r\n\r\n    const [fileSelector, setFileSelector] = useState(\r\n        document.createElement('input')\r\n    );\r\n\r\n    useEffect(() => {\r\n        const fileSelector = document.createElement('input');\r\n        fileSelector.setAttribute('type', 'file');\r\n        fileSelector.setAttribute('accept', 'image/*');\r\n        fileSelector.setAttribute('id', 'file-upload');\r\n        fileSelector.style.display = 'none';\r\n\r\n        setFileSelector(fileSelector);\r\n\r\n        const loadFiles = async (e) => {\r\n            try {\r\n                const res = await readText(e.target);\r\n                props.onImport(res);\r\n            } catch (err) {\r\n                // eslint-disable-next-line no-console\r\n                console.log(err);\r\n            }\r\n        };\r\n\r\n        fileSelector.addEventListener('change', loadFiles, false);\r\n    }, [props]);\r\n\r\n    const handleFileSelect = (e) => {\r\n        fileSelector.click();\r\n        e.preventDefault();\r\n        e.target.value = '';\r\n    };\r\n\r\n    const handleExportFile = () => {\r\n        props.onExport();\r\n    };\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <ExtendedButton onClick={handleFileSelect}>\r\n                <ImportIcon />\r\n            </ExtendedButton>\r\n            <ExtendedButton onClick={handleExportFile}>\r\n                <SaveIcon />\r\n            </ExtendedButton>\r\n            <ExtendedButton onClick={() => props.onClearArea()}>\r\n                <Delete />\r\n            </ExtendedButton>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default EditorMenu;","import React, { useState, useEffect } from 'react';\r\nimport subjx from 'subjx';\r\nimport {\r\n    List,\r\n    ListItem,\r\n    ListItemIcon,\r\n    ListItemText\r\n} from '@material-ui/core';\r\nimport {\r\n    Crop32Outlined as Rectangle,\r\n    RadioButtonUnchecked as Circle,\r\n    GradeOutlined as Shape,\r\n    CropOriginalOutlined as Image,\r\n    FormatShapes as Text\r\n} from '@material-ui/icons';\r\n\r\nconst items = [\r\n    ['rectangle', Rectangle],\r\n    ['circle', Circle],\r\n    ['shape', Shape],\r\n    ['text', Text],\r\n    // ['image', Image]\r\n];\r\n\r\nconst EditorItems = (props) => {\r\n    const droppables = [];\r\n    const [isCloneable, setAsCloneable] = useState(false);\r\n\r\n    const cloneConfig = {\r\n        appendTo: 'body',\r\n        stack: '#editor-background',\r\n        style: {\r\n            border: 'none',\r\n            background: 'transparent',\r\n            maxWidth: '150px',\r\n            textColor: 'transparent'\r\n        },\r\n        onInit() {},\r\n        onDrop(e) {\r\n            const itemType = this.el.getAttribute('data-type');\r\n            let newItem = null;\r\n\r\n            const editorRef = document.querySelector('#editor-background');\r\n\r\n            const offset = editorRef.getBoundingClientRect(),\r\n                x = e.clientX - offset.left + editorRef.scrollLeft,\r\n                y = e.clientY - offset.top + editorRef.scrollTop;\r\n\r\n            switch (itemType) {\r\n\r\n                case 'rectangle':\r\n                    newItem = [\r\n                        'rect',\r\n                        {\r\n                            x,\r\n                            y,\r\n                            width: 150,\r\n                            height: 100,\r\n                            stroke: 'black',\r\n                            fill: 'transparent'\r\n                        }\r\n                    ];\r\n                    break;\r\n                case 'circle':\r\n                    newItem = [\r\n                        'ellipse',\r\n                        {\r\n                            cx: x,\r\n                            cy: y,\r\n                            rx: 45,\r\n                            ry: 45,       \r\n                            stroke: 'black',\r\n                            fill: 'transparent'\r\n                        }\r\n                    ];\r\n                    break;\r\n                case 'shape':\r\n                    newItem = [\r\n                        'polygon',\r\n                        {\r\n                            strokeWidth: '1',\r\n                            stroke: 'black',\r\n                            fill: \"transparent\",\r\n                            strokeDasharray: \"0\",\r\n                            points: `${x + 80},${y} ${x + 160},${y + 50} ${x + 80},${y + 100} ${x},${y + 50}`\r\n                        },\r\n                        []\r\n                    ];\r\n                    break;\r\n                case 'image':\r\n                    newItem = [\r\n                        'foreignObject',\r\n                        {\r\n                            x,\r\n                            y,\r\n                            width: 150,\r\n                            height: 100,\r\n                            stroke: 'black',\r\n                            fill: 'transparent'\r\n                        },\r\n                        [\r\n                            [\r\n                                'div',\r\n                                {\r\n                                    display: 'block'\r\n                                },\r\n                                ['text']\r\n                            ]\r\n                        ]\r\n                    ];\r\n                    break;\r\n                case 'text':\r\n                    newItem = [\r\n                        'text',\r\n                        {\r\n                            x,\r\n                            y,\r\n                            textLength: 150\r\n                        },\r\n                        React.createElement(\r\n                            'tspan',\r\n                            {},\r\n                            'text'\r\n                        )\r\n                    ];\r\n                    break;\r\n                // case 'text':\r\n                //     newItem = [\r\n                //         'foreignObject',\r\n                //         {\r\n                //             x,\r\n                //             y,\r\n                //             width: 150,\r\n                //             height: 100,\r\n                //             stroke: 'black',\r\n                //             fill: 'transparent'\r\n                //         },\r\n                //         React.createElement(\r\n                //             'div',\r\n                //             {\r\n                //                 display: 'block'\r\n                //             },\r\n                //             'text'\r\n                //         )\r\n                //     ];\r\n                //     break;\r\n                default:\r\n                    break;\r\n\r\n            }\r\n\r\n            props.onDrop(\r\n                e,\r\n                newItem\r\n            );\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (isCloneable) return;\r\n        droppables.forEach(el => subjx(el).clone(cloneConfig));\r\n        setAsCloneable(true);\r\n    }, [droppables, isCloneable, cloneConfig]);\r\n\r\n    return (\r\n        <List>\r\n            {items.map(([text, Icon]) => (\r\n                <ListItem\r\n                    data-type={text}\r\n                    ref={(el) => droppables.push(el)}\r\n                    button\r\n                    key={text}\r\n                >\r\n                    <ListItemIcon>\r\n                        <Icon />\r\n                    </ListItemIcon>\r\n                    <ListItemText primary={text} />\r\n                </ListItem>\r\n            ))}\r\n        </List>\r\n    );\r\n};\r\n\r\nexport default EditorItems;","import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\n\nimport {\n    TextField,\n    Checkbox,\n    FormGroup,\n    FormControlLabel,\n    FormControl,\n    Divider,\n    Typography,\n    Grid,\n    Slider\n} from '@material-ui/core';\n\nimport {\n    setEditorPaperSize,\n    setAllowDragging,\n    setAllowResizing,\n    setAllowRotating,\n    setAllowProportions,\n    setAllowRestrictions,\n    setSnapSteps,\n    setEditorGridSize\n} from '../../../actions';\n\nconst useStyles = makeStyles(() => ({\n    root: {\n        position: 'absolute',\n        right: 0,\n        top: 0,\n        bottom: 0,\n        backgroundColor: '#fdfdfd',\n        zIndex: 999\n    },\n    container: {\n        display: 'flex',\n        flex: 1\n    },\n    containerColumn: {\n        display: 'flex',\n        flexDirection: 'column'\n    },\n    padding: {\n        padding: 10\n    },\n    label: {\n        paddingLeft: 10\n    }\n}));\n\nconst TextInput = withStyles({\n    root: {\n        margin: 10,\n        '& .MuiOutlinedInput-input': {\n            padding: '10px 10px'\n        }\n    }\n})(TextField);\n\nconst CheckboxLabel = withStyles({\n    root: {\n        margin: '0'\n    }\n})(FormControlLabel);\n\nconst mapStateToProps = (state) => ({\n    editorPaperSize: state.editorPaperSize,\n    allowDragging: state.allowDragging,\n    allowResizing: state.allowResizing,\n    allowRotating: state.allowRotating,\n    allowProportions: state.allowProportions,\n    allowRestrictions: state.allowRestrictions,\n    snapSteps: state.snapSteps,\n    editorGridSize: state.editorGridSize,\n    eventBus: state.eventBus\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n    $setEditorPaperSize: (act) => dispatch(setEditorPaperSize(act)),\n    $setAllowDragging: (act) => dispatch(setAllowDragging(act)),\n    $setAllowResizing: (act) => dispatch(setAllowResizing(act)),\n    $setAllowRotating: (act) => dispatch(setAllowRotating(act)),\n    $setAllowProportions: (act) => dispatch(setAllowProportions(act)),\n    $setAllowRestrictions: (act) => dispatch(setAllowRestrictions(act)),\n    $setSnapSteps: (act) => dispatch(setSnapSteps(act)),\n    $setEditorGridSize: (act) => dispatch(setEditorGridSize(act))\n});\n\nconst CanvasSettings = (props) => {\n    const classes = useStyles();\n\n    const {\n        editorPaperSize: { width, height },\n        allowDragging,\n        allowResizing,\n        allowRotating,\n        allowProportions,\n        allowRestrictions,\n        editorGridSize,\n        snapSteps\n    } = props;\n\n    const [paperSize, setPaperSize] = useState({ width, height });\n    const [dragging, setDragging] = useState(allowDragging);\n    const [resizing, setResizing] = useState(allowResizing);\n    const [rotating, setRotating] = useState(allowRotating);\n    const [proportions, setProportions] = useState(allowProportions);\n    const [restrictions, setRestrictions] = useState(allowRestrictions);\n    const [snap, setSnap] = useState(snapSteps);\n\n\n    const handleChange = ([w, h]) => {\n        if (Number(w) < 1 || Number(h) < 1) return;\n\n        const editorPaperSize = { width: w, height: h };\n        setPaperSize(editorPaperSize);\n        props.$setEditorPaperSize({ editorPaperSize });\n    };\n\n    const handleSettings = (name) => (e) => {\n        const value = e.target.checked;\n\n        switch (name) {\n\n            case 'drag': {\n                setDragging(value);\n                props.$setAllowDragging({ allowDragging: value });\n                break;\n            }\n\n            case 'resize': {\n                setResizing(value);\n                props.$setAllowResizing({ allowResizing: value });\n                break;\n            }\n\n            case 'rotate': {\n                setRotating(value);\n                props.$setAllowRotating({ allowRotating: value });\n                break;\n            }\n\n            case 'proportions': {\n                setProportions(value);\n                props.$setAllowProportions({ allowProportions: value });\n                break;\n            }\n\n            case 'restrictions': {\n                setRestrictions(value);\n                props.$setAllowRestrictions({ allowRestrictions: value });\n                break;\n            }\n\n        }\n    };\n\n    const handleSnapChange = (value) => {\n        const snapValues = { ...snap, ...value };\n        setSnap(snapValues);\n        props.$setSnapSteps({ snapSteps: snapValues });\n    };\n\n    return (\n        <div\n            className={classes.root}\n            style={{ width: props.width }}\n        >\n            <FormControl component='fieldset'>\n                <FormGroup aria-label='position'>\n                    <div className={classes.padding}>\n                        <Typography className={classes.label} variant='subtitle1' align='left'>Canvas</Typography>\n                        <div className={classes.container}>\n                            <TextInput label='width' value={paperSize.width} variant='outlined' size='small' onChange={(e) => handleChange([e.target.value, paperSize.height])} />\n                            <TextInput label='height' value={paperSize.height} variant='outlined' size='small' onChange={(e) => handleChange([paperSize.width, e.target.value])} />\n                        </div>\n                        <Grid container>\n                            <Grid item xs={12}>\n                                <Typography className={classes.label} variant='subtitle1' align='left'>Grid size</Typography>\n                                <div style={{ display: 'flex', alignItems: 'center', padding: '0 10px' }}>\n                                    <Slider valueLabelDisplay='auto' value={editorGridSize} onChange={(e, val) => props.$setEditorGridSize({ editorGridSize: val })} step={10} />\n                                </div>\n                            </Grid>\n                        </Grid>\n                    </div>\n                    <Divider />\n                    <div className={classes.padding}>\n                        <Typography className={classes.label} variant='subtitle1' align='left'>Effects</Typography>\n                        <div className={classes.containerColumn}>\n                            <CheckboxLabel\n                                value={dragging}\n                                control={<Checkbox checked={dragging} color='primary' onChange={handleSettings('drag')} />}\n                                label='Allow dragging'\n                                labelPlacement='end'\n                            />\n                            <CheckboxLabel\n                                value={resizing}\n                                control={<Checkbox checked={resizing} color='primary' onChange={handleSettings('resize')} />}\n                                label='Allow resizing'\n                                labelPlacement='end'\n                            />\n                            <CheckboxLabel\n                                value={rotating}\n                                control={<Checkbox checked={rotating} color='primary' onChange={handleSettings('rotate')} />}\n                                label='Allow rotating'\n                                labelPlacement='end'\n                            />\n                            <CheckboxLabel\n                                value={proportions}\n                                control={<Checkbox checked={proportions} color='primary' onChange={handleSettings('proportions')} />}\n                                label='Keep aspect ratio'\n                                labelPlacement='end'\n                            />\n                            <CheckboxLabel\n                                value={restrictions}\n                                control={<Checkbox checked={restrictions} color='primary' onChange={handleSettings('restrictions')} />}\n                                label='Activate bounding area'\n                                labelPlacement='end'\n                            />\n                        </div>\n                    </div>\n                    <Divider />\n                    <div className={classes.padding}>\n                        <Typography className={classes.label} variant='subtitle1' align='left'>Snap</Typography>\n                        <Grid container>\n                            <Grid item xs={6}>\n                                <TextInput label='grid step x' value={snap.x} variant='outlined' size='small' onChange={(e) => handleSnapChange({ x: Number(e.target.value) })} />\n                            </Grid>\n                            <Grid item xs={6}>\n                                <TextInput label='grid step y' value={snap.y} variant='outlined' size='small' onChange={(e) => handleSnapChange({ y: Number(e.target.value) })} />\n                            </Grid>\n                        </Grid>\n                        <Grid container>\n                            <Grid item xs={6}>\n                                <TextInput label='snap angle' value={snap.angle} variant='outlined' size='small' onChange={(e) => handleSnapChange({ angle: Number(e.target.value) })} />\n                            </Grid>\n                        </Grid>\n                    </div>\n                </FormGroup>\n            </FormControl>\n        </div>\n    );\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CanvasSettings);","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ChromePicker } from 'react-color';\nimport { withStyles } from '@material-ui/core/styles';\n\nconst styles = () => ({\n    root: {\n        width: '50%',\n        padding: 0,\n        border: 0,\n        margin: 0,\n        display: 'inline-flex',\n        padding: 0,\n        position: 'relative',\n        flexDirection: 'column',\n        verticalAlign: 'top'\n    },\n    wrapper: {\n        padding: 10,\n        color: 'rgba(0, 0, 0, 0.87)',\n        cursor: 'text',\n        display: 'inline-flex',\n        position: 'relative',\n        fontSize: '1rem',\n        boxSizing: 'border-box',\n        alignItems: 'center',\n        lineHeight: '1.0876em'\n    },\n    colorPicker: {\n        flex: '0 1 100%',\n        border: 0,\n        height: '1.0876em',\n        margin: 0,\n        display: 'block',\n        padding: '6px 0 7px',\n        minWidth: 0,\n        background: 'none',\n        boxSizing: 'content-box',\n        border: '2px solid #c7c7c7',\n        borderRadius: 4\n    }\n});\n\nclass ColorPicker extends React.Component {\n\n    state = {\n        displayColorPicker: false,\n        currentColor: {\n            hex: this.props.initValue || this.props.value || 'transparent'\n        },\n        popover: {\n            position: 'absolute',\n            zIndex: '9999',\n            top: 0,\n            left: 0\n        }\n    };\n\n    componentDidUpdate() {\n        if (this.props.value !== this.state.currentColor.hex) {\n            this.setState({ currentColor: { hex: this.props.value } });\n        }\n    }\n\n    handleClick = (e) => {\n        const { clientX, clientY } = e;\n        const { clientWidth, clientHeight } = e.target;\n        this.setState({\n            displayColorPicker: !this.state.displayColorPicker,\n            popover: {\n                ...this.state.popover,\n                left: clientX - clientWidth,\n                top: clientY\n            }\n        });\n    };\n\n    handleClose = () => {\n        this.setState({ displayColorPicker: false });\n    };\n\n    handleChange = (color) => {\n        this.setState({ currentColor: color });\n        this.props.onChange(color);\n    };\n\n    render() {\n        const cover = {\n            position: 'fixed',\n            top: '0px',\n            right: '0px',\n            bottom: '0px',\n            left: '0px'\n        };\n\n        return (\n            <div className={this.props.classes.root}>\n                <div className={this.props.classes.wrapper}>\n                    <div className={this.props.classes.colorPicker} onClick={this.handleClick} style={{ backgroundColor: this.state.currentColor.hex }} />\n                </div>\n                {this.state.displayColorPicker ?\n                    ReactDOM.createPortal(\n                        <div style={this.state.popover}>\n                            <div style={cover} onClick={this.handleClose} />\n                            <ChromePicker color={this.state.currentColor} onChange={this.handleChange} />\n                        </div>,\n                        document.body\n                    ) : null}\n            </div>\n        );\n    }\n\n};\n\nexport default withStyles(styles)(ColorPicker);","import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\nimport ColorPicker from '../../helpers/ColorPicker';\n\nimport {\n    FormGroup,\n    FormControl,\n    Divider,\n    Typography,\n    Grid,\n    Slider,\n    Select,\n    InputBase\n} from '@material-ui/core';\n\nconst BootstrapInput = withStyles((theme) => ({\n    root: {\n        'label + &': {\n            marginTop: theme.spacing(3)\n        }\n    },\n    input: {\n        borderRadius: 4,\n        position: 'relative',\n        backgroundColor: theme.palette.background.paper,\n        border: '1px solid #ced4da',\n        fontSize: 16,\n        paddingLeft: 10,\n        transition: theme.transitions.create(['border-color', 'box-shadow']),\n        '&:focus': {\n            borderRadius: 4,\n            borderColor: '#80bdff',\n            boxShadow: '0 0 0 0.2rem rgba(0,123,255,.25)'\n        }\n    }\n}))(InputBase);\n\nconst useStyles = makeStyles(() => ({\n    root: {\n        position: 'absolute',\n        right: 0,\n        top: 0,\n        bottom: 0,\n        backgroundColor: '#fdfdfd',\n        zIndex: 999\n    },\n    container: {\n        display: 'flex',\n        flex: 1\n    },\n    containerColumn: {\n        display: 'flex',\n        flexDirection: 'column'\n    },\n    padding: {\n        padding: 10\n    },\n    label: {\n        paddingLeft: 10,\n        width: '50%'\n    }\n}));\n\nconst mapStateToProps = (state) => ({\n    eventBus: state.eventBus,\n    selectedItems: state.items\n});\n\nconst ItemSettings = (props) => {\n    const classes = useStyles();\n\n    const { eventBus, selectedItems } = props;\n\n    const [fill, setFill] = useState('none');\n    const [fillOptions, setFillOptions] = useState('none');\n    const [stroke, setStroke] = useState('none');\n    const [strokeOptions, setStrokeOptions] = useState('none');\n    const [thickness, setThickness] = useState(2);\n    const [opacity, setOpacity] = useState(100);\n\n    const setValue = (name, value, isEmit = true) => {\n        switch (name) {\n\n            case 'fill': {\n                setFill(value);\n                if (isEmit) eventBus.emit(name, null, value);\n                break;\n            }\n            case 'fillOptions': {\n                const nextVal = fillOptions === 'color' ? fill : 'none';\n                setFill(nextVal);\n                if (isEmit) eventBus.emit(name, null, nextVal);\n                break;\n            }\n            case 'stroke': {\n                setStroke(value);\n                if (isEmit) eventBus.emit(name, null, value);\n                break;\n            }\n            case 'thickness': {\n                const nextVal = value === null ? 2 : value;\n                setThickness(Number(nextVal));\n                if (isEmit) eventBus.emit(name, null, Number(nextVal));\n                break;\n            }\n            case 'opacity': {\n                const nextVal = value === null ? 1 : value;\n                setOpacity(Number(nextVal) * 100);\n                if (isEmit) eventBus.emit(name, null, Number(nextVal));\n                break;\n            }\n            default:\n                break;\n\n        }\n    };\n\n    useEffect(() => {\n        if (!selectedItems.length) return;\n\n        Object.entries({\n            fill: 'fill',\n            stroke: 'stroke',\n            thickness: 'stroke-width',\n            opacity: 'opacity'\n        }).map(([event, attribute]) => {\n            setValue(\n                event,\n                selectedItems[0].el.getAttributeNS(null, attribute),\n                false\n            );\n        });\n    }, [selectedItems]);\n\n    return (\n        <div\n            className={classes.root}\n            style={{ width: props.width }}\n        >\n            <FormControl component='fieldset' style={{ width: '100%' }}>\n                <FormGroup aria-label='position'>\n                    <div className={classes.padding}>\n                        <div className={classes.container}>\n                            <Typography className={classes.label} variant='subtitle1' align='left'>\n                                Fill\n                            </Typography>\n                        </div>\n                        <div className={classes.container}>\n                            <ColorPicker value={fill} onChange={(value) => setValue('fill', value.hex)} />\n                            <Select\n                                style={{ width: '50%', padding: 10 }}\n                                variant='outlined'\n                                native\n                                value={fillOptions}\n                                onChange={(e) => setFillOptions(e.target.value)}\n                                name='age'\n                                input={<BootstrapInput />}\n                            >\n                                <option value={'none'}>none</option>\n                                <option value={'color'}>color</option>\n                            </Select>\n                        </div>\n                        <div className={classes.container}>\n                            <Typography className={classes.label} variant='subtitle1' align='left'>Stroke</Typography>\n                        </div>\n                        <div className={classes.container}>\n                            <ColorPicker value={stroke} onChange={(value) => setValue('stroke', value.hex)} />\n                            <Select\n                                style={{ width: '50%', padding: 10 }}\n                                variant='outlined'\n                                native\n                                value={strokeOptions}\n                                onChange={(e) => setStrokeOptions(e.target.value)}\n                                name='age'\n                                input={<BootstrapInput />}\n                            >\n                                <option value={'none'}>none</option>\n                                <option value={'color'}>color</option>\n                            </Select>\n                        </div>\n                        <div className={classes.container}>\n                            <Grid item xs={12}>\n                                <Typography className={classes.label} variant='subtitle1' align='left'>Thickness</Typography>\n                                <div style={{ display: 'flex', alignItems: 'center', padding: '0 10px' }}>\n                                    <Slider\n                                        valueLabelDisplay='auto'\n                                        max={30}\n                                        value={thickness}\n                                        onChange={(e, val) => setValue('thickness', val)} step={1}\n                                    />\n                                </div>\n                            </Grid>\n                        </div>\n                    </div>\n                    <Divider />\n                    <div className={classes.padding}>\n                        <div className={classes.container}>\n                            <Grid item xs={12}>\n                                <Typography className={classes.label} variant='subtitle1' align='left'>Opacity</Typography>\n                                <div style={{ display: 'flex', alignItems: 'center', padding: '0 10px' }}>\n                                    <Slider\n                                        valueLabelDisplay='auto'\n                                        max={100}\n                                        value={opacity}\n                                        onChange={(e, val) => setValue('opacity', val / 100)} step={1}\n                                    />\n                                </div>\n                            </Grid>\n                        </div>\n                    </div>\n                    <Divider />\n                </FormGroup>\n            </FormControl>\n        </div>\n    );\n};\n\nexport default connect(mapStateToProps)(ItemSettings);","import React, { useState, useEffect } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { connect } from 'react-redux';\r\nimport clsx from 'clsx';\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\r\nimport parse from 'html-react-parser';\r\nimport { saveAs } from 'file-saver';\r\nimport 'construct-style-sheets-polyfill';\r\n\r\nimport {\r\n    Drawer,\r\n    AppBar,\r\n    CssBaseline,\r\n    Divider,\r\n    IconButton\r\n} from '@material-ui/core';\r\n\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\n\r\nimport EditorCanvas from './EditorCanvas';\r\nimport EditorToolbar from './EditorToolbar';\r\nimport EditorMenu from './EditorMenu';\r\nimport EditorItems from './EditorItems';\r\nimport { CanvasSettings, ItemSettings } from './settings';\r\n\r\nconst allowedSvgs = [\r\n    'g', 'rect', 'path', 'polygon', 'polyline',\r\n    'circle', 'ellipse', 'text', 'line', 'foreighobject'\r\n];\r\n\r\nconst drawerWidth = 240;\r\n\r\nconst mapStateToProps = (state) => ({\r\n    eventBus: state.eventBus\r\n});\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        display: 'flex',\r\n        marginTop: 46,\r\n        minHeight: 'calc(100vh - 46px)',\r\n        height: 'calc(100vh - 46px)',\r\n        justifyItems: 'center',\r\n        backgroundColor: '#e6e5e5'\r\n    },\r\n    menu: {\r\n        display: 'flex',\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        height: 46,\r\n        width: '100%',\r\n        zIndex: 999,\r\n        backgroundColor: theme.palette.primary.main\r\n    },\r\n    canvas: {\r\n        flexGrow: 1\r\n        // overflow: 'hidden auto'\r\n    },\r\n    canvasContainer: {\r\n        display: 'flex',\r\n        flex: 1,\r\n        flexDirection: 'column'\r\n    },\r\n    appBar: {\r\n        borderTop: '1px solid #fff',\r\n        color: 'rgba(0,0,0,0.65)',\r\n        backgroundColor: 'rgb(230 229 229)',\r\n        zIndex: theme.zIndex.drawer + 1,\r\n        transition: theme.transitions.create(['width', 'margin'], {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.leavingScreen\r\n        }),\r\n        position: 'relative',\r\n        height: 46\r\n    },\r\n    appBarShift: {\r\n        // marginLeft: drawerWidth,\r\n        // width: `calc(100% - ${drawerWidth}px)`,\r\n        transition: theme.transitions.create(['width', 'margin'], {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.enteringScreen\r\n        })\r\n    },\r\n    menuButton: {\r\n        marginRight: 36\r\n    },\r\n    hide: {\r\n        display: 'none'\r\n    },\r\n    drawer: {\r\n        width: drawerWidth,\r\n        flexShrink: 0,\r\n        whiteSpace: 'nowrap'\r\n    },\r\n    drawerPaper: {\r\n        position: 'relative',\r\n        backgroundColor: '#fdfdfd'\r\n    },\r\n    drawerOpen: {\r\n        width: drawerWidth,\r\n        transition: theme.transitions.create('width', {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.enteringScreen\r\n        })\r\n    },\r\n    drawerClose: {\r\n        transition: theme.transitions.create('width', {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.leavingScreen\r\n        }),\r\n        overflowX: 'hidden',\r\n        width: theme.spacing(7) + 1,\r\n        [theme.breakpoints.up('sm')]: {\r\n            width: theme.spacing(7) + 1\r\n        }\r\n    },\r\n    toolbar: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'flex-end',\r\n        padding: theme.spacing(0, 1)\r\n    },\r\n    content: {\r\n        flexGrow: 1,\r\n        padding: theme.spacing(2)\r\n    }\r\n}));\r\n\r\nconst Editor = (props) => {\r\n    const classes = useStyles();\r\n    const theme = useTheme();\r\n    const [open, setOpen] = useState(false);\r\n    const [leftOffset, setLeftOffset] = useState(57);\r\n    const [content, setContent] = useState(null);\r\n    const [showSettings, setSettingsTab] = useState('canvas');\r\n\r\n    const parsedStyleSheet = new CSSStyleSheet();\r\n\r\n    const handleDrawerOpen = () => {\r\n        setOpen(true);\r\n    };\r\n\r\n    const handleDrawerClose = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    const getStyleRule = (className) => {\r\n        let cssText = {};\r\n        const classes = parsedStyleSheet.rules || parsedStyleSheet.cssRules;\r\n        for (let x = 0; x < classes.length; x++) {\r\n            if (classes[x].selectorText === className) {\r\n                for (let index = 0; index < classes[x].style.length; index++) {\r\n                    const propertyName = classes[x].style.item(index);\r\n                    cssText = {\r\n                        ...cssText,\r\n                        [propertyName]: classes[x].style[propertyName]\r\n                    };\r\n                }\r\n            }\r\n        }\r\n        return cssText;\r\n    };\r\n\r\n    const parserOptions = {\r\n        replace(domNode) {\r\n            if (domNode.name === 'style') {\r\n                const styleSheet = new CSSStyleSheet();\r\n                styleSheet.replace(domNode.children[0].data);\r\n\r\n                [...styleSheet.rules].map((rule) => (\r\n                    parsedStyleSheet.insertRule(rule.cssText, parsedStyleSheet.cssRules.length)\r\n                ));\r\n\r\n                return <></>;\r\n            }\r\n\r\n            if (domNode.name === 'use') {\r\n                const ref = domNode.attribs['xlink:href'] || domNode.attribs.href;\r\n\r\n                if (!ref) return domNode;\r\n                const source = domNode.parent.children.find((childNode) => {\r\n                    return childNode.attribs && ('#' + childNode.attribs.id === ref);\r\n                });\r\n            }\r\n\r\n            if (domNode.type === 'tag' && allowedSvgs.indexOf(domNode.name) !== -1) {\r\n                domNode.attribs = domNode.attribs || {};\r\n\r\n                const { class: className = '' } = domNode.attribs;\r\n\r\n                if (domNode.name === 'g') {\r\n                    domNode.attribs = {\r\n                        ...domNode.attribs,\r\n                        ...getStyleRule(`.${domNode.attribs.class}`),\r\n                        class: `layer ${className}`\r\n                    };\r\n                } else {\r\n                    domNode.attribs = {\r\n                        ...domNode.attribs,\r\n                        ...getStyleRule(`.${domNode.attribs.class}`),\r\n                        class: className\r\n                    };\r\n                }\r\n            }\r\n            return domNode;\r\n        }\r\n    };\r\n\r\n    const handleImport = (res) => {\r\n        let reactSVGEl = parse(res, parserOptions);\r\n\r\n        if (Array.isArray(reactSVGEl)) {\r\n            reactSVGEl = reactSVGEl.find(item => (\r\n                typeof item === 'object' && item.type === 'svg'\r\n            ));\r\n        }\r\n\r\n        const element = document.createElement('div');\r\n        // this is a temporary decision to convert html to dom\r\n        // maybe in the future it is need to use react way to import complex html tree\r\n        ReactDOM.render(reactSVGEl, element, () => {\r\n            ReactDOM.unmountComponentAtNode(element);\r\n            setContent(element.childNodes[0]);\r\n        });\r\n    };\r\n\r\n    const handleExport = () => {\r\n        const rootSVG = document.getElementById('editor-canvas');\r\n        const [width, height] = ['width', 'height'].map((attr) => (\r\n            rootSVG.getAttributeNS(null, attr)\r\n        ));\r\n\r\n        const rootHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${width}\" height=\"${height}\">\r\n            ${document.getElementById('editable-content').innerHTML}\r\n        </svg>`;\r\n\r\n        const blob = new Blob([rootHTML]);\r\n        saveAs(blob, `export_${(new Date()).toISOString()}.svg`);\r\n    };\r\n\r\n    const handleClearArea = () => {\r\n        setContent(!Boolean(content));\r\n    };\r\n\r\n    const appendNewItem = (_, nodeProps) => {\r\n        const element = document.createElement('div');\r\n\r\n        ReactDOM.render(\r\n            <svg>{React.createElement(...nodeProps)}</svg>,\r\n            element,\r\n            () => {\r\n                ReactDOM.unmountComponentAtNode(element);\r\n                document.querySelector('#editable-content').appendChild(element.childNodes[0].childNodes[0]);\r\n            }\r\n        );\r\n    };\r\n\r\n    useEffect(() => {\r\n        setLeftOffset(open ? drawerWidth : 57);\r\n    }, [open]);\r\n\r\n    useState(() => {\r\n        props.eventBus.on('settings', (value) => setSettingsTab(value));\r\n    }, []);\r\n\r\n    return (\r\n        // <div style={{ paddingTop: '60px' }}></div>\r\n        <div>\r\n            <div className={classes.menu}>\r\n                <EditorMenu\r\n                    onImport={handleImport}\r\n                    onExport={handleExport}\r\n                    onClearArea={handleClearArea}\r\n                />\r\n            </div>\r\n            <div className={classes.root}>\r\n                <CssBaseline />\r\n                <Drawer\r\n                    open={open}\r\n                    variant='permanent'\r\n                    className={clsx(classes.drawer, {\r\n                        [classes.drawerOpen]: open,\r\n                        [classes.drawerClose]: !open\r\n                    })}\r\n                    classes={{\r\n                        paper: clsx(classes.drawerPaper, {\r\n                            [classes.drawerOpen]: open,\r\n                            [classes.drawerClose]: !open\r\n                        })\r\n                    }}\r\n                >\r\n                    <div className={classes.toolbar}>\r\n                        <IconButton onClick={handleDrawerClose}>\r\n                            {\r\n                                theme.direction === 'rtl'\r\n                                    ? <ChevronRightIcon />\r\n                                    : <ChevronLeftIcon />\r\n                            }\r\n                        </IconButton>\r\n                        <IconButton\r\n                            color='inherit'\r\n                            aria-label='open drawer'\r\n                            onClick={handleDrawerOpen}\r\n                            edge='start'\r\n                            className={clsx({\r\n                                [classes.hide]: open\r\n                            })}\r\n                        >\r\n                            <ChevronRightIcon />\r\n                        </IconButton>\r\n                    </div>\r\n                    <Divider />\r\n                    <EditorItems onDrop={appendNewItem} />\r\n                    <Divider />\r\n                </Drawer>\r\n                <div className={classes.canvasContainer}>\r\n                    <AppBar\r\n                        // position='fixed'\r\n                        className={clsx(classes.appBar, {\r\n                            [classes.appBarShift]: open\r\n                        })}\r\n                    >\r\n                        <EditorToolbar />\r\n                    </AppBar>\r\n                    {/* <div className={classes.content}> */}\r\n                    <div style={{ position: 'relative', height: '100%' }}>\r\n                        <EditorCanvas\r\n                            leftOffset={leftOffset}\r\n                            topOffset={87}\r\n                            rightOffset={drawerWidth}\r\n                            mouseAction='edit'\r\n                        >\r\n                            {content}\r\n                        </EditorCanvas>\r\n                        {showSettings === 'canvas'\r\n                            ? <CanvasSettings width={drawerWidth} />\r\n                            : <ItemSettings width={drawerWidth} />\r\n                        }\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default connect(mapStateToProps)(Editor);","import React from 'react';\r\nimport Editor from './editor';\r\n\r\nexport default function Main() {\r\n    return (\r\n        <Editor />\r\n    );\r\n}","import React from 'react';\nimport { Provider } from 'react-redux';\nimport { createMuiTheme } from '@material-ui/core/styles';\nimport { ThemeProvider } from '@material-ui/styles';\nimport './App.css';\nimport store from './store';\nimport Main from './components/Main';\n\nconst outerTheme = createMuiTheme({\n    palette: {\n        primary: {\n            main: '#00a8ff', // '#0c9696',\n            auxiliary: '#0a7e95',\n            contrastText: '#fff'\n        },\n        secondary: {\n            main: '#43a047'\n        },\n        error: {\n            main: '#f33732',\n            hover: '#b71c1c'\n        },\n        warning: {\n            main: '#f57c00',\n            hover: '#ffa726'\n        },\n        text: {\n            primary: 'rgba(0, 0, 0, 0.87)',\n            secondary: 'rgba(0, 0, 0, 0.54)'\n        },\n        disabled: {\n            primary: '#1b202a',\n            secondary: '#757575'\n        }\n    },\n    typography: {\n        fontSize: 14,\n        fontWeight: 'normal',\n        fontFamily: '-apple-system,system-ui,BlinkMacSystemFont,' +\n            '\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial,sans-serif',\n        subtitle1: {\n            fontSize: 12,\n            fontWeight: 400\n        },\n        h6: {\n            fontSize: 18,\n            fontWeight: 400,\n            lineHeight: 1.5\n        },\n        h5: {\n            fontSize: 20,\n            fontWeight: 400\n        },\n        h4: {\n            fontSize: 22,\n            fontWeight: 400\n        },\n        overline: {\n            color: '#546e7a',\n            fontSize: 11,\n            fontWeight: 500,\n            lineHeight: '13px'\n        },\n        caption: {\n            fontSize: '0.8rem',\n            fontWeight: 400\n        }\n    },\n    MuiPaper: {\n        rounded: {\n            borderRadius: '0.2rem'\n        },\n        elevation1: {\n            boxShadow: '0 1px 5px 0 rgba(0,0,0,0.16), 0 1px 5px 0 rgba(0,0,0,0.12)'\n        },\n        elevation2: {\n            boxShadow: '0px 3px 1px -2px rgba(0,0,0,0.2), 0px 2px 2px 0px rgba(0,0,0,0.14), 0px 1px 5px 0px rgba(0,0,0,0.12)'\n        },\n        elevation4: {\n            boxShadow: '0 5px 10px -5px rgba(0,0,0,0.5)'\n        }\n    }\n});\n\nfunction App() {\n    return (\n        <Provider store={store}>\n            <ThemeProvider theme={outerTheme}>\n                <div className=\"App\">\n                    <Main />\n                </div>\n            </ThemeProvider>\n        </Provider>\n    );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}